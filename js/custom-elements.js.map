{"version":3,"sources":["webpack:///./custom-elements/tree.wp.es.js","webpack:///./custom-elements/swap.wp.es.js","webpack:///./libs/geometry.wp.es.js","webpack:///./custom-elements/arg-map.wp.es.js","webpack:////nix/store/j9c3j3x6sc64mx4xp8jlbw8lhilijaf1-node-dependencies-ColEx-0.1.0/lib/node_modules/ascii-string-split/index.js","webpack:///./libs/shapes.wp.es.js","webpack:///./custom-elements/sidenote.wp.es.js","webpack:///./custom-elements/menu.wp.es.js"],"names":["S","Object","__WEBPACK_IMPORTED_MODULE_1_sanctuary__","checkTypes","env","choose","ev","el","__WEBPACK_IMPORTED_MODULE_0_jquery___default","target","map","contentTree","contentBranch","children","get","index","event","hasClass","tag","parent","is","from","siblings","to","Promise","resolve","reject","removeClass","addClass","event_","pho","height","stepDuration","stretch","then","heightFn","__WEBPACK_IMPORTED_MODULE_2_d3__","__WEBPACK_IMPORTED_MODULE_5_libs_util__","prog","css","fadeIn","cleanUp","removeAttr","fadeOut","all","handleEvent","__WEBPACK_IMPORTED_MODULE_4_custom_elements_sidenote__","setNotes","fixNotes","closest","attr","toArray","__WEBPACK_IMPORTED_MODULE_3_custom_elements_menu__","defaultHandlers","click","pageY","pageX","getMenu","HTMLElement","fixTarget","offset","top","left","off","MathJax","Hub","Queue","inlines","swap","arrow","this","p","selector","replace","bottom","nextAll","prevAll","topEl","bottomEl","betweenEls","nextUntil","bottomToTop","between","topToBottom","translations","angle","Math","PI","mkTranslator","trans","startAngle","center","radius","__WEBPACK_IMPORTED_MODULE_4_libs_geometry__","x","y","topTranslator","bottomTranslator","betweenTranslator","__WEBPACK_IMPORTED_MODULE_3_libs_util__","swapTranslate","swapDom","__WEBPACK_IMPORTED_MODULE_2_custom_elements_sidenote__","remove","decorate","bot","topNext","next","before","up","down","swaps","groupBy","on","equals","forEach","group","pipe","tail","prepend","clone","init","append","circleFromChord","startRads","stopRads","startCoord","stopCoord","coord1","coord2","hypot","distance","sin","abs","pointOnCircle","cos","__WEBPACK_IMPORTED_MODULE_3_sanctuary__","shapes","__WEBPACK_IMPORTED_MODULE_4_libs_shapes__","linkArc","link","source","dx","dy","dr","forceNodeProps","t","forceLinkProps","drawNode","nodeTypes","type","nodeTypeIndex","findIndex","Error","toString","mkArgMap","id","dataSrc","canvasSelector","__WEBPACK_IMPORTED_MODULE_1_d3__","fetchData","nodes","links","linkTypes","canvas","width","svg","simulation","force","d","strength","alphaDecay","mkSimulation","uniqueLinkTypes","defs","selectAll","data","enter","drawLibrary","classed","drawLinks","node","dblClicked","call","dragStarted","dragged","dragEnded","drawTSpans","label","RADIUS","drawNodes","ticked","mkLegend","alphaTarget","restart","fx","fy","select","legendNode","_","i","legendLink","fn","__WEBPACK_IMPORTED_MODULE_2_ascii_string_split___default","text","close","history","replaceState","window","location","pathname","stop","open","evt","e","currentTarget","filter","a","href","baseVal","maps","resize","slice","hide","show","addClickHandler","hash","endsWith","handleHash","asciiStringSplit","str","options","words","split","lines","line","normalizeOptions","word","length","splitWords","preservedWords","indexOf","push","substring","newOptions","Array","isArray","module","exports","__WEBPACK_IMPORTED_MODULE_0_sanctuary__","toSvgPolygon","angles","joinWith","triangle","square","diamond","pentagon","hexagon","circle","range","getReferrer","toMaybe","maybeToNullable","find","last","reduce","prevBot","_el","_1","maybe_","outerHeight","ref","max","prev","each","observer","observe","attributes","not","referrer","noted","html","addSidenote","MutationObserver","addOrRemoveNotes","parseFloat","document","fonts","ready","disconnect","__webpack_exports__","renderMenuItem","menuItem","li","active","renderMenu","menu","items","parseMenu","nodeName","parseMenuItem","menuDom","item","toggleMenu","some","tg","isPopup"],"mappings":"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","file":"custom-elements.js","sourcesContent":["// @flow\n/* eslint no-undef: \"off\" */\n\nimport $ from 'jquery'\nimport {create, env} from 'sanctuary'\nimport { interpolateNumber } from 'd3'\n\nimport menu from 'custom-elements/menu'\nimport sidenote from 'custom-elements/sidenote'\nimport { makeAnimationPromise } from 'libs/util'\n\nconst S = create({checkTypes: false, env})\n\ntype Event\n  = { tag: 'INVISIBLEPARENT', from: JQuery, to: JQuery }\n  | { tag: 'SELECTEDOPEN' }\n  | { tag: 'SELECTEDNEWVISIBLE', from: JQuery, to: JQuery, parent: JQuery }\n\nconst handleEvent = (event: Event) => (resolve: Function, reject: Function) => {\n  switch (event.tag) {\n    case 'INVISIBLEPARENT':\n      event.from.removeClass('open')\n      event.to.addClass('open')\n      resolve()\n      break\n    case 'SELECTEDOPEN':\n      resolve()\n      break\n    case 'SELECTEDNEWVISIBLE':\n      // Flow behaving badly\n      const event_ = event\n      const pho = event_.parent.height()\n      const stepDuration = 300 // ms\n      const fadeOut = () =>\n        makeAnimationPromise(stepDuration, prog => event_.from.css('opacity', 1 - prog))\n          .then(() => {\n            event_.from.css('opacity', 0)\n            event_.from.removeClass('open')\n          })\n      const stretch = () =>\n        Promise.resolve()\n          .then(() => {\n            const heightFn = interpolateNumber(pho, event_.parent.height())\n            return makeAnimationPromise(stepDuration, prog => {\n              event_.parent.css('height', heightFn(prog))\n            })\n          })\n      const fadeIn = () =>\n        Promise.resolve()\n          .then(() => {\n            event_.to.css('opacity', 0)\n            event_.to.addClass('open')\n            return makeAnimationPromise(stepDuration, prog => {\n              event_.to.css('opacity', prog)\n            })\n          })\n      const cleanUp = () => {\n        event_.parent.removeAttr('style')\n        event_.from.removeAttr('style')\n        event_.to.removeAttr('style')\n      }\n      fadeOut()\n        .then(() => Promise.all([fadeIn(), stretch()]))\n        .then(cleanUp)\n        .then(resolve)\n      break\n  }\n}\n\nconst choose = (ev: JQueryMouseEventObject) => {\n  const el = $(ev.target)\n  S.map(\n    contentTree => {\n      const contentBranch = $($(contentTree).children().get(el.index()))\n      const event =\n        contentBranch.hasClass('open')\n          ? { tag: 'SELECTEDOPEN' }\n          : contentBranch.parent().is(':visible')\n            ? { tag: 'SELECTEDNEWVISIBLE', from: contentBranch.siblings('.open'), to: contentBranch, parent: contentBranch.parent() }\n            : { tag: 'INVISIBLEPARENT', from: contentBranch.siblings('.open'), to: contentBranch }\n      new Promise(handleEvent(event)).then(() => {\n        sidenote.setNotes()\n        sidenote.fixNotes()\n      })\n    }\n  )(\n    $(`[data-menu=\"${el.closest('menu').attr('id')}\"]`).toArray()\n  )\n  menu.defaultHandlers(el)\n  return false\n}\n\nconst fixTarget = (target: EventTarget) => HTMLElement = (target: any) // eslint-disable-line no-return-assign\n\n$(() => {\n  S.map(el =>\n    $(el).click(({pageY, pageX, target}) => {\n      menu.getMenu(fixTarget(target))\n      .offset({top: pageY, left: pageX})\n      .children('ul.menu').children()\n      .off().click(choose)\n      return false\n    })\n  )(\n    $('[type=\"menu\"]').toArray()\n  )\n\n  MathJax.Hub.Queue(() => {\n    // Messes up rendering if we add to stylesheet\n    $('.MathJax_MathContainer').css('display', 'inline')\n    $('.MathJax_MathContainer > span').css('display', 'inline')\n    // Re-inline fix rendering problem\n    const inlines = $('.switch.inline > li.open')\n    inlines.css('display', 'inline-block')\n    inlines.offset() // Trigger reflow\n    inlines.css('display', 'inline')\n    inlines.removeAttr('style')\n  })\n})\n\n\n\n// WEBPACK FOOTER //\n// ./custom-elements/tree.wp.es.js","// @flow\n/* eslint no-undef: \"off\" */\n\n// Doesn't currently handle nested swaps\n\nimport $ from 'jquery'\nimport {create, env} from 'sanctuary'\n\nimport sidenote from 'custom-elements/sidenote'\nimport { makeAnimationPromise } from 'libs/util'\nimport { circleFromChord, pointOnCircle } from 'libs/geometry'\n\nconst S = create({checkTypes: false, env})\n\nconst translations = (top: JQuery, bottom: JQuery) => {\n  const bottomToTop = top.offset().top - bottom.offset().top\n  const between = bottom.height() - top.height()\n  const topToBottom = bottom.offset().top - top.offset().top + between\n  return {bottomToTop, between, topToBottom}\n}\n\nconst swapTranslate = (topEl: JQuery, bottomEl: JQuery) => (resolve: Function, reject: Function) => {\n  const betweenEls = topEl.nextUntil(bottomEl)\n  const {bottomToTop, between, topToBottom} = translations(topEl, bottomEl)\n\n  const angle = Math.PI / 4\n  const mkTranslator = (trans: number): (number => string) => {\n    const startAngle = trans <= 0 ? Math.PI + angle : angle\n    const {center, radius} = circleFromChord(startAngle,\n                                             startAngle - 2 * angle,\n                                             {x: 0, y: 0},\n                                             {x: 0, y: trans})\n    return (prog: number): string => {\n      const {x, y} = pointOnCircle(center, radius,\n                                   startAngle - angle * 2 * prog)\n      return `translate(${x}px, ${-y}px)`\n    }\n  }\n  const topTranslator = mkTranslator(topToBottom)\n  const bottomTranslator = mkTranslator(bottomToTop)\n  const betweenTranslator = mkTranslator(between)\n\n  const stepDuration = 300 // ms\n\n  Promise.all([\n    makeAnimationPromise(\n      stepDuration,\n      prog => topEl.css('transform', topTranslator(prog))\n    ).then(() => topEl.removeAttr('style')),\n    makeAnimationPromise(\n      stepDuration,\n      prog => bottomEl.css('transform', bottomTranslator(prog))\n    ).then(() => bottomEl.removeAttr('style')),\n    makeAnimationPromise(\n      stepDuration,\n      prog => betweenEls.css('transform', betweenTranslator(prog))\n    ).then(() => betweenEls.removeAttr('style'))\n  ]).then(resolve)\n}\n\nconst swap = function () {\n  const arrow = $(this)\n  const p = arrow.parent()\n  const selector = '.' + p.attr('class').replace(' ', '.')\n  const [top, bottom] =\n    (arrow.attr('class') === 'swap-down')\n    ? [p, p.nextAll(selector + ':first')]\n    : [p.prevAll(selector + ':first'), p]\n  new Promise(swapTranslate(top, bottom)).then(() => {\n    swapDom(top, bottom)\n    sidenote.fixNotes()\n    $('.swap-up, .swap-down').remove()\n    decorate()\n  })\n}\n\nconst swapDom = (top: JQuery, bot: JQuery) => {\n  const topNext = top.next()\n  if (topNext[0] === bot[0]) {\n    bot.before(top)\n    top.before(bot)\n  } else {\n    bot.before(top)\n    topNext.before(bot)\n  }\n}\n\nconst decorate = () => {\n  const up = $('<span class=\"swap-up\"></span>')\n  const down = $('<span class=\"swap-down\"></span>')\n  const swaps = $('.swap')\n  const swapGroups = S.groupBy(S.on(S.equals)(el => $(el).attr('class')))(swaps.toArray())\n  const decorateGroup = group => {\n    S.pipe([S.tail, S.map(S.map(el => $(el).prepend(up.clone())))])(group)\n    S.pipe([S.init, S.map(S.map(el => $(el).append(down.clone())))])(group)\n  }\n  swapGroups.forEach(decorateGroup)\n  $('.swap-up, .swap-down').click(swap)\n}\n\n$(decorate)\n\n\n\n// WEBPACK FOOTER //\n// ./custom-elements/swap.wp.es.js","// @flow\n/* eslint no-undef: \"off\" */\n\nexport type Coordinate = {x: number, y: number}\n\nconst distance = (coord1: Coordinate, coord2: Coordinate): number =>\n  Math.hypot(coord1.x - coord2.x, coord1.y - coord2.y)\n\nconst circleFromChord = (startRads: number, stopRads: number, startCoord: Coordinate, stopCoord: Coordinate): {radius: number, center: Coordinate} => {\n  const radius = distance(startCoord, stopCoord) /\n    Math.sin(Math.abs(stopRads - startRads) / 2) / 2\n  const center = pointOnCircle(startCoord, radius, startRads + Math.PI)\n  return {radius, center}\n}\n\nconst pointOnCircle = ({x, y}: Coordinate, radius: number, angle: number): Coordinate => ({\n  x: x + Math.cos(angle) * radius,\n  y: y + Math.sin(angle) * radius\n})\n\nexport { distance, circleFromChord, pointOnCircle }\n\n\n\n// WEBPACK FOOTER //\n// ./libs/geometry.wp.es.js","// @flow\n/* eslint no-undef: \"off\" */\n\nimport $ from 'jquery'\nimport * as d3 from 'd3'\nimport asciiStringSplit from 'ascii-string-split'\nimport { create, env } from 'sanctuary'\n\nimport * as shapesImport from 'libs/shapes'\nimport { uniquify, documentReadyPromise } from 'libs/util'\nconst S = create({checkTypes: false, env})\n\nconst RADIUS = 13\nconst STRENGTH = 1\nconst LABEL_LENGTH = 20\n\nconst shapes = [\n  shapesImport.toSvgPolygon(shapesImport.square),\n  shapesImport.toSvgPolygon(shapesImport.circle),\n  shapesImport.toSvgPolygon(shapesImport.diamond),\n  shapesImport.toSvgPolygon(shapesImport.hexagon),\n  shapesImport.toSvgPolygon(shapesImport.pentagon),\n  shapesImport.toSvgPolygon(shapesImport.triangle)\n]\n\nconst linkArc = (link: ForceLink) => {\n  const { target, source } = link\n  const dx = target.x - source.x\n  const dy = target.y - source.y\n  const dr = Math.hypot(dx, dy)\n  return `M${source.x},${source.y}A${dr},${dr} 0 0,1 ${target.x},${target.y}`\n}\n\nconst fetchData = <NTy: string, LTy: string>(dataSrc: string): Promise<[Array<Node<NTy>>, Array<Link<LTy>>, Array<NodeType<NTy>>, Array<LinkType<LTy>>]> =>\n  Promise.all([\n    d3.csv(dataSrc + '/nodes.csv'),\n    d3.csv(dataSrc + '/links.csv'),\n    d3.csv(dataSrc + '/node-types.csv'),\n    d3.csv(dataSrc + '/link-types.csv')\n  ])\n\n// Hacky way of telling Flow about d3's property additions\nconst forceNodeProps = <T>(t: T): (T & ForceNode) => (t: any)\nconst forceLinkProps = <T>(t: T): (T & ForceLink) => (t: any)\n\nconst ticked = <A: ForceLink, B: ForceNode>(link: SelectWithData<A>, node: SelectWithData<B>) => () => {\n  link.attr('d', linkArc)\n  node.attr('transform', d => `translate(${d.x}, ${d.y})`)\n}\n\nconst mkSimulation = ({ width, height }) =>\n  d3.forceSimulation()\n  .force('link', d3.forceLink().id(d => d.id).strength(STRENGTH).distance(width / 5))\n  .force('charge', d3.forceManyBody().strength(-250))\n  .force('center', d3.forceCenter(width / 2, height / 2))\n  .alphaDecay(0.015)\n\nconst drawLibrary = <Ty: string>(id: string, svg: SelectWithoutData, linkTypes: Array<LinkType<Ty>>) => {\n  const uniqueLinkTypes = uniquify(linkTypes.map(d => d.type))\n  // Per-type markers, as they don't inherit styles.\n  const defs = svg.append('defs')\n  defs.append('g').selectAll('marker')\n    .data(uniqueLinkTypes)\n    .enter().append('marker')\n      .attr('id', d => `${id}-marker-${d}`)\n      .attr('viewBox', '0 -5 10 10')\n      .attr('refX', 15)\n      .attr('refY', -1.5)\n      .attr('markerWidth', 6)\n      .attr('markerHeight', 6)\n      .attr('orient', 'auto')\n    .append('path')\n      .attr('d', 'M0,-5L10,0L0,5')\n  defs.append('g').selectAll('linearGradient')\n    .data(uniqueLinkTypes)\n    .enter().append('linearGradient')\n      .attr('id', d => `${id}-gradient-${d}`)\n    .append('stop')\n}\n\nconst drawNode = <Ty: string>(nodeTypes: Array<NodeType<Ty>>): (Ty => string) => {\n  return type => {\n    const nodeTypeIndex = nodeTypes.findIndex(t => t.type === type)\n    if (nodeTypeIndex == null) {\n      throw Error(`Couldn't find node type ${type} in ${nodeTypes.toString()}`)\n    }\n    return shapes[nodeTypeIndex](RADIUS)\n  }\n}\n\nconst drawLinks = <Ty: string>(id: string, svg: SelectWithoutData, links: Array<Link<Ty>>): SelectWithData<Link<Ty> & ForceLink> =>\n  svg.append('g')\n    .attr('class', 'links')\n  .selectAll('path')\n  .data(S.map(forceLinkProps)(links))\n  .enter().append('path')\n    .attr('class', d => d.type)\n    .classed('link', true)\n    .attr('marker-end', d => `url(#${id}-marker-${d.type})`)\n    .attr('stroke', d => `url(#${id}-gradient-${d.type})`)\n\nconst drawNodes = (svg: SelectWithoutData, nodes: Array<Node<*>>, nodeTypes: Array<NodeType<*>>, simulation: Simulation<Node<*>, Link<*>>): SelectWithData<Node<*> & ForceNode> => {\n  const node =\n    svg.append('g')\n        .classed('nodes', true)\n      .selectAll('g.node')\n      .data(S.map(forceNodeProps)(nodes))\n      .enter().append('g')\n        .classed('node', true)\n        .on('dblclick', dblClicked)\n        .call(d3.drag()\n          .on('start', dragStarted(simulation))\n          .on('drag', dragged)\n          .on('end', dragEnded(simulation)))\n\n  node.append('polygon')\n    .attr('class', d => d.type)\n    .attr('points', d => drawNode(nodeTypes)(d.type))\n\n  drawTSpans(d => d.label, RADIUS + 5)(node.append('a').attr('xlink:href', d => '#' + d.id).append('text'))\n  return node\n}\n\nconst mkArgMap = (id: string, dataSrc: string, canvasSelector: string): Promise<Simulation<Node<*>, Link<*>>> => {\n  return fetchData(dataSrc).then(([nodes, links, nodeTypes, linkTypes]) => {\n    const canvas = { width: $(canvasSelector).width(), height: $(canvasSelector).height() }\n    const svg = d3.select(canvasSelector).append('svg')\n        .attr('id', id)\n        .attr('width', canvas.width)\n        .attr('height', canvas.height)\n\n    const simulation = mkSimulation(canvas)\n    drawLibrary(id, svg, linkTypes)\n    const link = drawLinks(id, svg, links)\n    const node = drawNodes(svg, nodes, nodeTypes, simulation)\n\n    simulation\n      .nodes(nodes)\n      .on('tick', ticked(link, node))\n\n    simulation.force('link')\n      .links(links)\n\n    mkLegend(id, svg, nodeTypes, linkTypes)\n\n    return simulation\n  })\n}\n\nconst dragStarted = simulation => d => {\n  simulation.alphaTarget(0.3).restart()\n  d.fx = d.x\n  d.fy = d.y\n}\n\nconst dragged = d => {\n  d.fx = d3.event.x\n  d.fy = d3.event.y\n}\n\nconst dblClicked = function (d) {\n  d3.select(this).select('polygon').classed('fixed', false)\n  d.fx = null\n  d.fy = null\n}\n\nconst dragEnded = function (simulation) {\n  return function () {\n    d3.select(this).select('polygon').classed('fixed', true)\n    simulation.alphaTarget(0)\n  }\n}\n\ntype Shape = 'circle' | 'triangle' | 'diamond' | 'square' | 'pentagon' | 'hexagon'\ntype Node<Ty: string> = { label: string, type: Ty, id: string }\ntype NodeType<Ty: string> = { type: Ty, label: string, shape: Shape }\ntype Link<Ty: string> = { source: string, target: string, type: Ty }\ntype LinkType<Ty: string> = { type: Ty, label: string }\n\nconst mkLegend = <NTy: string, LTy: string>(id: string, svg: SelectWithoutData, nodeTypes: Array<NodeType<NTy>>, linkTypes: Array<LinkType<LTy>>) => {\n  const legendNode = svg.append('g')\n    .attr('transform', 'translate(80, 50)')\n    .selectAll('.legend')\n    .data(nodeTypes)\n    .enter().append('g')\n      .classed('legend', true)\n      .attr('transform', (_, i: number) => 'translate(0, ' + i * 30 + ')')\n\n  legendNode.append('polygon')\n      .attr('points', d => drawNode(nodeTypes)(d.type))\n\n  drawTSpans(d => d.label, RADIUS + 5)(legendNode.append('text'))\n\n  const legendLink = svg.append('g')\n    .attr('transform', 'translate(80, 180)')\n    .selectAll('.legend')\n    .data(S.map(forceLinkProps)(linkTypes))\n    .enter().append('g')\n      .classed('legend', true)\n      .attr('transform', (_, i: number) => 'translate(0, ' + i * 30 + ')')\n\n  legendLink.append('path')\n      .attr('d', linkArc({source: {x: -RADIUS, y: RADIUS}, target: {x: RADIUS, y: -RADIUS}}))\n      .attr('class', d => d.type)\n      .attr('stroke', d => `url(#${id}-gradient-${d.type}`)\n      .classed('link', true)\n\n  drawTSpans(d => d.label, RADIUS + 5)(legendLink.append('text'))\n}\n\nconst drawTSpans = <T>(fn: T => string, x: number): (SelectWithData<T> => any) => {\n  return el =>\n    el.selectAll('tspan')\n      .data(d => asciiStringSplit(fn(d), LABEL_LENGTH))\n      .enter().append('tspan')\n        .attr('y', (_, i: number) => 0.5 + 1.6 * i + 'ex')\n        .attr('x', x)\n        .text(d => d)\n}\n\nconst close = (map: Simulation<Node<*>, Link<*>>) => () => {\n  $('#arg-map a').removeAttr('style')\n  $('#underlay').removeClass('inactive')\n  $('#overlay').addClass('inactive')\n  history.replaceState(null, '', window.location.pathname)\n  map.stop()\n}\n\nconst open = (map: Simulation<Node<*>, Link<*>>) => (evt: ?JQueryMouseEventObject) => {\n  $('#underlay').addClass('inactive')\n  $('#overlay').removeClass('inactive')\n  $('#arg-map a').click(close(map))\n  $('#arg-map > svg, #overlay').click(function (e) {\n    if (e.target === this) { close(map)() }\n  })\n  if (evt != null) {\n    const id = $(evt.currentTarget).attr('id')\n    if (id != null) {\n      $('.node > a').removeClass('entry-point')\n      $('.node > a').filter((_, a) =>\n        // $FlowFixMe Doesn't know about SVG anchors\n        a.href.baseVal === '#' + id\n      ).addClass('entry-point')\n    }\n  }\n}\n\nconst maps: { [string]: Simulation<Node<*>, Link<*>> } = {}\n\nconst addClickHandler = () => $('a.arg-map').click(evt => {\n  const id = $(evt.currentTarget).attr('href').slice(1)\n  // This probably doesn't scale beautifully put I doubt it's a problem in practice ATM\n  $('#overlay svg').hide()\n  if (maps[id] == null) {\n    mkArgMap(id, $(`a[href=\"#${id}\"][data-data-src]`).data('data-src'), '#overlay #arg-map').then(map => {\n      maps[id] = map\n      open(map)(evt)\n    })\n  } else {\n    $('#' + id).show()\n    open(maps[id])(evt)\n    maps[id].restart()\n  }\n})\n\nconst addResizeHandler = () => {\n  $(window).resize(() => {\n    $('#arg-map svg').width($('#arg-map').width())\n    $('#arg-map svg').height($('#arg-map').height())\n  })\n}\n\nconst handleHash = () => {\n  if (location.hash.endsWith('-map')) {\n    const id = location.hash.slice(1)\n    mkArgMap(id, $(`a[href=\"#${id}\"]`).data('data-src'), '#overlay #arg-map').then(map => {\n      maps[id] = map\n      open(map)()\n    })\n  }\n}\n\ndocumentReadyPromise.then(() => {\n  addResizeHandler()\n  addClickHandler()\n  handleHash()\n})\n\n\n\n// WEBPACK FOOTER //\n// ./custom-elements/arg-map.wp.es.js","// --------------------------------------------------------------------------------\n// ASCII String Split Library\n// --------------------------------------------------------------------------------\n\nmodule.exports = exports = asciiStringSplit;\nasciiStringSplit.normalizeOptions = normalizeOptions;\n    \nfunction asciiStringSplit(str, width, options) {\n    var words = str.split(/\\s/);\n    var lines = [];\n    var line = '';\n    options = normalizeOptions(options);\n    \n    if (width < 2) {\n        throw new Error('width must be at least 2 characters');\n    }\n    \n    words.forEach(function(word) {\n        var offset;\n        \n        // ---------------------------------------------------------\n        // STEP 1: add words to the lines\n        // ---------------------------------------------------------\n        \n        // CASE 1: starting a new line\n        if (!line.length) {\n            line = word;\n        }\n            \n        // CASE 2: appending a word that fits on the current line\n        else if ( line.length + 1 + word.length  <= width ) {\n            line += ' ' + word;\n        }\n        \n        // CASE 3: word doesn't fit on the current line, and it is not allowed to be split\n        else if (!options.splitWords || !!~options.preservedWords.indexOf(word)) {\n            line.length && lines.push(line);\n            line = word;\n        }\n            \n        // CASE 4: append a big word that will be split across lines\n        // - line has at least 5 spaces left, which is room for: 1 space, 3 chars and a hyphen\n        // - word is at least 6 letters long\n        // - resulting split ensures at least 3 characters on both lines\n        else if ( line.length + 5 <= width && word.length > 5) {\n            // fill the rest of the line, leaving room for a trailing '-'\n            offset = width - line.length - 2; \n            // edge case: ensure there are at least 3 chars after the split\n            offset = offset > word.length - 3 ? word.length - 3 : offset;\n\n            line += ' ' + word.substring(0, offset) + '-';\n            lines.push(line);\n            line = word.substring(offset);\n        }\n            \n        // CASE 5: word doesn't fit on the line, so start a new line\n        else {\n            lines.push(line);\n            line = word;\n        }\n\n        // ---------------------------------------------------------\n        // STEP 2: wrap overflowed lines onto additional lines\n        // ---------------------------------------------------------\n\n        // only if splitWords is true and current word is not in preservedWords\n        if (options.splitWords && !~options.preservedWords.indexOf(word)) {\n            while (line.length > width) {\n                lines.push(line.substring(0, width-1) + '-');\n                line = line.substring(width-1);\n            }\n        }\n        \n    });\n    \n    lines.push(line);\n    \n    return lines;\n}\n\nfunction normalizeOptions(options) {\n    var newOptions = {\n        splitWords: true,\n        preservedWords: []\n    };\n\n    if (!(typeof options === 'object' || typeof options === 'undefined')) {\n        throw new Error('options must be an object');\n    }\n    options = options || {};\n    \n    if ('splitWords' in options) {\n        newOptions.splitWords = !!options.splitWords;\n    }\n    \n    if ('preservedWords' in options) {\n        if (!Array.isArray(options.preservedWords)) {\n            throw new Error('options.preservedWords must be an array');\n        }\n\n        options.preservedWords.forEach(function(str) {\n            if (typeof str !== 'string') {\n                throw new Error('options.preservedWords entries must be strings');\n            }\n            newOptions.preservedWords.push(str);\n        });\n    } \n    \n    return newOptions;\n}\n\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// /nix/store/j9c3j3x6sc64mx4xp8jlbw8lhilijaf1-node-dependencies-ColEx-0.1.0/lib/node_modules/ascii-string-split/index.js\n// module id = 1180\n// module chunks = 1","// @flow\n\nimport {create, env} from 'sanctuary'\n\nconst S = create({checkTypes: false, env})\n\nconst toSvgPolygon =\n  (angles: Array<number>) =>\n  (RADIUS: number): string =>\n  S.pipe([\n    S.map(angle => Math.cos(angle) * RADIUS + ' ' + Math.sin(angle) * RADIUS),\n    S.joinWith(', ')\n  ])(\n    angles\n  )\n\nconst triangle = [\n  3 / 6 * Math.PI,\n  7 / 6 * Math.PI,\n  11 / 6 * Math.PI\n]\nconst square = [\n  1 / 4 * Math.PI,\n  3 / 4 * Math.PI,\n  5 / 4 * Math.PI,\n  7 / 4 * Math.PI\n]\nconst diamond = [\n  0 / 2 * Math.PI,\n  1 / 2 * Math.PI,\n  2 / 2 * Math.PI,\n  3 / 2 * Math.PI\n]\nconst pentagon = [\n  3 / 10 * Math.PI,\n  7 / 10 * Math.PI,\n  11 / 10 * Math.PI,\n  15 / 10 * Math.PI,\n  19 / 10 * Math.PI\n]\nconst hexagon = [\n  1 / 6 * Math.PI,\n  3 / 6 * Math.PI,\n  5 / 6 * Math.PI,\n  7 / 6 * Math.PI,\n  9 / 6 * Math.PI,\n  11 / 6 * Math.PI\n]\nconst circle = S.map(i => 2 * Math.PI / 16 * i)(S.range(0, 16))\n\nexport { toSvgPolygon, triangle, square, diamond, pentagon, hexagon, circle }\n\n\n\n// WEBPACK FOOTER //\n// ./libs/shapes.wp.es.js","// @flow\n/* eslint no-undef: \"off\" */\n\nimport $ from 'jquery'\nimport {create, env} from 'sanctuary'\nconst S = create({checkTypes: false, env})\n\nconst getReferrer = (el: JQuery): ?JQuery =>\n  S.pipe([\n    S.toMaybe,\n    S.map(id => $('#' + id.slice(1))),\n    S.maybeToNullable\n  ])(\n    el.find('a').last().attr('href')\n  )\n\nconst fixNotes = () => {\n  S.reduce(\n    prevBot => _el => {\n      const el = $(_el)\n      el.offset((_1, {top, left}) =>\n        S.pipe([\n          S.toMaybe,\n          S.maybe_(() => {\n            prevBot = top + el.outerHeight(true)\n            return {top, left}\n          })(\n            ref => {\n              const top = S.max(ref.prev().offset().top)(prevBot)\n              prevBot = top + el.outerHeight(true)\n              return {top, left}\n            }\n          )\n        ])(\n          getReferrer(el)\n        )\n      )\n      return prevBot\n    })(\n    0)(\n    $('.sidenote').toArray())\n}\n\nconst setNotes = () => {\n  const addSidenote = el => {\n    // Putting block elements in a <p> auto-closes it so we put it immediately outside\n    const referrer = getReferrer(el)\n    if (referrer != null) {\n      const noted = referrer.prev()\n      if (noted.is(':visible')) {\n        const p = noted.closest('p');\n        (p.length === 0 ? noted : p).before('<aside class=\"sidenote\">' + $(el).html() + '</aside>')\n      }\n    }\n  }\n  const delink = () => {\n    $('.noted').next().hide()\n    $('.sidenote').each((_, el) => {\n      $(el).find('a').last().hide()\n    })\n  }\n\n  $('.footnotes').hide()\n  $('details').each((_, el) => {\n    observer.observe(el, {attributes: true})\n  })\n  $('.sidenote').not('#warnings').remove()\n  $('.footnotes > ol > li').each((_, el) => {\n    addSidenote($(el))\n  })\n  delink()\n}\n\nconst observer = new MutationObserver(fixNotes)\n\nconst removeNotes = () => {\n  observer.disconnect()\n  $('.sidenote').not('#warnings').remove()\n  $('.noted').next().show()\n  $('.footnotes').show()\n}\n\nconst addOrRemoveNotes = () => {\n  const emWidth = $(window).width() / parseFloat($('html').css('font-size'))\n  if (emWidth > 60) {\n    setNotes()\n    // $FlowFixMe\n    document.fonts.ready.then(fixNotes)\n    MathJax.Hub.Queue(() => {\n      fixNotes()\n    })\n  } else {\n    removeNotes()\n  }\n}\n\n$(() => {\n  addOrRemoveNotes()\n  $(window).resize(addOrRemoveNotes)\n})\n\nexport default {setNotes, fixNotes}\n\n\n\n// WEBPACK FOOTER //\n// ./custom-elements/sidenote.wp.es.js","// @flow\n/* eslint no-undef: \"off\" */\n\nimport $ from 'jquery'\nimport {create, env} from 'sanctuary'\nconst S = create({checkTypes: false, env})\n\nconst defaultHandlers = (el: JQuery) => {\n  if (el.attr('type') === 'radio') {\n    const menu = el.closest('menu')\n    const item = menu.find(`[label=\"${el.text()}\"]`)\n    handleEvent({ tag: 'ITEMSELECT', menu, item })\n  }\n}\n\nconst getMenu = (el: HTMLElement) => $('#' + $(el).closest('[type=\"menu\"]').attr('data-menu'))\n\nconst renderMenuItem = (menuItem: MenuItem): JQuery => {\n  switch (menuItem.tag) {\n    case 'HR':\n      return $('<hr/>')\n    case 'MENUITEM':\n      const li = $('<li/>').text(menuItem.label).attr('type', menuItem.type)\n      if (menuItem.active) {\n        li.attr('checked', 'checked')\n      } else {\n        li.removeAttr('checked')\n      }\n      return li\n    default:\n      throw Error(menuItem.toString())\n  }\n}\n\nconst renderMenu = (menu: Menu): ?JQuery => {\n  switch (menu.tag) {\n    case 'CLOSED':\n      return null\n    case 'OPEN':\n      return $('<ul class=\"menu\"></ul>').append(S.map(renderMenuItem)(menu.items))\n  }\n}\n\ntype MenuItemType = 'radio' | string\n\ntype MenuItem\n  = { tag: 'HR' }\n  | { tag: 'MENUITEM', label: string, type: MenuItemType, active: boolean }\n\ntype Menu\n  = { tag: 'OPEN', items: Array<MenuItem> }\n  | { tag: 'CLOSED' }\n\n// The JQuery declaration seems to be wrong\nconst fixTarget = (target: EventTarget) => HTMLElement = (target: any) // eslint-disable-line no-return-assign\n\nconst parseMenuItem = (menuItem: JQuery): MenuItem => {\n  switch (menuItem.get(0).nodeName) {\n    case 'HR':\n      return { tag: 'HR' }\n    case 'MENUITEM':\n      return { tag: 'MENUITEM',\n        label: menuItem.attr('label'),\n        type: menuItem.attr('type'),\n        active: menuItem.attr('checked') === 'checked'\n      }\n    default:\n      throw Error(menuItem.toString())\n  }\n}\n\nconst parseMenu = (menu: JQuery): Menu =>\n  menu.data('active')\n  ? { tag: 'CLOSED' }\n  : { tag: 'OPEN',\n    items: S.map((el) => parseMenuItem($(el)))(menu.children('menuitem, hr').toArray())\n  }\n\ntype Event\n  = { tag: 'MENUCLICK', menu: JQuery }\n  | { tag: 'ITEMSELECT', item: JQuery, menu: JQuery }\n\nconst handleEvent = (event: Event) => {\n  switch (event.tag) {\n    case 'MENUCLICK':\n      S.pipe([\n        parseMenu,\n        renderMenu,\n        S.toMaybe,\n        S.maybe_(\n          () => {\n            $('ul.menu').remove()\n            event.menu.data('active', false)\n          })(\n          menuDom => {\n            event.menu.append(menuDom)\n            event.menu.data('active', true)\n          }\n        )\n      ])(\n        event.menu\n      )\n      break\n    case 'ITEMSELECT':\n      $('ul.menu').remove()\n      event.menu.data('active', false)\n      S.map(el => $(el).removeAttr('checked'))(event.menu.children().toArray())\n      event.item.attr('checked', 'checked')\n      break\n  }\n}\n\nconst toggleMenu = (ev: JQueryMouseEventObject) => {\n  // Menu shouldn't popup when clicking on interactive element\n  const isInter = [\n    'TEXTAREA',\n    'BUTTON',\n    'INPUT',\n    'OPTION',\n    'SELECT',\n    'DETAILS',\n    'SUMMARY',\n    'A'\n  ].some(tg => fixTarget(ev.target).nodeName === tg)\n  if (isInter) { return }\n  const isPopup = el =>\n    $(el).get(0).nodeName === 'MENU' && $(el).attr('type') === 'popup'\n  const menu = getMenu(fixTarget(ev.target)).filter((_, el) => isPopup(el))\n  if (menu != null) {\n    handleEvent({ tag: 'MENUCLICK', menu: $(menu) })\n  }\n}\n\n$(() => {\n  $('[type=\"menu\"]').each((_, el) => {\n    $(el).click(toggleMenu)\n  })\n})\n\nexport default {getMenu, defaultHandlers}\n\n\n\n// WEBPACK FOOTER //\n// ./custom-elements/menu.wp.es.js"],"sourceRoot":""}