{"version":3,"sources":["webpack:///./js/menu.wp.es.js","webpack:///./js/custom-elements.wp.es.js","webpack:///./js/tree.wp.es.js","webpack:///./js/swap.wp.es.js","webpack:///./js/sidenote.wp.es.js"],"names":["_jquery","__webpack_require__","defaultHandlers","el","attr","gp","mn","closest","sel","children","removeAttr","_jquery2","default","index","parent","remove","getMenu","buildMenu","contents","map","_","nodeName","el_","lb","li","text","each","at","menuItem","get","concat","menu","flattened","Array","prototype","apply","l","length","finalContents","reduce","pv","cv","i","onEnd","prevHr","isEmpty","push","append","toggleMenu","ev","some","tg","target","stopPropagation","filter","isPopup","this","pe","isMenu","isSelfPop","ul","click","choose","tr","ch","from","to","finalCb","is","removeClass","addClass","start","prog","pho","phn","stage2","timestamp","css","requestAnimationFrame","stage1","height","transition","siblings","_sidenote2","setNotes","fixNotes","_menu2","e","_ref","pageY","pageX","offset","top","left","_ref2","off","addMenuHandlers","MathJax","Hub","Queue","inlines","circleFromChord","startRads","stopRads","startCoord","stopCoord","coord1","coord2","radius","Math","sqrt","pow","x","y","sin","abs","center","cos","swapTranslate","topEl","bottomEl","cb","bottom","betweenEls","nextUntil","_translations","bottomToTop","between","topToBottom","angle","PI","mkTranslator","trans","startAngle","_circleFromChord","_pointOnCircle","pointOnCircle","topTranslator","bottomTranslator","betweenTranslator","step","swap","arrow","p","selector","replace","nextAll","prevAll","swapDom","decorate","a","b","aNext","next","aSib","before","up","down","swapGroups","fn","ar","acc","accIndex","groupBy","el1","el2","toArray","forEach","$el","prepend","clone","referrer","id","find","last","undefined","slice","prevBot","pofs","prev","outerHeight","n","not","noted","html","addSidenote","hide","MutationObserver","observe","attributes","document","fonts","ready","then"],"mappings":"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","file":"custom-elements.js","sourcesContent":["import $ from 'jquery'\n\nconst defaultHandlers = el => {\n  if (el.attr('type') === 'radio') { \n    const gp = el.attr('radiogroup');\n    const mn = el.closest('menu');\n    const sel = gp ? 'menuitem[radiogroup=\"'+gp+'\"]' : 'menuitem:not([radiogroup])';\n    mn.children(sel).removeAttr('checked');\n    $(mn.children()[el.index()]).attr('checked', 'checked');\n  }\n  el.parent().remove();\n};\nconst getMenu = el => $('#'+ $(el).closest('[type=\"menu\"]').attr('data-menu'));\n\nconst buildMenu = el => {\n  const menuItem = el_ => {\n    const el = $(el_);\n    const lb = el.attr('label');\n    if (lb !== null) {\n      const li = $('<li/>').text(lb);\n      $(['onclick', 'checked', 'type', 'radiogroup']).each((_, at) => {\n        li.attr(at, el.attr(at));\n      });\n      return [li];\n    } else {\n      return [];\n    }\n  };\n  const menu = (el_) => {\n    const el = $(el_);\n    const lb = el.attr('label');\n    if (lb !== null) {\n      return [$('<li>'+lb+'</li>').get()];\n    } else {\n      return [$('<hr/>').get()].concat(buildMenu(el), [$('<hr/>').get()]);\n    }\n  };\n\n  const contents = $(el).children('menuitem, hr, menu').map((_, el) => {\n    switch (el.nodeName) {\n    case 'MENUITEM':\n      return menuItem(el);\n    case 'HR':\n      return [el];\n    case 'MENU':\n      return menu(el);\n    }\n  });\n  const flattened = Array.prototype.concat.apply([], contents);\n  const l = flattened.length;\n  const finalContents = flattened.reduce((pv, cv, i) => {\n    const onEnd = i === 0 || i === (l - 1);\n    const prevHr = typeof pv[i-1] !== 'undefined' && pv[i-1].nodeName === 'HR';\n    const isEmpty = cv.nodeName === 'LI' && $(cv).text() === '';\n    if ((onEnd || prevHr) && cv.nodeName === 'HR' || isEmpty) {\n      return pv;\n    } else {\n      pv.push(cv);\n      return pv;\n    }\n  }, []);\n  return $('<ul class=\"menu\"></ul>').append(finalContents);\n};\n\nconst toggleMenu = ev => {\n  // Menu shouldn't popup when clicking on interactive element\n  const isInter = [\n    'TEXTAREA',\n    'BUTTON',\n    'INPUT',\n    'OPTION',\n    'SELECT',\n    'DETAILS',\n    'SUMMARY',\n    'A'\n  ].some(tg => ev.target.nodeName == tg);\n  if (isInter) {return;}\n  \n  ev.stopPropagation();\n  const isPopup = function () {\n    const el = $(this);\n    const pe = el.parent().get(0);\n    \n    const isMenu = this.nodeName === 'MENU';\n    const isSelfPop = el.attr('type') === 'popup';\n    \n    return isMenu && (isSelfPop || typeof pe !== 'undefined' && isPopup(pe));\n  };\n  \n  const mn = getMenu(ev.target).filter(isPopup);\n  let ul = mn.children('ul.menu');\n  $('ul.menu').remove();\n  if (ul.length === 0) {\n    ul = buildMenu(mn);\n    ul.children().click(ev => {\n      defaultHandlers($(ev.target));\n    });\n    mn.append(ul);\n  }\n};\n\n$(() => {\n  $('[type=\"menu\"]').each((_, el) => {\n    $(el).click(toggleMenu);\n  });\n});\n\nexport default {getMenu, defaultHandlers}\n\n\n\n// WEBPACK FOOTER //\n// ./js/menu.wp.es.js","import 'tree'\nimport 'swap'\nimport 'sidenote'\nimport 'menu'\n\n\n\n// WEBPACK FOOTER //\n// ./js/custom-elements.wp.es.js","import $ from 'jquery'\n\nimport menu from 'menu'\nimport sidenote from 'sidenote'\n\nconst transition = (from, to, finalCb) => {\n  if (typeof from[0] === 'undefined') { return; }\n  const parent = to.parent();\n  if (!parent.is(':visible')) {\n    from.removeClass('open');\n    to.addClass('open');\n    return;\n  }\n  let start, prog, pho, phn;\n  const dur1 = 300;\n  const stage1 = timestamp => {\n    start = start || timestamp;\n    prog = (timestamp - start) / dur1;\n    if (prog <= 1) {\n      from.css('opacity', 1 - prog);\n      requestAnimationFrame(stage1);\n    } else {\n      pho = parent.height();\n      from.css('opacity', 0);\n      to.css('opacity', 0);\n      from.removeClass('open');\n      to.addClass('open');\n      phn = parent.height();\n      start = timestamp;\n      requestAnimationFrame(stage2);\n    }\n    return;\n  };\n  const dur2 = 300;\n  const stage2 = timestamp => {\n    prog = (timestamp - start) / dur2;\n    if (prog <= 1) {\n      to.css('opacity', prog);\n      parent.css('height', pho + (phn - pho) * prog);\n      requestAnimationFrame(stage2);\n    } else {\n      parent.removeAttr('style'); \n      from.removeAttr('style'); \n      to.removeAttr('style'); \n      finalCb();\n    }\n    return;\n  };\n  requestAnimationFrame(stage1);\n};\n    \nconst choose = ev => {\n  ev.stopPropagation();\n  const el = $(ev.target);\n  const trs = $('[data-menu=\"' + $(ev.target).closest('menu').attr('id') + '\"]');\n  trs.each((_, tr) => {\n    const ch = $($(tr).children()[el.index()]);\n    transition(ch.siblings('.open'), ch, () => {\n      sidenote.setNotes();\n      sidenote.fixNotes();\n    });\n  });\n  menu.defaultHandlers(el);\n};\n\n$(() => {\n  $('[type=\"menu\"]').each((_, el_) => {\n    const position = ({pageY, pageX, target}) => {\n      const mn = menu.getMenu(target);\n      mn.offset({top: pageY, left: pageX});\n    };\n    const addMenuHandlers = ({target}) => {\n      menu.getMenu(target).children('.menu').children().off().click(choose);\n    };\n    $(el_).click(e => {position(e); addMenuHandlers(e);});\n  });\n\n  MathJax.Hub.Queue(() => {\n    // Messes up rendering if we add to stylesheet\n    $('.MathJax_MathContainer').css('display', 'inline');\n    $('.MathJax_MathContainer > span').css('display', 'inline');\n    // Re-inline fix rendering problem\n    const inlines = $('.switch.inline > li.open');\n    inlines.css('display', 'inline-block');\n    inlines.offset(); // Trigger reflow\n    inlines.css('display', 'inline');\n    inlines.removeAttr('style');\n  });\n});\n\n\n\n// WEBPACK FOOTER //\n// ./js/tree.wp.es.js","// Doesn't currently handle nested swaps\nimport $ from 'jquery'\n\nimport sidenote from 'sidenote'\n\nconst translations = (top, bottom) => {\n  const bottomToTop = top.offset().top - bottom.offset().top;\n  const between = bottom.height() - top.height();\n  const topToBottom = bottom.offset().top - top.offset().top +\n    (bottom.height() - top.height());\n  return {bottomToTop, between, topToBottom};\n};\n\nconst distance = (coord1, coord2) => \n  Math.sqrt(Math.pow(coord1.x - coord2.x, 2) +\n            Math.pow(coord1.y - coord2.y, 2));\n\nconst circleFromChord = (startRads, stopRads, startCoord, stopCoord) => {\n  const radius = distance(startCoord, stopCoord) /\n    Math.sin(Math.abs(stopRads - startRads) / 2) / 2;\n  const center = { \n    x: startCoord.x - Math.cos(startRads) * radius, \n    y: startCoord.y - Math.sin(startRads) * radius\n  };\n  return {radius, center};\n};\n\nconst pointOnCircle = ({x, y}, radius, angle) => ({\n  x: x + Math.cos(angle) * radius,\n  y: y + Math.sin(angle) * radius\n});\n\nconst swapTranslate = (topEl, bottomEl, cb) => {\n  const betweenEls = topEl.nextUntil(bottomEl);\n  const {bottomToTop, between, topToBottom} = translations(topEl, bottomEl);\n  \n  const angle = Math.PI/4;\n  const mkTranslator = trans => {\n    let startAngle;\n    if (trans <= 0) {\n      startAngle = Math.PI + angle;\n    } else {\n      startAngle = angle;\n    }\n    const {center, radius} = circleFromChord(startAngle,\n                                             startAngle - 2 * angle,\n                                             {x: 0, y: 0},\n                                             {x: 0, y: trans});\n    return prog => {\n      const {x, y} = pointOnCircle(center, radius,\n                                   startAngle - angle * 2 * prog);\n      return 'translate(' + x + 'px, ' + -y + 'px)';\n    };\n  };\n  const topTranslator = mkTranslator(topToBottom);\n  const bottomTranslator = mkTranslator(bottomToTop);\n  const betweenTranslator = mkTranslator(between);\n  \n  let start, prog;\n  const dur = 300;\n  const step = timestamp => {\n    start = start || timestamp;\n    prog = (timestamp - start) / dur;\n    if (prog <= 1) {\n      topEl.css('transform', topTranslator(prog));\n      bottomEl.css('transform', bottomTranslator(prog));\n      betweenEls.css('transform', betweenTranslator(prog));\n      requestAnimationFrame(step);\n    } else {\n      topEl.removeAttr('style');\n      bottomEl.removeAttr('style');\n      betweenEls.removeAttr('style');\n      cb();\n    }\n  };\n  requestAnimationFrame(step);\n};\n\nconst swap = function () {\n  let top, bottom;\n  const arrow = $(this);\n  const p = arrow.parent();\n  const selector = '.' + p.attr('class').replace(' ', '.');\n  if (arrow.attr('class') === 'swap-down') {\n    top = p;\n    bottom = p.nextAll(selector + ':first');\n  } else {\n    bottom = p;\n    top = p.prevAll(selector + ':first');\n  }\n  swapTranslate(top, bottom, () => {\n    swapDom(top, bottom);\n    sidenote.fixNotes();\n    decorate();\n  });\n};\n\nconst swapDom = (a, b) => {  \n  const aNext = a.next();\n  const aSib = aNext[0] === b[0] ? a : aNext;\n  b.before(a);\n  aSib.before(b);\n};\n\n// Assumes sorted\nconst groupBy = (fn, ar) => {\n  const l = ar.length;\n  let acc = [[ar[0]]];\n  let accIndex = 0;\n  for (let i = 1; i < l; i++) {\n    if (fn(ar[i-1], ar[i])) {\n      acc[accIndex].push(ar[i]);\n    } else {\n      accIndex += 1;\n      acc[accIndex] = [ar[i]];\n    }\n  } \n  return acc;\n};\n\nconst decorate = () => {\n  const up = $('<span class=\"swap-up\"></span>');\n  const down = $('<span class=\"swap-down\"></span>');\n  const swaps = $('.swap');\n  const swapGroups = groupBy((el1, el2) =>\n    $(el1).attr(\"class\") === $(el2).attr(\"class\"),\n    swaps.toArray());\n  const decorateGroup = gp => {\n    const l = gp.length;\n    gp.forEach((el, i) => {\n      const $el = $(el);\n      if (i !== 0) {\n        $el.prepend(up.clone());\n      }\n      if (i !== l - 1) {\n        $el.append(down.clone());\n      }\n    });\n  };\n  $('.swap-up, .swap-down').remove();\n  swapGroups.forEach(decorateGroup);\n  $('.swap-up, .swap-down').click(swap);\n};\n\n$(() => {decorate();});\n\n\n\n// WEBPACK FOOTER //\n// ./js/swap.wp.es.js","import $ from 'jquery'\n\nconst referrer = el => {\n  const id = $(el).find('a').last().attr('href');\n  if (id === undefined) {\n    return [];\n  } else {\n    return $('[id=\"'+id.slice(1)+'\"]');\n  }\n};\n\nconst fixNotes = () => {\n  let prevBot = 0;\n  const budge = (_, el_) => {\n    const el = $(el_);\n    el.offset((_, {top, left}) => {\n      const pofs = referrer(el);\n      if (pofs.length !== 0) {\n        top = pofs.prev().offset().top;\n      }\n      if (top < prevBot) {\n        top = prevBot;\n      }\n      prevBot = top + el.outerHeight(true);\n      return {top: top, left: left};\n    });\n  };\n\n  $('.sidenote').each(budge);\n};\n\nconst setNotes = n => {\n  const addSidenote = el => {\n    //Putting block elements in a <p> auto-closes it\n    let noted = referrer(el).prev();\n    if (noted.is(':visible')) {\n      const p = noted.closest('p');\n      if (p.length !== 0) {\n        noted = p;\n      }\n      noted.before('<aside class=\"sidenote\">' + $(el).html() + '</aside>');\n    }\n  };\n  const delink = () => {\n    $('.noted').next().hide();\n    $('.sidenote').each((_, el) => {\n      $(el).find('a').last().hide();\n    });\n  };\n\n  $('.sidenote').not('#warnings').remove();\n  $('#article-title').before($('#warnings'));\n  $('.footnotes > ol > li').each((_, el) => {\n    addSidenote(el);\n  });\n  delink();\n};\n\n$(() => {\n  $('.footnotes').hide();\n  setNotes();\n  $('details').each((_, el) => {\n      (new MutationObserver(fixNotes)).observe(el, {attributes: true});\n  });\n  document.fonts.ready.then(fixNotes);\n  MathJax.Hub.Queue(() => {\n    fixNotes();\n  });\n});\n\nexport default {setNotes, fixNotes}\n\n\n\n// WEBPACK FOOTER //\n// ./js/sidenote.wp.es.js"],"sourceRoot":""}