Elm.Native.Slider={},Elm.Native.Slider.make=function(e){if(e.Native=e.Native||{},e.Native.Slider=e.Native.Slider||{},e.Native.Slider.values)return e.Native.Slider.values;var t=ElmRuntime.use(ElmRuntime.Render.Utils).newElement,r=Elm.Graphics.Element.make(e).newElement;function n(r){var n=t("input");return n.type="range",n.min=r.styling.min,n.max=r.styling.max,n.step=r.styling.step,n.value=r.styling.value,r.styling.horizontal||(n.orient="vertical",n.style.webkitAppearance="slider-vertical",n.style.writingMode="bt-lr"),r.styling.disabled&&(n.disabled=!0),n.style.display="block",n.style.pointerEvents="auto",n.elm_signal=r.signal,n.elm_handler=r.handler,n.addEventListener("input",function(){e.notify(n.elm_signal.id,n.elm_handler(n.value))}),n}function o(e,t,r){r.styling.disabled?e.disabled=!0:e.disabled=!1,e.elm_signal=r.signal,e.elm_handler=r.handler,e.min=r.styling.min,e.max=r.styling.max,e.step=r.styling.step,e.value=r.styling.value}return e.Native.Slider.values={slider:F3(function(e,t,i){var u=i.length,a=24;if(!i.horizontal){var c=u;u=a,a=c}return A3(r,u,a,{ctor:"Custom",type:"Slider",render:n,update:o,model:{signal:e,handler:t,styling:i}})})}},Elm.Automaton=Elm.Automaton||{},Elm.Automaton.make=function(e){"use strict";if(e.Automaton=e.Automaton||{},e.Automaton.values)return e.Automaton.values;var t,r=Elm.Native,n=r.Utils.make(e),o=r.List.make(e),i=(r.Array.make(e),r.Error.make(e)),u="Automaton",a=Elm.Basics.make(e),c=(Elm.Cell.make(e),Elm.Color.make(e)),s=Elm.Graphics.Collage.make(e),l=Elm.Graphics.Element.make(e),m=Elm.Graphics.Input.make(e),p=Elm.Grid.make(e),_=Elm.List.make(e),f=Elm.Optics.Lens.make(e),A=(Elm.Pseudorandom.make(e),Elm.Render.make(e)),d=Elm.Signal.make(e),h=Elm.Slider.make(e),k=Elm.String.make(e),v=Elm.Text.make(e),E=Elm.Ticks.make(e),g=Elm.Transition.make(e),F=Elm.Window.make(e),T=n.replace([["typeface",o.fromArray(["Open sans"])],["color",A3(c.rgb,24,18,30)]],v.defaultStyle),y=function(e){return v.leftAligned(v.style(T)(v.toText(e)))},w=A2(_.indexedMap,F2(function(e,t){return{ctor:"_Tuple2",_0:a.toFloat(e)/3,_1:t}}),o.fromArray([0,1,10,100])),b=F2(function(e,t){return r=A2(c.linear,{ctor:"_Tuple2",_0:a.toFloat(e)/-2,_1:0},{ctor:"_Tuple2",_0:a.toFloat(e)/2,_1:0})(_.map(A2(f.over,f.snd_,function(e){return t(A.toAlpha(e))}))(w)),A2(s.gradient,r,A2(s.rect,a.toFloat(e),10));var r}),C=function(e){return s.group(A2(_.map,function(t){return function(){switch(t.ctor){case"_Tuple2":return s.moveX(a.toFloat(e)*t._0*.95)(s.toForm(y(k.show(t._1))))}i.Case(u,"between lines 85 and 86")}()},w))},L=function(e){return t=y("Wealth"),r=l.sizeOf(t),n=function(){switch(r.ctor){case"_Tuple2":return r._0}i.Case(u,"on line 100, column 16 to 34")}(),c=e-n-30,m=A2(l.flow,l.down,o.fromArray([y("Capital-managed firms"),A3(s.collage,c,35,o.fromArray([s.moveY(15)(A2(b,c,A.capitalColor)),s.moveX(a.toFloat(c)/-4*1.95)(C(c)),s.moveY(-15)(A2(b,c,A.laborColor))])),y("Labor-managed firms")])),r=l.sizeOf(m),p=function(){switch(r.ctor){case"_Tuple2":return r._1}i.Case(u,"on line 111, column 16 to 35")}(),A2(l.flow,l.right,o.fromArray([A3(l.container,n,p,l.middle)(t),A2(l.spacer,10,p),m]));var t,r,n,c,m,p},P=A2(E.totalTicks,d.constant(.002),E.run.signal),O=F6(function(e,t,r,o,i,u){return n.eq(t,e)?{ctor:"_Tuple4",_0:i,_1:r,_2:o,_3:e}:{ctor:"_Tuple4",_0:(a=g.autoStep(A2(f._op["@~"],p.altruism,u)(i))(r))._0,_1:a._1,_2:o,_3:t};var a}),x=F2(function(e,t){return function(){switch(t.ctor){case"_Tuple4":return function(){switch(e.ctor){case"_Tuple3":switch(e._0){case 0:switch(e._1.ctor){case"Reseed":return{ctor:"_Tuple4",_0:(n=p.init(e._2)(t._1))._0,_1:n._1,_2:t._1,_3:0};case"Reset":return{ctor:"_Tuple4",_0:(r=p.init(e._2)(t._2))._0,_1:r._1,_2:t._2,_3:0}}}switch(e._1.ctor){case"Pause":return{ctor:"_Tuple4",_0:t._0,_1:t._1,_2:t._2,_3:t._3};case"Play":case"Step":return A6(O,t._3,e._0,t._1,t._2,t._0,e._2)}}var r,n;i.Case(u,"between lines 62 and 69")}()}i.Case(u,"between lines 62 and 69")}()}),M=m.input(0),I=A3(h.slider,M.handle,a.identity,n.replace([["max",1],["step",.01]],h.defaultSlider)),S=F.width,N=2348912,R={ctor:"_Tuple4",_0:(t=p.init(0)(N))._0,_1:t._1,_2:N,_3:0},G=A2(d._op["<~"],function(e){return function(){switch(e.ctor){case"_Tuple4":return e._0}i.Case(u,"on line 58, column 26 to 27")}()},A3(d.foldp,x,R,A2(d._op["~"],A2(d._op["~"],A2(d._op["<~"],F3(function(e,t,r){return{ctor:"_Tuple3",_0:e,_1:t,_2:r}}),P),E.run.signal),M.signal))),$=A2(d._op["~"],A2(d._op["~"],A2(d._op["<~"],F3(function(e,t,r){return A2(l.flow,l.down,o.fromArray([L(r),A2(A.render,r,t),A2(l.spacer,1,5),A2(l.flow,l.right,o.fromArray([y("Altruism:"),A2(l.spacer,10,1),I,A2(l.spacer,10,1),y("Generation:"),A2(l.spacer,10,1),y(k.show(e))])),A2(l.spacer,1,5),E.playControls]))}),P),G),S);return e.Automaton.values={_op:{},seed:N,gridLength:25,gridSize:S,main:$,initState:R,altruism:M,altSlider:I,grid:G,update:x,step:O,ticks:P,labelSquish:.95,labels:C,stops:w,legend:b,legends:L,plainText$:y,textStyle:T},e.Automaton.values},Elm.Transition=Elm.Transition||{},Elm.Transition.make=function(e){"use strict";if(e.Transition=e.Transition||{},e.Transition.values)return e.Transition.values;var t=Elm.Native,r=t.Utils.make(e),n=t.List.make(e),o=(t.Array.make(e),t.Error.make(e)),i="Transition",u=Elm.Array.make(e),a=Elm.Basics.make(e),c=Elm.Cell.make(e),s=Elm.Dict.make(e),l=Elm.Either.make(e),m=Elm.Grid.make(e),p=Elm.List.make(e),_=Elm.Maybe.make(e),f=Elm.Optics.Lens.make(e),A=Elm.Optics.Prism.make(e),d=Elm.Optics.Traversal.make(e),h=Elm.Pseudorandom.make(e),k=Elm.Pseudorandom.Infix.make(e),v=s.map(A2(f.set,m.clean,!0)),E=s.filter(F2(function(e,t){return a.not(A2(f._op["^@"],t,m.clean))})),g=function(e){return function(t){return p.last(p.sortBy(e)(u.toList(t)))}},F=function(e){return A2(d._op["##"],m.groupAt(e),A2(d._op["@#"],m.groupType,A2(d._op["?@"],m.capitalGroup,m.accum)))},T=F3(function(e,t,r){return function(){switch(e.ctor){case"Left":return A2(d._op["#%"],A2(d._op["@#"],m.groups,F(e._0)),function(e){return e-t})(r);case"Right":return A2(d._op["#%"],A2(d._op["@#"],m.grid,A2(d._op["##"],m.index(e._0),A2(d._op["?@"],c.firm,c.accum))),function(e){return e-t})(r)}o.Case(i,"between lines 107 and 109")}()}),y=A2(a.flip,_.maybe,a.identity),w=F2(function(e,t){return function(){switch(A2(f._op["^@"],e,c.firmType).ctor){case"MkCapital":return{ctor:"_Tuple2",_0:A2(f._op["@%"],c.accum,F2(function(e,t){return e+t})(A2(f._op["^@"],e,c.laborProfit)))(e),_1:A2(d._op["#%"],F(A2(f._op["^@"],e,c.groupId)),F2(function(e,t){return e+t})(A2(f._op["^@"],e,c.capitalProfit)))(t)};case"MkLabor":return{ctor:"_Tuple2",_0:A2(f._op["@%"],c.accum,function(t){return t+A2(f._op["^@"],e,c.laborProfit)+A2(f._op["^@"],e,c.capitalProfit)})(e),_1:t}}o.Case(i,"between lines 60 and 68")}()}),b=F5(function(e,t,n,u,a){return function(){var s=A2(A._op["^?"],a,c.firm);switch(s.ctor){case"Just":return A2(k._op["<$>"],function(a){return r.cmp(a,.2)<0?function(){var a,l,p,A,h,k=A2(f._op["^@"],s._0,c.firmType);switch(k.ctor){case"MkCapital":return p=A2(f._op["^@"],s._0,c.groupId),l=A2(d._op["!#"],t,A2(d._op["##"],m.groupAt(p),A2(d._op["@?"],m.groupType,m.capitalGroup))),A=function(){switch(l.ctor){case"Just":return l._0}o.Case(i,"on line 155, column 37 to 38")}(),h=A2(f._op["^@"],A,m.accum),r.cmp(A2(f._op["^@"],n,c.cost),h)<0&&r.cmp(A2(f._op["^@"],n,c.cost),A2(f._op["^@"],A,m.threshold))<0?_.Just({ctor:"_Tuple3",_0:A2(f._op["^@"],A,m.threshold),_1:p,_2:_.Nothing}):_.Nothing;case"MkLabor":return a=A2(f._op["^@"],s._0,c.accum),r.cmp(A2(f._op["^@"],n,c.cost),a)<0&&r.cmp(A2(f._op["^@"],n,c.cost),A2(f._op["^@"],k._0,c.threshold)(e))<0?_.Just({ctor:"_Tuple3",_0:A2(f._op["^@"],k._0,c.threshold)(e),_1:A2(f._op["^@"],s._0,c.groupId),_2:_.Just(u)}):_.Nothing}o.Case(i,"between lines 147 and 161")}():_.Nothing},h.$float);case"Nothing":return h.constant(_.Nothing)}o.Case(i,"between lines 141 and 161")}()}),C=F3(function(e,t,n){return A2(k._op["=<<"],function(t){return r.eq(t,u.empty)?h.constant(_.Nothing):(a=A2(f._op["^@"],e,m.generation),s=A2(g,function(e){return function(){switch(e.ctor){case"_Tuple3":return e._0}o.Case(i,"on line 119, column 53 to 54")}()},t),p=function(){switch(s.ctor){case"_Tuple3":return s._1}o.Case(i,"on line 119, column 28 to 65")}(),A=function(){switch(s.ctor){case"_Tuple3":return s._2}o.Case(i,"on line 119, column 28 to 65")}(),function(){switch(A.ctor){case"Just":return A2(k._op["<$>"],function(e){return _.Just({ctor:"_Tuple3",_0:A3(c.defLabor,.2*e,a,p),_1:A2(f._op["^@"],n,c.cost),_2:l.Right(A._0)})},h.$float);case"Nothing":return h.constant(_.Just({ctor:"_Tuple3",_0:A2(c.defCapital,a,p),_1:A2(f._op["^@"],n,c.cost),_2:l.Left(p)}))}o.Case(i,"between lines 121 and 129")}());var a,s,p,A},h.lift(m.filterMap(a.identity))(m.combine(m.indexedMap(A3(b,A2(f._op["^@"],e,m.altruism),A2(f._op["^@"],e,m.groups),n))(A2(m.neighbors,A2(f._op["^@"],e,m.grid),t)))))}),L=A2(k._op["=<<"],function(e){return r.cmp(e,.1)<0?A2(k._op["<$>"],_.Just,c.defEmpty):h.constant(_.Nothing)},h.$float),P=F3(function(e,t,o){return A2(k._op["=<<"],function(i){return r.cmp(i,.001)<0?A2(k._op["<$>"],function(r){return _.Just({ctor:"_Tuple2",_0:A2(c.defCapital,e,t),_1:A2(d._op["#~"],m.groupAt(t),n.fromArray([m.defCapital(.2*r)]))(o)})},h.$float):r.cmp(i,.002)<0?A2(k._op["<$>"],function(r){return _.Just({ctor:"_Tuple2",_0:A3(c.defLabor,.2*r,e,t),_1:A2(d._op["#~"],m.groupAt(t),n.fromArray([m.defLabor]))(o)})},h.$float):h.constant(_.Nothing)},h.$float)}),O=F3(function(e,t,r){return function(){var u=A2(d._op["!#"],r,A2(d._op["@#"],m.grid,m.index(t)));switch(u.ctor){case"Just":switch(u._0.ctor){case"MkEmpty":return A2(k._op["=<<"],function(e){return function(){switch(e.ctor){case"Just":switch(e._0.ctor){case"_Tuple3":return h.constant(A2(f._op["@%"],m.groups,m.dirty(e._0._0))(A2(d._op["#~"],A2(d._op["@#"],m.grid,m.index(t)),n.fromArray([c.MkFirm(e._0._0)]))(A3(T,e._0._2,e._0._1,r))))}break;case"Nothing":return A2(k._op["<$>"],function(e){return function(){switch(e.ctor){case"Just":switch(e._0.ctor){case"_Tuple2":return A2(f._op["@~"],m.groups,e._0._1)(A2(d._op["#~"],A2(d._op["@#"],m.grid,m.index(t)),n.fromArray([c.MkFirm(e._0._0)]))(r))}break;case"Nothing":return r}o.Case(i,"between lines 88 and 93")}()},A3(P,A2(f._op["^@"],r,m.generation),A2(m.genGroupId,A2(f._op["^@"],r,m.generation),t),A2(f._op["^@"],r,m.groups)))}o.Case(i,"between lines 81 and 94")}()},A3(C,e,t,u._0._0));case"MkFirm":return A2(k._op["<$>"],function(e){return function(){switch(e.ctor){case"Just":return A2(d._op["#~"],A2(d._op["@#"],m.grid,m.index(t)),n.fromArray([c.MkEmpty(e._0)]))(r);case"Nothing":return a=A2(w,u._0._0,A2(f._op["^@"],r,m.groups)),s=a._0,l=a._1,A2(f._op["@~"],m.groups,A2(m.dirty,s,l))(A2(d._op["#~"],A2(d._op["@#"],m.grid,m.index(t)),n.fromArray([c.MkFirm(s)]))(r))}var a,s,l;o.Case(i,"between lines 97 and 103")}()},L)}}o.Case(i,"between lines 78 and 103")}()});return e.Transition.values={_op:{},abioP:.001,deathP:.1,claimP:.2,maxDiscount:.2,abiogenesis:P,death:L,accum:w,fromMaybe:y,groupAccum:F,cellStep:O,subCost:T,grow:C,maximumBy:g,claim:b,sweep:E,clean:v,autoStep:function(e){return A2(k._op["<$>"],function(e){return A2(f.over,m.groups,function(e){return v(E(e))})(A2(f.over,m.generation,F2(function(e,t){return e+t})(1))(e))},A3(m.foldl,F2(function(t,r){return A2(k._op["=<<"],A2(O,e,t),r)}),h.constant(e),m.indices))}},e.Transition.values},Elm.Render=Elm.Render||{},Elm.Render.make=function(e){"use strict";if(e.Render=e.Render||{},e.Render.values)return e.Render.values;var t=Elm.Native,r=t.Utils.make(e),n=t.List.make(e),o=(t.Array.make(e),t.Error.make(e)),i="Render",u=Elm.Array.make(e),a=Elm.Basics.make(e),c=Elm.Cell.make(e),s=Elm.Color.make(e),l=Elm.Dict.make(e),m=Elm.Graphics.Collage.make(e),p=(Elm.Graphics.Element.make(e),Elm.Grid.make(e)),_=Elm.List.make(e),f=Elm.Maybe.make(e),A=Elm.Optics.Lens.make(e),d=Elm.Optics.Prism.make(e),h=Elm.Optics.Traversal.make(e),k=function(e){return t=m.solid(e),r.replace([["width",2]],t);var t},v=F3(function(e,t,n){return function(){switch(n.ctor){case"_Tuple2":return function(){switch(t.ctor){case"_Tuple2":return r.eq(t._1,n._1)?(s=function(r){return A2(m.segment,{ctor:"_Tuple2",_0:r,_1:a.toFloat(t._1*e)},{ctor:"_Tuple2",_0:r,_1:a.toFloat((t._1+1)*e)})},l=a.toFloat(t._0*e),{ctor:"_Tuple2",_0:s(l+.5),_1:s(l-.5)}):r.eq(t._0,n._0)?(u=function(r){return A2(m.segment,{ctor:"_Tuple2",_0:a.toFloat(t._0*e),_1:r},{ctor:"_Tuple2",_0:a.toFloat((t._0+1)*e),_1:r})},c=a.toFloat(t._1*e),{ctor:"_Tuple2",_0:u(c+.5),_1:u(c-.5)}):o.If(i,"between lines 63 and 70")}var u,c,s,l;o.Case(i,"between lines 63 and 70")}()}o.Case(i,"between lines 63 and 70")}()}),E=function(e){return a.floor(a.toFloat(e)/a.toFloat(p.length))},g=function(e){return m.move({ctor:"_Tuple2",_0:a.toFloat(e)/-2,_1:a.toFloat(e)/-2})},F=function(e){return 1-1/A2(a.logBase,a.e,a.e+A2(a.max,e,0))*.8},T=F2(function(e,t){return function(){switch(t.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:e(t._0),_1:e(t._1)}}o.Case(i,"on line 35, column 18 to 26")}()}),y=F2(function(e,t){return function(e){return m.move(T(function(e){return a.toFloat(e)*a.toFloat(t)+a.toFloat(t)/2})(e))}}),w=A3(s.rgba,156,69,53),b=A3(s.rgb,215,233,215),C=A3(s.rgba,57,147,57),L=A3(s.rgba,116,46,153),P=function(e){return function(){switch(e.ctor){case"MkEmpty":return w(F(A2(A._op["^@"],e._0,c.cost)));case"MkFirm":return function(){switch(A2(A._op["^@"],e._0,c.firmType).ctor){case"MkCapital":return L(F(A2(A._op["^@"],e._0,c.accum)));case"MkLabor":return C(F(A2(A._op["^@"],e._0,c.accum)))}o.Case(i,"between lines 53 and 55")}()}o.Case(i,"between lines 50 and 55")}()},O=F2(function(e,t){return r=E(e),n=F2(function(t,n){return A3(y,e,r,t)(m.filled(P(n))(m.square(a.toFloat(r))))}),m.group(p.toList(A2(p.indexedMap,n,t)));var r,n}),x=F3(function(e,t,E){return g=F3(function(E,g,T){return function(){switch(g.ctor){case"_Tuple2":return function(){switch(E.ctor){case"_Tuple2":return r.eq(A2(h._op["!#"],E._1,A2(h._op["?@"],c.firm,c.groupId)),A2(h._op["!#"],g._1,A2(h._op["?@"],c.firm,c.groupId)))?T:(y=F2(function(e,r){return f.map(function(r){return function(){var u,a;switch(A2(A._op["^@"],r,c.firmType).ctor){case"MkCapital":return u=A2(h._op["!#"],A2(l.getOrFail,A2(A._op["^@"],r,c.groupId),t),A2(h._op["@#"],p.groupType,A2(h._op["?@"],p.capitalGroup,p.accum))),a=function(){switch(u.ctor){case"Just":return u._0}o.Case(i,"on line 87, column 43 to 44")}(),m.group(n.fromArray([A2(m.traced,k(s.white),e),A2(m.traced,k(L(F(a))),e)]));case"MkLabor":return A2(m.traced,k(b),e)}o.Case(i,"between lines 85 and 94")}()})(A2(d._op["^?"],r,c.firm))}),w=A3(v,e,E._0,g._0),C=w._0,P=w._1,u.append(T)(u.fromList(A2(_.filterMap,a.identity,n.fromArray([A2(y,C,E._1),A2(y,P,g._1)])))))}var y,w,C,P;o.Case(i,"between lines 80 and 97")}()}o.Case(i,"between lines 80 and 97")}()}),r.eq(E,u.empty)?u.empty:a.snd(A3(u.foldl,F2(function(e,t){return function(){switch(t.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:e,_1:A3(g,e,t._0,t._1)}}o.Case(i,"on line 100, column 40 to 58")}()}),{ctor:"_Tuple2",_0:A2(u.getOrFail,0,E),_1:u.empty},A3(u.slice,1,u.length(E),E)));var g}),M=F2(function(e,t){return r=E(e),n=function(e){return A3(e,function(e){return u.append(A2(x,r,A2(A._op["^@"],t,p.groups))(e))},u.empty,A2(A._op["^@"],t,p.grid))},m.group(u.toList(A2(u.append,n(p.indexedFoldFromBottom),n(p.indexedFoldFromLeft))));var r,n}),I=F2(function(e,t){return A3(m.collage,e,e,n.fromArray([g(e)(A2(O,e,A2(A._op["^@"],t,p.grid))),g(e)(A2(M,e,t))]))});return e.Render.values={_op:{},capitalColor:L,laborColor:C,laborAt0:b,emptyColor:w,both:T,toAlpha:F,botLeft:g,positionCell:y,color:P,cellSize:E,border:v,borderStyle:k,lineOfBorders:x,borders:M,cells:O,render:I},e.Render.values},Elm.Grid=Elm.Grid||{},Elm.Grid.make=function(e){"use strict";if(e.Grid=e.Grid||{},e.Grid.values)return e.Grid.values;var t=Elm.Native,r=t.Utils.make(e),n=t.List.make(e),o=(t.Array.make(e),t.Error.make(e)),i="Grid",u=Elm.Array.make(e),a=Elm.Basics.make(e),c=Elm.Cell.make(e),s=Elm.Dict.make(e),l=Elm.Either.make(e),m=Elm.Maybe.make(e),p=Elm.Optics.Lens.make(e),_=Elm.Optics.Prism.make(e),f=Elm.Optics.Traversal.make(e),A=Elm.Pseudorandom.make(e),d=Elm.Pseudorandom.Infix.make(e),h=u.foldl,k=u.filter,v=u.empty,E=u.map,g=A.combineA,F=A.mapA,T=u.fromList,y=u.foldr,w=u.toList,b=A2(m.maybe,n.fromArray([]),function(e){return n.fromArray([e])}),C=A2(u.foldr,u.push,u.empty),L=F3(function(e,t,r){return n=F2(function(t,r){return function(){var o={ctor:"_Tuple2",_0:A2(u.get,0,t),_1:A2(u.get,0,r)};switch(o.ctor){case"_Tuple2":switch(o._0.ctor){case"Just":switch(o._1.ctor){case"Just":return A2(u.push,A2(e,o._0._0,o._1._0),A2(n,A3(u.slice,1,u.length(t),t),A3(u.slice,1,u.length(r),r)))}}}return u.empty}()}),C(A2(n,t,r));var n}),P=F3(function(e,t,r){return function(){var n=e(t);switch(n.ctor){case"Just":return A2(u.push,n._0,r);case"Nothing":return r}o.Case(i,"between lines 137 and 139")}()}),O=function(e){return A2(u.foldl,P(e),u.empty)},x=A2(p.Lens,function(e){return e.groupType},F2(function(e,t){return r.replace([["groupType",e]],t)})),M=A2(p.Lens,function(e){return e.clean},F2(function(e,t){return r.replace([["clean",e]],t)})),I=A2(p.Lens,function(e){return e.threshold},F2(function(e,t){return r.replace([["threshold",e]],t)})),S=A2(p.Lens,function(e){return e.accum},F2(function(e,t){return r.replace([["accum",e]],t)})),N=F2(function(e,t){return{_:{},accum:e,threshold:t}}),R={ctor:"MkLabor"},G=function(e){return{ctor:"MkCapital",_0:e}},$=A2(_.Prism,G,function(e){return function(){switch(e.ctor){case"MkCapital":return l.Right(e._0)}return l.Left(e)}()}),J=F2(function(e,t){return{_:{},clean:e,groupType:t}}),B=A2(J,!1,R),U=A2(p.Lens,function(e){return e.groups},F2(function(e,t){return r.replace([["groups",e]],t)})),q=A2(p.Lens,function(e){return e.grid},F2(function(e,t){return r.replace([["grid",e]],t)})),z=A2(p.Lens,function(e){return e.altruism},F2(function(e,t){return r.replace([["altruism",e]],t)})),D=A2(p.Lens,function(e){return e.generation},F2(function(e,t){return r.replace([["generation",e]],t)})),j=F4(function(e,t,r,n){return{_:{},altruism:n,generation:r,grid:e,groups:t}}),W=F3(function(e,t,n){return o=u.length(n),r.eq(o,25)?A2(e,n,t):A3(W,e,A2(e,A3(u.slice,0,25,n),t),A3(u.slice,25,u.length(n),n));var o}),X=F3(function(e,t,n){return o=F2(function(t,i){return r.eq(t,25)?i:(a=A2(u.initialize,25,function(e){return A2(u.getOrFail,25*e+t,n)}),o(t+1)(A2(e,a,i)));var a}),A2(o,0,t);var o}),Y=function(e){return function(){switch(e.ctor){case"_Tuple2":return A2(f.Traversal,function(t){return b(u.get(25*e._0+e._1)(t))},function(t){return function(){switch(t.ctor){case"::":switch(t._1.ctor){case"[]":return A2(u.set,25*e._0+e._1,t._0)}}o.Case(i,"on line 143, column 39 to 67")}()})}o.Case(i,"between lines 142 and 143")}()},H=A2(u.initialize,Math.pow(25,2),function(e){return{ctor:"_Tuple2",_0:e/25|0,_1:A2(a.rem,e,25)}}),K=function(e){return A2(L,e,H)},Q=F2(function(e,t){return function(r){return A2(W,e,t)(K(F2(function(e,t){return{ctor:"_Tuple2",_0:e,_1:t}}))(r))}}),V=F2(function(e,t){return function(r){return A2(X,e,t)(K(F2(function(e,t){return{ctor:"_Tuple2",_0:e,_1:t}}))(r))}}),Z=F3(function(e,t,r){return A2(u.foldl,F2(function(t,r){return function(){switch(t.ctor){case"_Tuple2":return A3(e,t._0,t._1,r)}o.Case(i,"on line 126, column 49 to 58")}()}),t)(A2(K,F2(function(e,t){return{ctor:"_Tuple2",_0:e,_1:t}}),r))}),ee=F2(function(e,t){return function(){switch(t.ctor){case"_Tuple2":return a=function(e){return r.cmp(e,0)>-1&&r.cmp(e,25)<0},O(function(t){return function(){switch(t.ctor){case"_Tuple2":return a(t._0)&&a(t._1)?A2(f._op["!#"],e,Y({ctor:"_Tuple2",_0:t._0,_1:t._1})):m.Nothing}o.Case(i,"between lines 164 and 166")}()})(u.fromList(n.fromArray([{ctor:"_Tuple2",_0:t._0+1,_1:t._1},{ctor:"_Tuple2",_0:t._0-1,_1:t._1},{ctor:"_Tuple2",_0:t._0,_1:t._1+1},{ctor:"_Tuple2",_0:t._0,_1:t._1-1}])))}var a;o.Case(i,"between lines 162 and 171")}()}),te=F2(function(e,t){return function(){switch(t.ctor){case"_Tuple2":return(25*t._0+t._1)*e}o.Case(i,"on line 174, column 24 to 43")}()});return e.Grid.values={_op:{},length:25,init:function(e){return A2(d._op["<$>"],function(t){return A4(j,t,s.empty,1,e)},A.combineA(A2(u.repeat,Math.pow(25,2),A2(d._op["<$>"],c.MkEmpty,c.defEmpty))))},Automaton:j,groupAt:function(e){return A2(f.Traversal,function(t){return b(s.get(e)(t))},F2(function(t,r){return function(){switch(t.ctor){case"::":switch(t._1.ctor){case"[]":return A3(s.insert,e,t._0,r)}break;case"[]":return A2(s.remove,e,r)}o.Case(i,"between lines 44 and 46")}()}))},generation:D,altruism:z,grid:q,groups:U,Group:J,MkCapital:G,MkLabor:R,CapitalGroup:N,defCapital:function(e){return J(!1)(G(N(0)(c.capitalShare*c.stepProfit/(1-(1-c.deathP)*(1-e)))))},defLabor:B,capitalGroup:$,accum:S,threshold:I,clean:M,groupType:x,indexedFilter:function(e){return function(t){return A2(u.foldl,F2(function(t,r){return function(){switch(t.ctor){case"_Tuple2":return A2(e,t._0,t._1)?A2(u.push,t._1,r):r}o.Case(i,"between lines 95 and 97")}()}),u.empty)(K(F2(function(e,t){return{ctor:"_Tuple2",_0:e,_1:t}}))(t))}},foldFromLeft:W,foldFromBottom:X,indexedFoldFromLeft:Q,indexedFoldFromBottom:V,indexedFoldl:Z,indexedMap:K,filterMap:O,maybeCons:P,index:Y,reverse:C,map2:L,indices:H,neighbors:ee,genGroupId:te,maybeToList:b,dirty:function(e){return A2(s.update,A2(p._op["^@"],e,c.groupId),m.map(A2(p.set,M,!1)))},toList:w,foldr:y,fromList:T,mapR:F,combine:g,map:E,empty:v,filter:k,foldl:h},e.Grid.values},Elm.Cell=Elm.Cell||{},Elm.Cell.make=function(e){"use strict";if(e.Cell=e.Cell||{},e.Cell.values)return e.Cell.values;var t=Elm.Native,r=t.Utils.make(e),n=(t.List.make(e),t.Array.make(e),t.Error.make(e),Elm.Basics.make(e),Elm.Either.make(e)),o=Elm.Optics.Lens.make(e),i=Elm.Optics.Prism.make(e),u=Elm.Pseudorandom.make(e),a=Elm.Pseudorandom.Infix.make(e),c=A2(o.Lens,function(e){return e.threshold},F2(function(e,t){return r.replace([["threshold",e]],t)})),s=function(e){return{_:{},threshold:e}},l={ctor:"MkCapital"},m=function(e){return{ctor:"MkLabor",_0:e}},p=A2(i.Prism,m,function(e){return function(){switch(e.ctor){case"MkLabor":return n.Right(e._0)}return n.Left(e)}()}),_=A2(o.Lens,function(e){return e.firmType},F2(function(e,t){return r.replace([["firmType",e]],t)})),f=A2(o.Lens,function(e){return e.birthDate},F2(function(e,t){return r.replace([["birthDate",e]],t)})),A=A2(o.Lens,function(e){return e.groupId},F2(function(e,t){return r.replace([["groupId",e]],t)})),d=A2(o.Lens,function(e){return e.capitalProfit},F2(function(e,t){return r.replace([["capitalProfit",e]],t)})),h=A2(o.Lens,function(e){return e.laborProfit},F2(function(e,t){return r.replace([["laborProfit",e]],t)})),k=A2(o.Lens,function(e){return e.accum},F2(function(e,t){return r.replace([["accum",e]],t)})),v=F6(function(e,t,r,n,o,i){return{_:{},accum:r,birthDate:o,capitalProfit:t,firmType:i,groupId:n,laborProfit:e}}),E=A2(o.Lens,function(e){return e.cost},F2(function(e,t){return r.replace([["cost",e]],t)})),g=function(e){return{_:{},cost:e}},F=function(e){return{ctor:"MkEmpty",_0:e}},T=A2(i.Prism,F,function(e){return function(){switch(e.ctor){case"MkEmpty":return n.Right(e._0)}return n.Left(e)}()}),y=function(e){return{ctor:"MkFirm",_0:e}},w=A2(i.Prism,y,function(e){return function(){switch(e.ctor){case"MkFirm":return n.Right(e._0)}return n.Left(e)}()}),b=A2(a._op["<$>"],function(e){return g(.3*e)},u.$float),C=F3(function(e,t,r){return A6(v,.077,.033,0,r,t,m(s(function(t){return(.1*1.1-.7*.1)*t/(1-.9*(1-e))})))}),L=F2(function(e,t){return A6(v,.1*.7,.03,0,t,e,l)});return e.Cell.values={_op:{},laborShare:.7,capitalShare:.3,stepProfit:.1,laborAdvantage:1.1,deathP:.1,maxCost:.3,MkFirm:y,MkEmpty:F,firm:w,emptyCell:T,Empty:g,cost:E,Firm:v,accum:k,laborProfit:h,capitalProfit:d,groupId:A,birthDate:f,firmType:_,MkLabor:m,MkCapital:l,labor:p,Labor:s,threshold:c,defLabor:C,defCapital:L,defEmpty:b},e.Cell.values},Elm.Optics=Elm.Optics||{},Elm.Optics.Traversal=Elm.Optics.Traversal||{},Elm.Optics.Traversal.make=function(e){"use strict";if(e.Optics=e.Optics||{},e.Optics.Traversal=e.Optics.Traversal||{},e.Optics.Traversal.values)return e.Optics.Traversal.values;var t={},r=Elm.Native,n=(r.Utils.make(e),r.List.make(e)),o=(r.Array.make(e),r.Error.make(e)),i="Optics.Traversal",u=Elm.Basics.make(e),a=(Elm.Either.make(e),Elm.List.make(e)),c=Elm.Maybe.make(e),s=Elm.Optics.Lens.make(e),l=Elm.Optics.Prism.make(e),m=function(e){return n.fromArray([e])},p=A2(c.maybe,n.fromArray([]),m),_=function(e){return e.set};t["#~"]=_;var f=function(e){return e.view};t["^#"]=u.flip(f);var A=function(e){return function(t){return r=f(e)(t),function(){switch(r.ctor){case"::":return c.Just(r._0);case"[]":return c.Nothing}o.Case(i,"between lines 28 and 30")}();var r}};t["!#"]=u.flip(A);var d=F3(function(e,t,r){return A3(_,e,a.map(t)(A2(f,e,r)),r)});t["#%"]=d;var h=F2(function(e,t){return{_:{},set:t,view:e}});t["##"]=F2(function(e,t){return A2(h,function(r){return a.concatMap(f(t))(f(e)(r))},function(r){return A2(d,e,function(e){return A3(_,t,r,e)})})});var k=function(e){return A2(h,function(t){return p(l.preview(e)(t))},F2(function(t,r){return function(){var n=e.matching(r);switch(n.ctor){case"Left":return n._0;case"Right":return A3(l.set,e,a.head(t),r)}o.Case(i,"between lines 60 and 62")}()}))};t["#?"]=F2(function(e,r){return A2(t["##"],e,k(r))}),t["?#"]=F2(function(e,r){return A2(t["##"],k(e),r)}),t["?#?"]=F2(function(e,r){return A2(t["##"],k(e),k(r))});var v=function(e){return A2(h,function(t){return m(s.view(e)(t))},function(t){return function(){switch(t.ctor){case"::":switch(t._1.ctor){case"[]":return A2(s.set,e,t._0)}}o.Case(i,"on line 66, column 30 to 40")}()})};return t["#@"]=F2(function(e,r){return A2(t["##"],e,v(r))}),t["@#"]=F2(function(e,r){return A2(t["##"],v(e),r)}),t["?@"]=F2(function(e,r){return A2(t["##"],k(e),v(r))}),t["@?"]=F2(function(e,r){return A2(t["##"],v(e),k(r))}),t["@#@"]=F2(function(e,r){return A2(t["##"],v(e),v(r))}),e.Optics.Traversal.values={_op:t,Traversal:h,view:f,preview:A,set:_,over:d,single:m,maybeToList:p,pToT:k,lToT:v},e.Optics.Traversal.values},Elm.Optics=Elm.Optics||{},Elm.Optics.Lens=Elm.Optics.Lens||{},Elm.Optics.Lens.make=function(e){"use strict";if(e.Optics=e.Optics||{},e.Optics.Lens=e.Optics.Lens||{},e.Optics.Lens.values)return e.Optics.Lens.values;var t={},r=Elm.Native,n=(r.Utils.make(e),r.List.make(e),r.Array.make(e),r.Error.make(e)),o="Optics.Lens",i=Elm.Basics.make(e),u=function(e){return e.set};t["@~"]=u;var a=function(e){return e.view};t["^@"]=i.flip(a);var c=F3(function(e,t,r){return A3(u,e,t(A2(a,e,r)),r)});t["@%"]=c;var s=F2(function(e,t){return{_:{},set:t,view:e}});t["@@"]=F2(function(e,t){return A2(s,function(r){return a(t)(a(e)(r))},function(r){return c(e)(u(t)(r))})});var l=A2(s,i.fst,F2(function(e,t){return function(){switch(t.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:e,_1:t._1}}n.Case(o,"on line 33, column 32 to 36")}()})),m=A2(s,i.snd,F2(function(e,t){return function(){switch(t.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:t._0,_1:e}}n.Case(o,"on line 36, column 32 to 36")}()}));return e.Optics.Lens.values={_op:t,set:u,view:a,over:c,fst_:l,snd_:m,Lens:s},e.Optics.Lens.values},Elm.Optics=Elm.Optics||{},Elm.Optics.Prism=Elm.Optics.Prism||{},Elm.Optics.Prism.make=function(e){"use strict";if(e.Optics=e.Optics||{},e.Optics.Prism=e.Optics.Prism||{},e.Optics.Prism.values)return e.Optics.Prism.values;var t={},r=Elm.Native,n=(r.Utils.make(e),r.List.make(e),r.Array.make(e),r.Error.make(e)),o="Optics.Prism",i=Elm.Basics.make(e),u=Elm.Either.make(e),a=Elm.Maybe.make(e),c=F2(function(e,t){return function(r){return A2(u.either,i.identity,i.always(e.inject(t)))(e.matching(r))}});t["?~"]=c;var s=F3(function(e,t,r){return A2(u.either,i.identity,function(n){return A3(c,e,t(n),r)})(e.matching(r))});t["?%"]=s;var l=function(e){return function(t){return A2(u.either,i.always(a.Nothing),a.Just)(e.matching(t))}};t["^?"]=i.flip(l);var m=F2(function(e,t){return{_:{},inject:e,matching:t}});t["??"]=F2(function(e,t){return A2(m,function(r){return e.inject(t.inject(r))},function(r){return A2(u.either,u.Left,function(r){return A2(u.either,function(t){return u.Left(e.inject(t))},u.Right)(t.matching(r))})(e.matching(r))})});var p=A2(m,a.Just,function(e){return function(){switch(e.ctor){case"Just":return u.Right(e._0);case"Nothing":return u.Left(a.Nothing)}n.Case(o,"between lines 36 and 38")}()}),_=A2(m,i.always(a.Nothing),function(e){return function(){switch(e.ctor){case"Just":return u.Left(e);case"Nothing":return u.Right({ctor:"_Tuple0"})}n.Case(o,"between lines 41 and 43")}()});return e.Optics.Prism.values={_op:t,set:c,preview:l,over:s,just_:p,nothing_:_,Prism:m},e.Optics.Prism.values},Elm.Pseudorandom=Elm.Pseudorandom||{},Elm.Pseudorandom.make=function(e){"use strict";if(e.Pseudorandom=e.Pseudorandom||{},e.Pseudorandom.values)return e.Pseudorandom.values;var t=Elm.Native,r=(t.Utils.make(e),t.List.make(e)),n=(t.Array.make(e),t.Error.make(e)),o="Pseudorandom",i=Elm.Array.make(e),u=Elm.Basics.make(e),a=Elm.List.make(e),c=Elm.Pseudorandom.Infix.make(e),s=Elm.Pseudorandom.Internal.make(e),l=F2(function(e,t){return u.fst(t(e))}),m=function(e){return{ctor:"_Tuple2",_0:t=s.xorshift(e),_1:t};var t},p=F2(function(e,t){return A2(c._op["=<<"],e,t)}),_=F2(function(e,t){return A2(c._op["<*>"],e,t)}),f=F2(function(e,t){return{ctor:"_Tuple2",_0:e,_1:t}}),A=A2(a.foldr,F2(function(e,t){return A2(c._op["<*>"],A2(c._op["<$>"],F2(function(e,t){return A2(a._op["::"],e,t)}),e),t)}),f(r.fromArray([]))),d=A2(i.foldl,F2(function(e,t){return A2(c._op["<*>"],A2(c._op["<$>"],i.push,e),t)}),f(i.empty)),h=F2(function(e,t){return A2(c._op["<$>"],e,t)});return e.Pseudorandom.values={_op:{},constant:f,andThen:p,combine:A,map:function(e){return function(t){return A(a.map(e)(t))}},$int:m,$float:function(e){return t=m(e),function(){switch(t.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:u.toFloat(u.abs(t._0)-1)/(0-s.minInt),_1:t._1}}n.Case(o,"on line 72, column 22 to 54")}();var t},range:function(e){return function(t){return r=m(t),function(){switch(r.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:A2(s.roundClamp,e,r._0),_1:r._1}}n.Case(o,"on line 76, column 25 to 43")}();var r}},get:l,mapA:function(e){return function(t){return d(i.map(e)(t))}},combineA:d,lift:h,apply:_},e.Pseudorandom.values},Elm.Pseudorandom=Elm.Pseudorandom||{},Elm.Pseudorandom.Infix=Elm.Pseudorandom.Infix||{},Elm.Pseudorandom.Infix.make=function(e){"use strict";if(e.Pseudorandom=e.Pseudorandom||{},e.Pseudorandom.Infix=e.Pseudorandom.Infix||{},e.Pseudorandom.Infix.values)return e.Pseudorandom.Infix.values;var t={},r=Elm.Native,n=(r.Utils.make(e),r.List.make(e),r.Array.make(e),r.Error.make(e)),o="Pseudorandom.Infix",i=Elm.Basics.make(e);Elm.Pseudorandom.Internal.make(e);return t["=<<"]=F2(function(e,t){return function(r){return i.uncurry(e)(t(r))}}),t["<=<"]=F3(function(e,r,n){return A2(t["=<<"],e,r(n))}),t["<*>"]=F2(function(e,t){return function(r){return i=t(r),function(){switch(i.ctor){case"_Tuple2":return t=e(i._1),function(){switch(t.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:t._0(i._0),_1:t._1}}n.Case(o,"on line 23, column 39 to 46")}()}var t;n.Case(o,"on line 23, column 39 to 56")}();var i}}),t["<$>"]=F2(function(e,t){return function(r){return i=t(r),function(){switch(i.ctor){case"_Tuple2":return{ctor:"_Tuple2",_0:e(i._0),_1:i._1}}n.Case(o,"on line 18, column 24 to 30")}();var i}}),e.Pseudorandom.Infix.values={_op:t},e.Pseudorandom.Infix.values},Elm.Pseudorandom=Elm.Pseudorandom||{},Elm.Pseudorandom.Internal=Elm.Pseudorandom.Internal||{},Elm.Pseudorandom.Internal.make=function(e){"use strict";if(e.Pseudorandom=e.Pseudorandom||{},e.Pseudorandom.Internal=e.Pseudorandom.Internal||{},e.Pseudorandom.Internal.values)return e.Pseudorandom.Internal.values;var t=Elm.Native,r=(t.Utils.make(e),t.List.make(e),t.Array.make(e),t.Error.make(e)),n=Elm.Basics.make(e),o=Elm.Bitwise.make(e),i=F2(function(e,t){return function(){switch(e.ctor){case"_Tuple2":return e._0+A2(n._op["%"],t-e._0,e._1-e._0+1)}r.Case("Pseudorandom.Internal","on line 23, column 23 to 47")}()});return e.Pseudorandom.Internal.values={_op:{},xorshift:function(e){return t=A2(o.xor,e,A2(o.shiftLeft,e,13)),r=A2(o.xor,t,A2(o.shiftRight,t,17)),A2(o.xor,r,A2(o.shiftLeft,r,5));var t,r},roundClamp:i,maxInt:2147483647,minInt:-2147483648},e.Pseudorandom.Internal.values},Elm.Slider=Elm.Slider||{},Elm.Slider.make=function(e){"use strict";if(e.Slider=e.Slider||{},e.Slider.values)return e.Slider.values;var t=Elm.Native,r=(t.Utils.make(e),t.List.make(e),t.Array.make(e),t.Error.make(e),Elm.Graphics.Element.make(e),Elm.Graphics.Input.make(e),Elm.Native.Slider.make(e).slider),n=F7(function(e,t,r,n,o,i,u){return{_:{},disabled:t,horizontal:e,length:r,max:o,min:n,step:i,value:u}});return e.Slider.values={_op:{},SliderStyle:n,defaultSlider:{_:{},disabled:!1,horizontal:!0,length:100,max:100,min:0,step:1,value:0},slider:r},e.Slider.values},Elm.Ticks=Elm.Ticks||{},Elm.Ticks.make=function(e){"use strict";if(e.Ticks=e.Ticks||{},e.Ticks.values)return e.Ticks.values;var t=Elm.Native,r=(t.Utils.make(e),t.List.make(e)),n=(t.Array.make(e),t.Error.make(e)),o="Ticks",i=Elm.Basics.make(e),u=Elm.Graphics.Element.make(e),a=Elm.Graphics.Input.make(e),c=Elm.Signal.make(e),s=Elm.Time.make(e),l=c.countIf(function(e){return function(){switch(e.ctor){case"Step":return!0}return!1}()}),m=F2(function(e,t){return r=F2(function(e,t){return function(){switch(t.ctor){case"_Tuple2":return function(){switch(e.ctor){case"_Tuple2":return function(){switch(e._0.ctor){case"Reseed":case"Reset":return{ctor:"_Tuple2",_0:0,_1:e._1}}return{ctor:"_Tuple2",_0:e._1-t._1,_1:t._1}}()}n.Case(o,"between lines 30 and 33")}()}n.Case(o,"between lines 30 and 33")}()}),A2(c._op["<~"],i.fst,A3(c.foldp,r,{ctor:"_Tuple2",_0:0,_1:0},A2(c._op["~"],A2(c._op["<~"],F2(function(e,t){return{ctor:"_Tuple2",_0:e,_1:t}}),e),t)));var r}),p=function(e){return function(){switch(e.ctor){case"Play":return!0}return!1}()},_=F2(function(e,t){return r=A2(c._op["~"],A2(c._op["<~"],F2(function(e,t){return{ctor:"_Tuple2",_0:e,_1:t}}),A2(s.fpsWhen,30,A2(c._op["<~"],p,t))),e),A2(c._op["<~"],i.floor,A3(c.foldp,F2(function(e,t){return function(){switch(e.ctor){case"_Tuple2":return t+e._0*e._1}n.Case(o,"on line 44, column 48 to 60")}()}),0,r));var r}),f=F2(function(e,t){return c.dropRepeats(A2(c._op["~"],A2(c._op["<~"],F2(function(e,t){return e+t}),A2(m,t,l(t))),A2(m,t,A2(_,e,t))))}),A={ctor:"Reseed"},d={ctor:"Reset"},h={ctor:"Pause"},k=a.input(h),v={ctor:"Play"},E={ctor:"Step"},g=A2(u.flow,u.down,r.fromArray([A2(u.flow,u.right,r.fromArray([A3(a.button,k.handle,v,"Play"),A3(a.button,k.handle,h,"Pause"),A3(a.button,k.handle,E,"Step")])),A2(u.spacer,1,5),A2(u.flow,u.right,r.fromArray([A3(a.button,k.handle,d,"Reset"),A3(a.button,k.handle,A,"Reseed")]))]));return e.Ticks.values={_op:{},playControls:g,Step:E,Play:v,Pause:h,Reset:d,Reseed:A,run:k,playing:p,reset:m,stepTicks:l,playTicks:_,totalTicks:f},e.Ticks.values};
