var PS=PS||{};PS.Prelude=function(){"use strict";function n(n){return function(r){return[n].concat(r)}}function r(n){return JSON.stringify(n)}function e(n){return n.toString()}function t(n){return function(r){for(var e=[],t=0,u=r.length;u>t;t++)e[t]=n(r[t]);return"["+e.join(",")+"]"}}function u(n){return function(r){return n+r}}function a(n){return function(r){return n-r}}function o(n){return function(r){return n*r}}function i(n){return function(r){return n/r}}function l(n){return function(r){return n===r}}function c(n){return function(r){return n!==r}}function f(n){return function(r){return function(e){if(r.length!==e.length)return!1;for(var t=0;t<r.length;t++)if(!n(r[t])(e[t]))return!1;return!0}}}function s(n){return function(r){return function(e){return function(t){return function(u){return u>t?n:t>u?e:r}}}}}function v(n){return function(r){return n&&r}}function _(n){return function(r){return n||r}}function P(n){return!n}function p(n){return function(r){return n+r}}var d=function(n){return n},S=function(){function n(){}return n.value=new n,n}(),h=function(){function n(){}return n.value=new n,n}(),w=function(){function n(){}return n.value=new n,n}(),m=function(n){this["<<<"]=n},y=function(n,r){this["__superclass_Prelude.Semigroupoid_0"]=n,this.id=r},g=function(n){this.show=n},A=function(n){this["<$>"]=n},b=function(n,r){this["<*>"]=n,this["__superclass_Prelude.Functor_0"]=r},T=function(n,r){this["__superclass_Prelude.Apply_0"]=n,this.pure=r},M=function(n,r){this[">>="]=n,this["__superclass_Prelude.Apply_0"]=r},D=function(n,r){this["__superclass_Prelude.Applicative_0"]=n,this["__superclass_Prelude.Bind_1"]=r},E=function(n,r,e,t){this["*"]=n,this["+"]=r,this.one=e,this.zero=t},C=function(n,r,e){this["/"]=n,this["__superclass_Prelude.Semiring_0"]=r,this.mod=e},F=function(n,r){this["-"]=n,this["__superclass_Prelude.Semiring_0"]=r},$=function(n,r){this["/="]=n,this["=="]=r},L=function(n,r){this["__superclass_Prelude.Eq_0"]=n,this.compare=r},N=function(n,r,e){this["&&"]=n,this.not=r,this["||"]=e},q=function(n){this["<>"]=n},k=function(n){return n["||"]},x=function(n){return n[">>="]},z=function(n){return n["=="]},B=function(n){return n["<>"]},V=function(n){return n["<<<"]},J=function(n){return function(r){return function(e){return V(n)(e)(r)}}},U=function(n){return n["<*>"]},I=function(n){return n["<$>"]},O=n,R=function(n){return n["/="]},j=function(n){return n["/"]},Q=function(n){return n["-"]},W=function(n){return B(n)},G=function(n){return n["+"]},H=function(n){return n["*"]},K=function(n){return n["&&"]},X=function(n){return function(r){return n(r)}},Y=function(n){return n.zero},Z=s(S.value)(w.value)(h.value),nr={},rr=new g(r),er=new g(e),tr=function(n){return n.show},ur=function(n){return new g(t(tr(n)))},ar=new E(o,u,1,0),or=new m(function(n){return function(r){return function(e){return n(r(e))}}}),ir=new q(p),lr=new F(a,function(){return ar}),cr=function(n){return n.pure},fr=function(n){return cr(n["__superclass_Prelude.Applicative_0"]())},sr=!0,vr=function(n){return n.not},_r=function(n){return function(r){return Q(n)(Y(n["__superclass_Prelude.Semiring_0"]()))(r)}},Pr=new C(i,function(){return ar},function(){return function(){return 0}}),pr=function(n){return function(r){return function(e){return U(n["__superclass_Prelude.Apply_0"]())(cr(n)(r))(e)}}},dr=function(n){return n.id},Sr=function(n){return function(r){return function(e){return n(e)(r)}}},hr=new $(function(){return function(){return!1}},function(){return function(){return!0}}),wr=new $(c,l),mr=new L(function(){return wr},Z),yr=new $(c,l),gr=new L(function(){return yr},Z),Ar=function(n){return function(){return n}},br=function(n){return n.compare},Tr=function(n){return function(r){return function(e){var t=br(n)(r)(e);return t instanceof S?!0:!1}}},Mr=function(n){return function(r){return function(e){var t=br(n)(r)(e);return t instanceof h?!1:!0}}},Dr=new y(function(){return or},function(n){return n}),Er=new N(v,P,_),Cr=function(n){return new $(function(r){return function(e){return vr(Er)(z(Cr(n))(r)(e))}},function(r){return function(e){return f(z(n))(r)(e)}})},Fr=function(n){return new L(function(){return Cr(n["__superclass_Prelude.Eq_0"]())},function(r){return function(e){if(0===r.length&&0===e.length)return w.value;if(0===r.length)return S.value;if(0===e.length)return h.value;if(r.length>=1){var t=r.slice(1);if(e.length>=1){var u=e.slice(1),a=br(n)(r[0])(e[0]);return a instanceof w?br(Fr(n))(t)(u):a}}throw new Error("Failed pattern match")}})},$r=function(n){return function(r){return function(e){return x(n["__superclass_Prelude.Bind_1"]())(r)(function(r){return x(n["__superclass_Prelude.Bind_1"]())(e)(function(e){return fr(n)(r(e))})})}}};return{Unit:d,LT:S,GT:h,EQ:w,Semigroup:q,BoolLike:N,Ord:L,Eq:$,Ring:F,ModuloSemiring:C,Semiring:E,Monad:D,Bind:M,Applicative:T,Apply:b,Functor:A,Show:g,Category:y,Semigroupoid:m,unit:nr,"++":W,"<>":B,not:vr,"||":k,"&&":K,"<=":Mr,"<":Tr,compare:br,"/=":R,"==":z,negate:_r,"-":Q,"/":j,"*":H,zero:Y,"+":G,ap:$r,return:fr,">>=":x,liftA1:pr,pure:cr,"<*>":U,"<$>":I,show:tr,cons:n,":":O,$:X,id:dr,">>>":J,"<<<":V,const:Ar,flip:Sr,otherwise:sr,semigroupoidArr:or,categoryArr:Dr,showString:rr,showNumber:er,showArray:ur,semiringNumber:ar,ringNumber:lr,moduloSemiringNumber:Pr,eqUnit:hr,eqString:wr,eqNumber:yr,eqArray:Cr,ordNumber:gr,ordString:mr,ordArray:Fr,boolLikeBoolean:Er,semigroupString:ir}}();var PS=PS||{};PS.Prelude_Unsafe=function(){"use strict";function n(n){return function(r){return n[r]}}PS.Prelude;return{unsafeIndex:n}}();var PS=PS||{};PS.$$Math=function(){"use strict";var n=(PS.Prelude,Math.abs),r=Math.log;return{log:r,abs:n}}();var PS=PS||{};PS.Data_Profunctor=function(){"use strict";var n=PS.Prelude,r=function(n){this.dimap=n},e=new r(function(r){return function(e){return function(t){return n[">>>"](n.semigroupoidArr)(r)(n[">>>"](n.semigroupoidArr)(t)(e))}}});return{Profunctor:r,profunctorArr:e}}();var PS=PS||{};PS.Data_Function=function(){"use strict";function n(n){return function(r){return function(e){return function(t){return function(u){return n(r,e,t,u)}}}}}PS.Prelude;return{runFn4:n}}();var PS=PS||{};PS.Data_Char=function(){"use strict";var n=(PS.Prelude,function(n){return n});return{charString:n}}();var PS=PS||{};PS.Control_Monad_Trans=function(){"use strict";var n=(PS.Prelude,function(n){this.lift=n}),r=function(n){return n.lift};return{MonadTrans:n,lift:r}}();var PS=PS||{};PS.Control_Monad_Error=function(){"use strict";var n=(PS.Prelude,function(n,r){this.noMsg=n,this.strMsg=r}),r=function(n){return n.strMsg};return{Error:n,strMsg:r}}();var PS=PS||{};PS.Control_Monad_Eff=function(){"use strict";function n(n){return function(){return n}}function r(n){return function(r){return function(){return r(n())()}}}var e=PS.Prelude,t=new e.Monad(function(){return o},function(){return u}),u=new e.Bind(r,function(){return a}),a=new e.Apply(e.ap(t),function(){return i}),o=new e.Applicative(function(){return a},n),i=new e.Functor(e.liftA1(o));return{functorEff:i,applyEff:a,applicativeEff:o,bindEff:u,monadEff:t}}();var PS=PS||{};PS.Control_Lazy=function(){"use strict";var n=(PS.Prelude,function(n){this.defer1=n}),r=function(n){return n.defer1};return{Lazy1:n,defer1:r}}();var PS=PS||{};PS.Control_Bind=function(){"use strict";var n=PS.Prelude,r=function(r){return function(e){return function(t){return n[">>="](r)(t)(e)}}};return{"=<<":r}}();var PS=PS||{};PS.Control_Apply=function(){"use strict";var n=PS.Prelude,r=function(r){return function(e){return function(t){return n["<*>"](r)(n["<$>"](r["__superclass_Prelude.Functor_0"]())(n.const(n.id(n.categoryArr)))(e))(t)}}};return{"*>":r}}();var PS=PS||{};PS.Control_Alt=function(){"use strict";var n=(PS.Prelude,function(n,r){this["<|>"]=n,this["__superclass_Prelude.Functor_0"]=r}),r=function(n){return n["<|>"]};return{Alt:n,"<|>":r}}();var PS=PS||{};PS.Control_Plus=function(){"use strict";var n=(PS.Prelude,PS.Control_Alt,function(n,r){this["__superclass_Control.Alt.Alt_0"]=n,this.empty=r});return{Plus:n}}();var PS=PS||{};PS.Control_Alternative=function(){"use strict";var n=PS.Prelude,r=PS.Control_Lazy,e=PS.Control_Alt,t=(PS.Control_Plus,function(n,r){this["__superclass_Control.Plus.Plus_1"]=n,this["__superclass_Prelude.Applicative_0"]=r}),u=function(e){return function(t){return function(u){return n["<*>"](e["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]())(n["<$>"](e["__superclass_Control.Plus.Plus_1"]()["__superclass_Control.Alt.Alt_0"]()["__superclass_Prelude.Functor_0"]())(n[":"])(u))(r.defer1(t)(function(){return a(e)(t)(u)}))}}},a=function(r){return function(t){return function(a){return e["<|>"](r["__superclass_Control.Plus.Plus_1"]()["__superclass_Control.Alt.Alt_0"]())(u(r)(t)(a))(n.pure(r["__superclass_Prelude.Applicative_0"]())([]))}}};return{Alternative:t,many:a,some:u}}();var PS=PS||{};PS.Data_Maybe=function(){"use strict";var n=PS.Prelude,r=(PS.Control_Alt,PS.Control_Alternative,PS.Control_Extend,PS.Control_MonadPlus,PS.Control_Plus,function(){function n(){}return n.value=new n,n}()),e=function(){function n(n){this.value0=n}return n.create=function(r){return new n(r)},n}(),t=function(n){return function(t){return function(u){if(u instanceof r)return n;if(u instanceof e)return t(u.value0);throw new Error("Failed pattern match")}}},u=t(!1)(n.const(!0)),a=new n.Functor(function(n){return function(t){return t instanceof e?new e(n(t.value0)):r.value}}),o=new n.Apply(function(t){return function(u){if(t instanceof e)return n["<$>"](a)(t.value0)(u);if(t instanceof r)return r.value;throw new Error("Failed pattern match")}},function(){return a}),i=new n.Bind(function(n){return function(t){if(n instanceof e)return t(n.value0);if(n instanceof r)return r.value;throw new Error("Failed pattern match")}},function(){return o}),l=new n.Applicative(function(){return o},e.create);return{Nothing:r,Just:e,isJust:u,maybe:t,functorMaybe:a,applyMaybe:o,applicativeMaybe:l,bindMaybe:i}}();var PS=PS||{};PS.Data_Array=function(){"use strict";function n(n){return function(r){var e=n.slice();return e.push(r),e}}function r(n){return n.length}function e(n){return function(r){return n.concat(r)}}function t(n){return function(r){return function(e){return e.slice(n,r)}}}function u(n){return function(r){for(var e=[],t=0,u=r.length;u>t;t++)Array.prototype.push.apply(e,n(r[t]));return e}}function a(n){return function(r){for(var e=r.length,t=new Array(e),u=0;e>u;u++)t[u]=n(r[u]);return t}}function o(n){return function(r){for(var e=0,t=[],u=0,a=r.length;a>u;u++)n(r[u])&&(t[e++]=r[u]);return t}}function i(n){return function(r){return function(e){for(var t=r.length<e.length?r.length:e.length,u=new Array(t),a=0;t>a;a++)u[a]=n(r[a])(e[a]);return u}}}var l=PS.Prelude,c=PS.Data_Maybe,f=(PS.Control_Alt,PS.Control_Plus,PS.Control_Alternative,PS.Control_MonadPlus,PS.Prelude_Unsafe,function(n){if(n.length>=1){var r=n.slice(1);return new c.Just(r)}return c.Nothing.value}),s=function(n){return[n]},v=new l.Semigroup(e),_=function(n){return 0===n.length?!0:!1},P=function(n){return 0===n.length?c.Nothing.value:new c.Just(t(0)(r(n)-1)(n))},p=new l.Functor(a),d=new l.Monad(function(){return w},function(){return S}),S=new l.Bind(l.flip(u),function(){return h}),h=new l.Apply(l.ap(d),function(){return p}),w=new l.Applicative(function(){return h},s);return{zipWith:i,filter:o,concatMap:u,append:e,length:r,map:a,null:_,init:P,tail:f,singleton:s,snoc:n,functorArray:p,applyArray:h,applicativeArray:w,bindArray:S,monadArray:d,semigroupArray:v}}();var PS=PS||{};PS.Data_Either=function(){"use strict";var n=PS.Prelude,r=(PS.Control_Alt,PS.Control_Extend,PS.Data_Maybe,function(){function n(n){this.value0=n}return n.create=function(r){return new n(r)},n}()),e=function(){function n(n){this.value0=n}return n.create=function(r){return new n(r)},n}(),t=new n.Functor(function(n){return function(t){if(t instanceof r)return new r(t.value0);if(t instanceof e)return new e(n(t.value0));throw new Error("Failed pattern match")}}),u=function(n){return function(t){return function(u){if(u instanceof r)return n(u.value0);if(u instanceof e)return t(u.value0);throw new Error("Failed pattern match")}}},a=new n.Apply(function(u){return function(a){if(u instanceof r)return new r(u.value0);if(u instanceof e)return n["<$>"](t)(u.value0)(a);throw new Error("Failed pattern match")}},function(){return t}),o=new n.Bind(u(function(n){return function(){return new r(n)}})(function(n){return function(r){return r(n)}}),function(){return a}),i=new n.Applicative(function(){return a},e.create),l=new n.Monad(function(){return i},function(){return o});return{Left:r,Right:e,either:u,functorEither:t,applyEither:a,applicativeEither:i,bindEither:o,monadEither:l}}();var PS=PS||{};PS.Data_Either_Unsafe=function(){"use strict";var n=(PS.Prelude,PS.Data_Either),r=function(r){if(r instanceof n.Right)return r.value0;throw new Error("Failed pattern match")};return{fromRight:r}}();var PS=PS||{};PS.Data_Foreign=function(){"use strict";function n(n){return n}function r(n){return Object.prototype.toString.call(n).slice(8,-1)}var e=PS.Prelude,t=(PS.Data_Function,PS.Data_Array,PS.Data_Either),u=function(){function n(n,r){this.value0=n,this.value1=r}return n.create=function(r){return function(e){return new n(r,e)}},n}(),a=function(a){return function(o){return r(o)===a?e.pure(t.applicativeEither)(n(o)):new t.Left(new u(a,r(o)))}},o=a("String");return{TypeMismatch:u,readString:o,tagOf:r,unsafeFromForeign:n}}();var PS=PS||{};PS.Control_Monad_JQuery=function(){"use strict";function n(n){return function(){jQuery(document).ready(n)}}function r(n){return function(){return jQuery(n)}}function e(n){return function(){return jQuery(n)}}function t(n){return function(r){return function(){return r.append(n)}}}function u(n){return function(){return n.empty()}}function a(n){return function(r){return function(){return r.append(n)}}}function o(n){return function(){return n.val()}}function i(n){return function(r){return function(e){return function(){return e.on(n,function(n){r(n)(jQuery(this))()})}}}}PS.Prelude,PS.Data_Foreign,PS.Control_Monad_Eff,PS.DOM;return{on:i,getValue:o,appendText:a,clear:u,append:t,create:e,select:r,ready:n}}();var PS=PS||{};PS.Data_Maybe_Unsafe=function(){"use strict";var n=(PS.Prelude,PS.Data_Maybe),r=function(r){if(r instanceof n.Just)return r.value0;throw new Error("Failed pattern match")};return{fromJust:r}}();var PS=PS||{};PS.Data_Array_Unsafe=function(){"use strict";var n=(PS.Prelude_Unsafe,PS.Prelude,PS.Data_Array,PS.Data_Maybe_Unsafe,function(n){if(n.length>=1){var r=n.slice(1);return r}throw new Error("Failed pattern match")}),r=function(n){return n[0]};return{tail:n,head:r}}();var PS=PS||{};PS.Data_Monoid=function(){"use strict";var n=PS.Prelude,r=PS.Data_Array,e=(PS.Data_Maybe,function(n,r){this["__superclass_Prelude.Semigroup_0"]=n,this.mempty=r}),t=new e(function(){return n.semigroupString},""),u=new e(function(){return r.semigroupArray},[]),a=function(n){return n.mempty};return{Monoid:e,mempty:a,monoidString:t,monoidArray:u}}();var PS=PS||{};PS.Data_Tuple=function(){"use strict";var n=PS.Prelude,r=(PS.Data_Monoid,PS.Control_Lazy,PS.Data_Array),e=(PS.Control_Comonad,PS.Control_Extend,function(){function n(n,r){this.value0=n,this.value1=r}return n.create=function(r){return function(e){return new n(r,e)}},n}()),t=r.zipWith(e.create),u=function(r){if(r.length>=1){var t=r.slice(1),a=u(t);return new e(n[":"](r[0].value0)(a.value0),n[":"](r[0].value1)(a.value1))}if(0===r.length)return new e([],[]);throw new Error("Failed pattern match")},a=function(n){return n.value1},o=function(r){return function(e){return new n.Show(function(t){return"Tuple ("+(n.show(r)(t.value0)+(") ("+(n.show(e)(t.value1)+")")))})}},i=new n.Functor(function(n){return function(r){return new e(r.value0,n(r.value1))}}),l=function(n){return n.value0},c=function(r){return function(e){return new n.Eq(function(t){return function(u){return!n["=="](c(r)(e))(t)(u)}},function(t){return function(u){return n["=="](r)(t.value0)(u.value0)&&n["=="](e)(t.value1)(u.value1)}})}},f=function(r){return function(e){return new n.Ord(function(){return c(r["__superclass_Prelude.Eq_0"]())(e["__superclass_Prelude.Eq_0"]())},function(t){return function(u){var a=n.compare(r)(t.value0)(u.value0);return a instanceof n.EQ?n.compare(e)(t.value1)(u.value1):a}})}};return{Tuple:e,unzip:u,zip:t,snd:a,fst:l,showTuple:o,eqTuple:c,ordTuple:f,functorTuple:i}}();var PS=PS||{};PS.Control_Monad_Error_Class=function(){"use strict";var n=(PS.Prelude,PS.Control_Monad_Error_Trans,PS.Control_Monad_Trans,PS.Control_Monad_Maybe_Trans,PS.Control_Monad_Reader_Trans,PS.Control_Monad_Writer_Trans,PS.Control_Monad_State_Trans,PS.Control_Monad_Error,PS.Data_Either),r=(PS.Data_Monoid,function(n,r){this.catchError=n,this.throwError=r}),e=function(n){return n.throwError},t=new r(function(r){return function(e){if(r instanceof n.Left)return e(r.value0);if(r instanceof n.Right)return new n.Right(r.value0);throw new Error("Failed pattern match")}},n.Left.create);return{MonadError:r,throwError:e,monadErrorError:t}}();var PS=PS||{};PS.Data_Profunctor_Strong=function(){"use strict";var n=PS.Prelude,r=PS.Data_Profunctor,e=PS.Data_Tuple,t=function(n,r,e){this["__superclass_Data.Profunctor.Profunctor_0"]=n,this.first=r,this.second=e},u=new t(function(){return r.profunctorArr},function(n){return function(r){return new e.Tuple(n(r.value0),r.value1)}},n["<$>"](e.functorTuple)),a=function(n){return n.second},o=function(n){return n.first};return{Strong:t,second:a,first:o,strongArr:u}}();var PS=PS||{};PS.Control_Arrow=function(){"use strict";var n=PS.Prelude,r=PS.Data_Profunctor_Strong,e=PS.Data_Tuple,t=function(n,r,e){this["__superclass_Data.Profunctor.Strong.Strong_1"]=n,this["__superclass_Prelude.Category_0"]=r,this.arr=e},u=function(e){return function(t){return function(u){return n[">>>"](e["__superclass_Prelude.Category_0"]()["__superclass_Prelude.Semigroupoid_0"]())(r.first(e["__superclass_Data.Profunctor.Strong.Strong_1"]())(t))(r.second(e["__superclass_Data.Profunctor.Strong.Strong_1"]())(u))}}},a=new t(function(){return r.strongArr},function(){return n.categoryArr},function(n){return n}),o=function(n){return n.arr},i=function(r){return function(t){return function(a){return n[">>>"](r["__superclass_Prelude.Category_0"]()["__superclass_Prelude.Semigroupoid_0"]())(o(r)(function(n){return new e.Tuple(n,n)}))(u(r)(t)(a))}}};return{Arrow:t,"&&&":i,"***":u,arr:o,arrowFunction:a}}();var PS=PS||{};PS.Data_Foldable=function(){"use strict";function n(n){return function(r){return function(e){for(var t=r,u=e.length-1;u>=0;--u)t=n(e[u])(t);return t}}}function r(n){return function(r){return function(e){for(var t=r,u=0,a=e.length;a>u;++u)t=n(t)(e[u]);return t}}}var e=PS.Prelude,t=PS.Data_Monoid,u=PS.Control_Apply,a=(PS.Data_Monoid_First,PS.Data_Either,PS.Data_Maybe,PS.Data_Monoid_Additive,PS.Data_Monoid_Dual,PS.Data_Monoid_Last,PS.Data_Monoid_Multiplicative,PS.Data_Tuple,function(n,r,e){this.foldMap=n,this.foldl=r,this.foldr=e}),o=function(n){return n.foldr},i=function(n){return function(r){return function(t){return o(r)(e["<<<"](e.semigroupoidArr)(u["*>"](n["__superclass_Prelude.Apply_0"]()))(t))(e.pure(n)(e.unit))}}},l=function(n){return function(r){return e.flip(i(n)(r))}},c=function(n){return n.foldl},f=function(n){return function(r){return c(n)(e["<>"](r["__superclass_Prelude.Semigroup_0"]()))(t.mempty(r))}},s=function(n){return c(n)(e["||"](e.boolLikeBoolean))(!1)},v=function(n){return c(n)(e["*"](e.semiringNumber))(1)},_=function(n){return c(n)(e["+"](e.semiringNumber))(0)},P=new a(function(n){return function(r){return function(u){return o(P)(function(t){return function(u){return e["<>"](n["__superclass_Prelude.Semigroup_0"]())(r(t))(u)}})(t.mempty(n))(u)}}},function(n){return function(e){return function(t){return r(n)(e)(t)}}},function(r){return function(e){return function(t){return n(r)(e)(t)}}}),p=function(n){return n.foldMap},d=function(n){return function(r){return e["<<<"](e.semigroupoidArr)(s(P))(p(n)(t.monoidArray)(function(n){return[r(n)]}))}},S=function(n){return function(r){return e["<<<"](e.semigroupoidArr)(d(r))(e["=="](n))}},h=function(n){return function(r){return function(t){return e["<<<"](e.semigroupoidArr)(e.not(e.boolLikeBoolean))(S(n)(r)(t))}}},w=function(n){return c(n)(e["&&"](e.boolLikeBoolean))(!0)},m=function(n){return function(r){return e["<<<"](e.semigroupoidArr)(w(P))(p(n)(t.monoidArray)(function(n){return[r(n)]}))}};return{Foldable:a,foldlArray:r,foldrArray:n,notElem:h,elem:S,product:v,sum:_,all:m,any:d,or:s,and:w,mconcat:f,for_:l,traverse_:i,foldMap:p,foldl:c,foldr:o,foldableArray:P}}();var PS=PS||{};PS.Data_String=function(){"use strict";function n(n,r,e,t){return n>=0&&n<r.length?e(r.charAt(n)):t}function r(n){return function(r){return r.indexOf(n)}}function e(n){return n.length}function t(n){return function(r){return r.substr(0,n)}}function u(n){return function(r){return r.substr(n)}}var a=(PS.Data_Function,PS.Data_Char,PS.Prelude,PS.Data_String_Unsafe,PS.Data_Maybe),o=function(r){return function(e){return n(r,e,a.Just.create,a.Nothing.value)}};return{drop:u,take:t,length:e,indexOf:r,charAt:o}}();var PS=PS||{};PS.Data_Traversable=function(){"use strict";var n=PS.Prelude,r=PS.Data_Array,e=(PS.Data_Tuple,PS.Data_Either,PS.Data_Foldable),t=(PS.Data_Maybe,PS.Data_Monoid_Additive,PS.Data_Monoid_Dual,PS.Data_Monoid_First,PS.Data_Monoid_Last,PS.Data_Monoid_Multiplicative,function(n,r,e,t){this["__superclass_Data.Foldable.Foldable_1"]=n,this["__superclass_Prelude.Functor_0"]=r,this.sequence=e,this.traverse=t}),u=function(n){return n.traverse},a=function(n){return n.sequence},o=new t(function(){return e.foldableArray},function(){return r.functorArray},function(r){return function(e){if(0===e.length)return n.pure(r)([]);if(e.length>=1){var t=e.slice(1);return n["<*>"](r["__superclass_Prelude.Apply_0"]())(n["<$>"](r["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(n[":"])(e[0]))(a(o)(r)(t))}throw new Error("Failed pattern match")}},function(r){return function(e){return function(t){if(0===t.length)return n.pure(r)([]);if(t.length>=1){var a=t.slice(1);return n["<*>"](r["__superclass_Prelude.Apply_0"]())(n["<$>"](r["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(n[":"])(e(t[0])))(u(o)(r)(e)(a))}throw new Error("Failed pattern match")}}});return{Traversable:t,sequence:a,traverse:u,traversableArray:o}}();var PS=PS||{};PS.Data_Map=function(){"use strict";var n=PS.Prelude,r=PS.Data_Foldable,e=PS.Data_Tuple,t=(PS.Data_Traversable,PS.Data_Array),u=PS.Data_Maybe,a=(PS.Data_Monoid,function(){function n(){}return n.value=new n,n}()),o=function(){function n(n,r,e,t){this.value0=n,this.value1=r,this.value2=e,this.value3=t}return n.create=function(r){return function(e){return function(t){return function(u){return new n(r,e,t,u)}}}},n}(),i=function(){function n(n,r,e,t,u,a,o){this.value0=n,this.value1=r,this.value2=e,this.value3=t,this.value4=u,this.value5=a,this.value6=o}return n.create=function(r){return function(e){return function(t){return function(u){return function(a){return function(o){return function(i){return new n(r,e,t,u,a,o,i)}}}}}}},n}(),l=function(){function n(n,r,e){this.value0=n,this.value1=r,this.value2=e}return n.create=function(r){return function(e){return function(t){return new n(r,e,t)}}},n}(),c=function(){function n(n,r,e){this.value0=n,this.value1=r,this.value2=e}return n.create=function(r){return function(e){return function(t){return new n(r,e,t)}}},n}(),f=function(){function n(n,r,e,t,u,a){this.value0=n,this.value1=r,this.value2=e,this.value3=t,this.value4=u,this.value5=a}return n.create=function(r){return function(e){return function(t){return function(u){return function(a){return function(o){return new n(r,e,t,u,a,o)}}}}}},n}(),s=function(){function n(n,r,e,t,u,a){this.value0=n,this.value1=r,this.value2=e,this.value3=t,this.value4=u,this.value5=a}return n.create=function(r){return function(e){return function(t){return function(u){return function(a){return function(o){return new n(r,e,t,u,a,o)}}}}}},n}(),v=function(){function n(n,r,e,t,u,a){this.value0=n,this.value1=r,this.value2=e,this.value3=t,this.value4=u,this.value5=a}return n.create=function(r){return function(e){return function(t){return function(u){return function(a){return function(o){return new n(r,e,t,u,a,o)}}}}}},n}(),_=function(){function n(n,r,e,t){this.value0=n,this.value1=r,this.value2=e,this.value3=t}return n.create=function(r){return function(e){return function(t){return function(u){return new n(r,e,t,u)}}}},n}(),P=function(r){if(r instanceof a)return[];if(r instanceof o)return n["++"](t.semigroupArray)(P(r.value0))(n["++"](t.semigroupArray)([r.value2])(P(r.value3)));if(r instanceof i)return n["++"](t.semigroupArray)(P(r.value0))(n["++"](t.semigroupArray)([r.value2])(n["++"](t.semigroupArray)(P(r.value3))(n["++"](t.semigroupArray)([r.value5])(P(r.value6)))));throw new Error("Failed pattern match")},p=function(r){if(r instanceof a)return[];if(r instanceof o)return n["++"](t.semigroupArray)(p(r.value0))(n["++"](t.semigroupArray)([new e.Tuple(r.value1,r.value2)])(p(r.value3)));if(r instanceof i)return n["++"](t.semigroupArray)(p(r.value0))(n["++"](t.semigroupArray)([new e.Tuple(r.value1,r.value2)])(n["++"](t.semigroupArray)(p(r.value3))(n["++"](t.semigroupArray)([new e.Tuple(r.value4,r.value5)])(p(r.value6)))));throw new Error("Failed pattern match")},d=function(r){return function(t){return new n.Show(function(u){return"fromList "+n.show(n.showArray(e.showTuple(r)(t)))(p(u))})}},S=function(r){return function(e){return function(t){for(var l=r,c=e,f=t;;){if(f instanceof a)return u.Nothing.value;if(f instanceof o&&n["=="](l["__superclass_Prelude.Eq_0"]())(c)(f.value1))return new u.Just(f.value2);if(f instanceof o&&n["<"](l)(c)(f.value1)){var s=l,v=c,_=f.value0;l=s,c=v,f=_}else if(f instanceof o){var s=l,v=c,_=f.value3;l=s,c=v,f=_}else{if(f instanceof i&&n["=="](l["__superclass_Prelude.Eq_0"]())(c)(f.value1))return new u.Just(f.value2);if(f instanceof i&&n["=="](l["__superclass_Prelude.Eq_0"]())(c)(f.value4))return new u.Just(f.value5);if(f instanceof i&&n["<"](l)(c)(f.value1)){var s=l,v=c,_=f.value0;l=s,c=v,f=_}else if(f instanceof i&&n["<"](l)(f.value1)(c)&&n["<="](l)(c)(f.value4)){var s=l,v=c,_=f.value3;l=s,c=v,f=_}else{if(!(f instanceof i))throw new Error("Failed pattern match");var s=l,v=c,_=f.value6;l=s,c=v,f=_}}}}}},h=function(n){return function(r){return function(e){return u.isJust(S(n)(r)(e))}}},w=new n.Functor(function(r){return function(e){if(e instanceof a)return a.value;if(e instanceof o)return new o(n["<$>"](w)(r)(e.value0),e.value1,r(e.value2),n["<$>"](w)(r)(e.value3));if(e instanceof i)return new i(n["<$>"](w)(r)(e.value0),e.value1,r(e.value2),n["<$>"](w)(r)(e.value3),e.value4,r(e.value5),n["<$>"](w)(r)(e.value6));throw new Error("Failed pattern match")}}),m=function(n){return function(r){return function(e){var t=n,u=r,a=e;n:for(;;){if(0===u.length)return a;if(u.length>=1){var _=u.slice(1);if(u[0]instanceof l){var P=t,p=new o(a,u[0].value0,u[0].value1,u[0].value2);t=P,u=_,a=p;continue n}}if(u.length>=1){var d=u.slice(1);if(u[0]instanceof c){var P=t,p=new o(u[0].value0,u[0].value1,u[0].value2,a);t=P,u=d,a=p;continue n}}if(u.length>=1){var S=u.slice(1);if(u[0]instanceof f){var P=t,p=new i(a,u[0].value0,u[0].value1,u[0].value2,u[0].value3,u[0].value4,u[0].value5);t=P,u=S,a=p;continue n}}if(u.length>=1){var h=u.slice(1);if(u[0]instanceof s){var P=t,p=new i(u[0].value0,u[0].value1,u[0].value2,a,u[0].value3,u[0].value4,u[0].value5);t=P,u=h,a=p;continue n}}if(u.length>=1){var w=u.slice(1);if(u[0]instanceof v){var P=t,p=new i(u[0].value0,u[0].value1,u[0].value2,u[0].value3,u[0].value4,u[0].value5,a);t=P,u=w,a=p;continue n}}throw new Error("Failed pattern match")}}}},y=function(r){var e=function(n){return function(r){return function(e){var t=n,u=r,a=e;n:for(;;){if(0===u.length)return new o(a.value0,a.value1,a.value2,a.value3);if(u.length>=1){var P=u.slice(1);if(u[0]instanceof l)return m(t)(P)(new i(a.value0,a.value1,a.value2,a.value3,u[0].value0,u[0].value1,u[0].value2))}if(u.length>=1){var p=u.slice(1);if(u[0]instanceof c)return m(t)(p)(new i(u[0].value0,u[0].value1,u[0].value2,a.value0,a.value1,a.value2,a.value3))}if(u.length>=1){var d=u.slice(1);if(u[0]instanceof f){var S=t,h=new _(new o(a.value0,a.value1,a.value2,a.value3),u[0].value0,u[0].value1,new o(u[0].value2,u[0].value3,u[0].value4,u[0].value5));t=S,u=d,a=h;continue n}}if(u.length>=1){var w=u.slice(1);if(u[0]instanceof s){var S=t,h=new _(new o(u[0].value0,u[0].value1,u[0].value2,a.value0),a.value1,a.value2,new o(a.value3,u[0].value3,u[0].value4,u[0].value5));t=S,u=w,a=h;continue n}}if(u.length>=1){var y=u.slice(1);if(u[0]instanceof v){var S=t,h=new _(new o(u[0].value0,u[0].value1,u[0].value2,u[0].value3),u[0].value4,u[0].value5,new o(a.value0,a.value1,a.value2,a.value3));t=S,u=y,a=h;continue n}}throw new Error("Failed pattern match")}}}},t=function(r){return function(t){return function(u){return function(P){return function(p){for(var d=r,S=t,h=u,w=P,y=p;;){if(y instanceof a)return e(d)(S)(new _(a.value,h,w,a.value));if(y instanceof o&&n["=="](d["__superclass_Prelude.Eq_0"]())(h)(y.value1))return m(d)(S)(new o(y.value0,h,w,y.value3));if(y instanceof o&&n["<"](d)(h)(y.value1)){var g=d,A=n[":"](new l(y.value1,y.value2,y.value3))(S),b=h,T=w,M=y.value0;d=g,S=A,h=b,w=T,y=M}else if(y instanceof o){var g=d,A=n[":"](new c(y.value0,y.value1,y.value2))(S),b=h,T=w,M=y.value3;d=g,S=A,h=b,w=T,y=M}else{if(y instanceof i&&n["=="](d["__superclass_Prelude.Eq_0"]())(h)(y.value1))return m(d)(S)(new i(y.value0,h,w,y.value3,y.value4,y.value5,y.value6));if(y instanceof i&&n["=="](d["__superclass_Prelude.Eq_0"]())(h)(y.value4))return m(d)(S)(new i(y.value0,y.value1,y.value2,y.value3,h,w,y.value6));if(y instanceof i&&n["<"](d)(h)(y.value1)){var g=d,A=n[":"](new f(y.value1,y.value2,y.value3,y.value4,y.value5,y.value6))(S),b=h,T=w,M=y.value0;d=g,S=A,h=b,w=T,y=M}else if(y instanceof i&&n["<"](d)(y.value1)(h)&&n["<="](d)(h)(y.value4)){var g=d,A=n[":"](new s(y.value0,y.value1,y.value2,y.value4,y.value5,y.value6))(S),b=h,T=w,M=y.value3;d=g,S=A,h=b,w=T,y=M}else{if(!(y instanceof i))throw new Error("Failed pattern match");var g=d,A=n[":"](new v(y.value0,y.value1,y.value2,y.value3,y.value4,y.value5))(S),b=h,T=w,M=y.value6;d=g,S=A,h=b,w=T,y=M}}}}}}}};return t(r)([])},g=function(r){return function(t){return new n.Eq(function(e){return function(u){return!n["=="](g(r)(t))(e)(u)}},function(u){return function(a){return n["=="](n.eqArray(e.eqTuple(r)(t)))(p(u))(p(a))}})}},A=a.value,b=function(n){return r.foldl(r.foldableArray)(function(r){return function(e){return y(n)(e.value0)(e.value1)(r)}})(A)},T=function(r){var e=function(n){return function(r){return function(e){var t=n,u=r,_=e;n:for(;;){if(0===u.length)return _;if(u.length>=1){var P=u.slice(1);if(u[0]instanceof l&&u[0].value2 instanceof a&&_ instanceof a)return m(t)(P)(new o(a.value,u[0].value0,u[0].value1,a.value))}if(u.length>=1){var p=u.slice(1);if(u[0]instanceof c&&u[0].value0 instanceof a&&_ instanceof a)return m(t)(p)(new o(a.value,u[0].value1,u[0].value2,a.value))}if(u.length>=1){var d=u.slice(1);if(u[0]instanceof l&&u[0].value2 instanceof o){var S=t,h=new i(_,u[0].value0,u[0].value1,u[0].value2.value0,u[0].value2.value1,u[0].value2.value2,u[0].value2.value3);t=S,u=d,_=h;continue n}}if(u.length>=1){var w=u.slice(1);if(u[0]instanceof c&&u[0].value0 instanceof o){var S=t,h=new i(u[0].value0.value0,u[0].value0.value1,u[0].value0.value2,u[0].value0.value3,u[0].value1,u[0].value2,_);t=S,u=w,_=h;continue n}}if(u.length>=1){var y=u.slice(1);if(u[0]instanceof l&&u[0].value2 instanceof i)return m(t)(y)(new o(new o(_,u[0].value0,u[0].value1,u[0].value2.value0),u[0].value2.value1,u[0].value2.value2,new o(u[0].value2.value3,u[0].value2.value4,u[0].value2.value5,u[0].value2.value6)))}if(u.length>=1){var g=u.slice(1);if(u[0]instanceof c&&u[0].value0 instanceof i)return m(t)(g)(new o(new o(u[0].value0.value0,u[0].value0.value1,u[0].value0.value2,u[0].value0.value3),u[0].value0.value4,u[0].value0.value5,new o(u[0].value0.value6,u[0].value1,u[0].value2,_)))
}if(u.length>=1){var A=u.slice(1);if(u[0]instanceof f&&u[0].value2 instanceof a&&u[0].value5 instanceof a&&_ instanceof a)return m(t)(A)(new i(a.value,u[0].value0,u[0].value1,a.value,u[0].value3,u[0].value4,a.value))}if(u.length>=1){var b=u.slice(1);if(u[0]instanceof s&&u[0].value0 instanceof a&&u[0].value5 instanceof a&&_ instanceof a)return m(t)(b)(new i(a.value,u[0].value1,u[0].value2,a.value,u[0].value3,u[0].value4,a.value))}if(u.length>=1){var T=u.slice(1);if(u[0]instanceof v&&u[0].value0 instanceof a&&u[0].value3 instanceof a&&_ instanceof a)return m(t)(T)(new i(a.value,u[0].value1,u[0].value2,a.value,u[0].value4,u[0].value5,a.value))}if(u.length>=1){var M=u.slice(1);if(u[0]instanceof f&&u[0].value2 instanceof o)return m(t)(M)(new o(new i(_,u[0].value0,u[0].value1,u[0].value2.value0,u[0].value2.value1,u[0].value2.value2,u[0].value2.value3),u[0].value3,u[0].value4,u[0].value5))}if(u.length>=1){var D=u.slice(1);if(u[0]instanceof s&&u[0].value0 instanceof o)return m(t)(D)(new o(new i(u[0].value0.value0,u[0].value0.value1,u[0].value0.value2,u[0].value0.value3,u[0].value1,u[0].value2,_),u[0].value3,u[0].value4,u[0].value5))}if(u.length>=1){var E=u.slice(1);if(u[0]instanceof s&&u[0].value5 instanceof o)return m(t)(E)(new o(u[0].value0,u[0].value1,u[0].value2,new i(_,u[0].value3,u[0].value4,u[0].value5.value0,u[0].value5.value1,u[0].value5.value2,u[0].value5.value3)))}if(u.length>=1){var C=u.slice(1);if(u[0]instanceof v&&u[0].value3 instanceof o)return m(t)(C)(new o(u[0].value0,u[0].value1,u[0].value2,new i(u[0].value3.value0,u[0].value3.value1,u[0].value3.value2,u[0].value3.value3,u[0].value4,u[0].value5,_)))}if(u.length>=1){var F=u.slice(1);if(u[0]instanceof f&&u[0].value2 instanceof i)return m(t)(F)(new i(new o(_,u[0].value0,u[0].value1,u[0].value2.value0),u[0].value2.value1,u[0].value2.value2,new o(u[0].value2.value3,u[0].value2.value4,u[0].value2.value5,u[0].value2.value6),u[0].value3,u[0].value4,u[0].value5))}if(u.length>=1){var $=u.slice(1);if(u[0]instanceof s&&u[0].value0 instanceof i)return m(t)($)(new i(new o(u[0].value0.value0,u[0].value0.value1,u[0].value0.value2,u[0].value0.value3),u[0].value0.value4,u[0].value0.value5,new o(u[0].value0.value6,u[0].value1,u[0].value2,_),u[0].value3,u[0].value4,u[0].value5))}if(u.length>=1){var L=u.slice(1);if(u[0]instanceof s&&u[0].value5 instanceof i)return m(t)(L)(new i(u[0].value0,u[0].value1,u[0].value2,new o(_,u[0].value3,u[0].value4,u[0].value5.value0),u[0].value5.value1,u[0].value5.value2,new o(u[0].value5.value3,u[0].value5.value4,u[0].value5.value5,u[0].value5.value6)))}if(u.length>=1){var N=u.slice(1);if(u[0]instanceof v&&u[0].value3 instanceof i)return m(t)(N)(new i(u[0].value0,u[0].value1,u[0].value2,new o(u[0].value3.value0,u[0].value3.value1,u[0].value3.value2,u[0].value3.value3),u[0].value3.value4,u[0].value3.value5,new o(u[0].value3.value6,u[0].value4,u[0].value5,_)))}throw new Error("Failed pattern match")}}}},t=function(r){return function(t){return function(u){for(var l=r,f=t,s=u;;){if(s instanceof o&&s.value0 instanceof a&&s.value3 instanceof a)return e(l)(f)(a.value);if(s instanceof o){var _=l,P=n[":"](new c(s.value0,s.value1,s.value2))(f),p=s.value3;l=_,f=P,s=p}else{if(s instanceof i&&s.value0 instanceof a&&s.value3 instanceof a&&s.value6 instanceof a)return e(l)(n[":"](new c(a.value,s.value1,s.value2))(f))(a.value);if(!(s instanceof i))throw new Error("Failed pattern match");var _=l,P=n[":"](new v(s.value0,s.value1,s.value2,s.value3,s.value4,s.value5))(f),p=s.value6;l=_,f=P,s=p}}}}},u=function(n){return function(r){for(var e=n,t=r;;){if(t instanceof o&&t.value3 instanceof a)return{key:t.value1,value:t.value2};if(t instanceof o){var u=e,l=t.value3;e=u,t=l}else{if(t instanceof i&&t.value6 instanceof a)return{key:t.value4,value:t.value5};if(!(t instanceof i))throw new Error("Failed pattern match");var u=e,l=t.value6;e=u,t=l}}}},_=function(r){return function(_){return function(P){return function(p){var d=r,S=_,h=P,w=p;n:for(;;){if(w instanceof a)return m(d)(S)(a.value);if(w instanceof o&&w.value0 instanceof a&&w.value3 instanceof a&&n["=="](d["__superclass_Prelude.Eq_0"]())(h)(w.value1))return e(d)(S)(a.value);if(w instanceof o){if(n["=="](d["__superclass_Prelude.Eq_0"]())(h)(w.value1)){var y=u(d)(w.value0);return t(d)(n[":"](new l(y.key,y.value,w.value3))(S))(w.value0)}if(n["<"](d)(h)(w.value1)){var g=d,A=n[":"](new l(w.value1,w.value2,w.value3))(S),b=h,T=w.value0;d=g,S=A,h=b,w=T;continue n}if(n.otherwise){var g=d,A=n[":"](new c(w.value0,w.value1,w.value2))(S),b=h,T=w.value3;d=g,S=A,h=b,w=T;continue n}}if(w instanceof i&&w.value0 instanceof a&&w.value3 instanceof a&&w.value6 instanceof a){if(n["=="](d["__superclass_Prelude.Eq_0"]())(h)(w.value1))return m(d)(S)(new o(a.value,w.value4,w.value5,a.value));if(n["=="](d["__superclass_Prelude.Eq_0"]())(h)(w.value4))return m(d)(S)(new o(a.value,w.value1,w.value2,a.value))}if(w instanceof i){if(n["=="](d["__superclass_Prelude.Eq_0"]())(h)(w.value1)){var y=u(d)(w.value0);return t(d)(n[":"](new f(y.key,y.value,w.value3,w.value4,w.value5,w.value6))(S))(w.value0)}if(n["=="](d["__superclass_Prelude.Eq_0"]())(h)(w.value4)){var y=u(d)(w.value3);return t(d)(n[":"](new s(w.value0,w.value1,w.value2,y.key,y.value,w.value6))(S))(w.value3)}if(n["<"](d)(h)(w.value1)){var g=d,A=n[":"](new f(w.value1,w.value2,w.value3,w.value4,w.value5,w.value6))(S),b=h,T=w.value0;d=g,S=A,h=b,w=T;continue n}if(n["<"](d)(w.value1)(h)&&n["<"](d)(h)(w.value4)){var g=d,A=n[":"](new s(w.value0,w.value1,w.value2,w.value4,w.value5,w.value6))(S),b=h,T=w.value3;d=g,S=A,h=b,w=T;continue n}if(n.otherwise){var g=d,A=n[":"](new v(w.value0,w.value1,w.value2,w.value3,w.value4,w.value5))(S),b=h,T=w.value6;d=g,S=A,h=b,w=T;continue n}}throw new Error("Failed pattern match")}}}}};return _(r)([])};return{values:P,member:h,delete:T,fromList:b,toList:p,lookup:S,insert:y,empty:A,eqMap:g,showMap:d,functorMap:w}}();var PS=PS||{};PS.Data_Set=function(){"use strict";var n=PS.Prelude,r=PS.Data_Map,e=PS.Data_Array,t=PS.Data_Tuple,u=PS.Data_Foldable,a=(PS.Data_Array_ST,PS.Control_Monad_Rec_Class,PS.Control_Monad_Eff,PS.Control_Monad_ST,PS.Data_Either,PS.Data_Maybe,PS.Prelude_Unsafe,function(){function n(n){this.value0=n}return n.create=function(r){return new n(r)},n}()),o=function(n){return e.map(t.fst)(r.toList(n.value0))},i=function(n){return function(e){return function(t){return r.member(n)(e)(t.value0)}}},l=function(e){return function(t){return function(u){return new a(r.insert(e)(t)(n.unit)(u.value0))}}},c=function(e){return new n.Eq(function(t){return function(u){return n["/="](r.eqMap(e)(n.eqUnit))(t.value0)(u.value0)}},function(t){return function(u){return n["=="](r.eqMap(e)(n.eqUnit))(t.value0)(u.value0)}})},f=new a(r.empty),s=function(n){return u.foldl(u.foldableArray)(function(r){return function(e){return l(n)(e)(r)}})(f)},v=function(n){return function(e){return function(t){return new a(r.delete(n)(e)(t.value0))}}};return{fromList:s,toList:o,delete:v,member:i,insert:l,empty:f,eqSet:c}}();var PS=PS||{};PS.Math_Probability_Internal=function(){"use strict";var n=PS.Prelude,r=PS.$$Math,e=PS.Data_Foldable,t=PS.Data_Tuple,u=PS.Data_Array,a=(PS.Data_Map,PS.Data_Profunctor_Strong),o=(PS.Control_Arrow,PS.Data_Function,function(n){return n}),i=function(n){return n},l=function(n){return n},c=n["<<<"](n.semigroupoidArr)(e.sum(e.foldableArray))(n["<$>"](u.functorArray)(t.snd)),f=new n.Show(function(r){return n.show(n.showNumber)(r)}),s=new n.Show(function(r){return"ProbList ("+(n.show(n.showArray(f))(r)+")")}),v=function(r){return new n.Show(function(e){return"Dist "+n.show(n.showArray(t.showTuple(r)(n.showNumber)))(e)})},_=new n.Functor(function(r){return function(e){return l(n["<$>"](u.functorArray)(a.first(a.strongArr)(r))(e))}}),P=5e-6,p=function(n){return function(r){return P>n-r}},d=function(n){return function(e){return r.abs(n-e)<P}},S=n["<<<"](n.semigroupoidArr)(d(1))(c),h=new n.Apply(function(r){return function(e){return l(n[">>="](u.bindArray)(r)(function(r){return n[">>="](u.bindArray)(function(n){return n}(e))(function(e){return n.pure(u.applicativeArray)(new t.Tuple(r.value0(e.value0),r.value1*e.value1))})}))}},function(){return _}),w=new n.Bind(function(r){return function(e){return l(n[">>="](u.bindArray)(r)(function(r){return n[">>="](u.bindArray)(function(n){return n}(e(r.value0)))(function(e){return n.pure(u.applicativeArray)(new t.Tuple(e.value0,r.value1*e.value1))})}))}},function(){return h}),m=new n.Applicative(function(){return h},function(r){return n["<<<"](n.semigroupoidArr)(l)(u.singleton)(new t.Tuple(r,1))});return{Dist:l,ProbList:i,Prob:o,isValid:S,sumP:c,"<~":p,"~~":d,epsilon:P,functorDist:_,applyDist:h,applicativeDist:m,bindDist:w,showProb:f,showDist:v,showProbList:s}}();var PS=PS||{};PS.Math_Probability=function(){"use strict";var n=PS.Math_Probability_Internal,r=PS.Prelude,e=PS.Data_Foldable,t=PS.Data_Profunctor_Strong,u=PS.Data_Array,a=PS.Data_Tuple,o=(PS.$$Math,PS.Data_Monoid_All,PS.Data_Maybe),i=(PS.Data_Maybe_Unsafe,function(){function n(n,r){this.value0=n,this.value1=r}return n.create=function(r){return function(e){return new n(r,e)}},n}()),l=function(r){return function(e){return n.Dist(u.zipWith(function(n){return function(r){return new a.Tuple(n,r)}})(r)(e))}},c=function(n){return n.value0},f=function(n){return n},s=function(n){return n},v=function(n){return n},_=function(e){return r["<<<"](r.semigroupoidArr)(n.Prob)(r["<<<"](r.semigroupoidArr)(n.sumP)(r["<<<"](r.semigroupoidArr)(u.filter(r["<<<"](r.semigroupoidArr)(e)(a.fst)))(v)))},P=function(e){if(n["<~"](0)(e)&&n["<~"](e)(1))return o.Just.create(e);if(r.otherwise)return o.Nothing.value;throw new Error("Failed pattern match")},p=function(n){return r["=="](n)},d=function(n){return n.value1},S=r["<<<"](r.semigroupoidArr)(r["<$>"](u.functorArray)(a.fst))(v),h=function(n){return r["<<<"](r.semigroupoidArr)(n)(S)},w=function(n){return r["<<<"](r.semigroupoidArr)(d(n))(r["<<<"](r.semigroupoidArr)(e.sum(e.foldableArray))(r["<<<"](r.semigroupoidArr)(r["<$>"](u.functorArray)(function(r){return c(n)(r.value0)*r.value1}))(v)))},m=function(e){return n.ProbList(r["<$>"](u.functorArray)(r["<<<"](r.semigroupoidArr)(n.Prob)(a.snd))(e))},y=function(e){var a=r["<$>"](u.functorArray)(t.second(t.strongArr)(s))(e),i=n.isValid(a);if(i)return o.Just.create(a);if(!i)return o.Nothing.value;throw new Error("Failed pattern match")},g=function(e){var a=n.sumP(e);return y(r["<$>"](u.functorArray)(t.second(t.strongArr)(r["<<<"](r.semigroupoidArr)(n.Prob)(function(n){return n/a})))(e))},A=r["<<<"](r.semigroupoidArr)(g)(r["<$>"](u.functorArray)(function(n){return new a.Tuple(n,1)}));return{Iso:i,expected:w,from:d,to:c,"??":_,just:p,reshape:h,uniform:A,extract:S,distProbs:m,runDist:v,fromFreqs:g,zipDist:l,dist:y,runProbList:f,runProb:s,prob:P}}();var PS=PS||{};PS.Math_Probability_Information=function(){"use strict";var n=PS.Prelude,r=PS.Math_Probability,e=PS.$$Math,t=PS.Math_Probability_Internal,u=function(n){return n},a=function(r){return function(e){return r(n.pure(t.applicativeDist)(n.unit))(n.const(e))}},o=function(n){return function(r){return e.log(r)/e.log(n)}},i=o(2),l=new r.Iso(function(n){return n},u),c=n["<<<"](n.semigroupoidArr)(r.from(l))(n["<<<"](n.semigroupoidArr)(n.negate(n.ringNumber))(n["<<<"](n.semigroupoidArr)(i)(r.runProb))),f=function(e){return function(u){return function(a){return r.expected(l)(n[">>="](t.bindDist)(u)(function(u){return n[">>="](t.bindDist)(a(u))(function(o){var i=r["??"](r.just(e)(o))(a(u));return n.pure(t.applicativeDist)(c(i))})}))}}};return{Entropy:u,selfInformation:c,logBase:o,log2:i,entropy:f,nonCond:a,entropyNum:l}}();var PS=PS||{};PS.Network_Types_Internal=function(){"use strict";var n=PS.Prelude,r=PS.Data_Maybe_Unsafe,e=PS.Data_Traversable,t=PS.Data_Array,u=PS.Data_Array_Unsafe,a=PS.Control_Monad_Error_Class,o=PS.Data_Set,i=PS.Data_Map,l=(PS.Data_Tuple,PS.Math_Probability,PS.Math_Probability_Internal),c=function(){function n(n,r){this.value0=n,this.value1=r}return n.create=function(r){return function(e){return new n(r,e)}},n}(),f=function(n){return n},s=function(){function n(n,r){this.value0=n,this.value1=r}return n.create=function(r){return function(e){return new n(r,e)}},n}(),v=function(){function n(n,r){this.value0=n,this.value1=r}return n.create=function(r){return function(e){return new n(r,e)}},n}(),_=function(){function n(n,r,e){this.value0=n,this.value1=r,this.value2=e}return n.create=function(r){return function(e){return function(t){return new n(r,e,t)}}},n}(),P=function(r){if(0===r.length)return[];if(r.length>=1){{r.slice(1)}if(0===r[0].length)return[]}return n[":"](t.map(u.head)(r))(P(t.map(u.tail)(r)))},p=function(r){return n["<<<"](n.semigroupoidArr)(a.throwError(r))(f)},d=function(r){return function(e){return new n.Show(function(t){return"Space ("+(n.show(r)(t.value0)+(") ("+(n.show(n.showArray(e))(t.value1)+")")))})}},S=new n.Show(function(n){return n}),h=function(r){return function(e){return function(t){return function(u){return new n.Show(function(a){return"CondPMF ("+(n.show(r)(a.value0)+(") ("+(n.show(t)(a.value1)+(") ("+(n.show(i.showMap(u)(l.showDist(e)))(a.value2)+")")))))})}}}},w=function(r){return n["<<<"](n.semigroupoidArr)(o.toList)(o.fromList(r))},m=function(r){return new n.Ord(function(){return o.eqSet(r["__superclass_Prelude.Eq_0"]())},function(e){return function(t){return n.compare(n.ordArray(r))(o.toList(e))(o.toList(t))}})},y=function(n){return function(r){return t.length(r)!==t.length(w(n)(r))}},g=function(n){return new s(n.value1,n.value2)},A=function(n){return function(r){return new _(n,r.value0,r.value1)}},b=function(e){return function(u){return n["<$>"](t.functorArray)(function(t){return n["<<<"](n.semigroupoidArr)(A(t))(r.fromJust)(i.lookup(e)(t)(u.value0))})(u.value1)}},T=function(r){return n["<<<"](n.semigroupoidArr)(e.sequence(e.traversableArray)(t.applicativeArray))(n["<<<"](n.semigroupoidArr)(n["<$>"](t.functorArray)(w(r)))(P))};return{PmfError:f,Network:v,CondPMFN:s,CondPMF:_,Space:c,setNub:w,throwPmf:p,duplicate:y,transpose:P,combos:T,netList:b,cp:A,cpn:g,ordSet:m,showSpace:d,showCond:h,showPmfError:S}}();var PS=PS||{};PS.Network_Types=function(){"use strict";var n=PS.Prelude,r=PS.Math_Probability,e=PS.Network_Types_Internal,t=PS.Data_Array,u=PS.Data_Foldable,a=PS.Data_Map,o=PS.Data_Array_Unsafe,i=(PS.Data_Maybe_Unsafe,PS.Data_Maybe),l=(PS.Control_Bind,PS.Control_Monad_Error_Class,PS.Data_Set,PS.Data_Traversable,PS.Data_Tuple),c=PS.Math_Probability_Internal,f=function(n){return n},s=function(n){return n},v=function(n){this.space=n},_=function(n){return n.value0},P=function(n){return n.value1},p=function(n){return n.space},d=new n.Show(function(r){return"Variable "+n.show(n.showString)(r)}),S=new v(function(r){return function(t){return function(u){return function(a){return 0===a.length?e.throwPmf(r)("No states provided for "+n.show(d)(u)):n.pure(t["__superclass_Prelude.Applicative_0"]())(new e.Space(u,a))}}}}),h=new n.Show(function(r){return"State "+n.show(n.showString)(r)}),w=e.netList,m=function(r){return function(t){return function(u){return n["<$>"](i.functorMaybe)(e.cp(t))(a.lookup(r)(t)(u.value0))}}},y=function(r){return function(t){return function(u){return function(o){return i.maybe(o)(n["<<<"](n.semigroupoidArr)(n.flip(e.Network.create)(o.value1))(n["<<<"](n.semigroupoidArr)(n.flip(a.insert(r)(u))(o.value0))(n["<<<"](n.semigroupoidArr)(e.cpn)(t))))(m(r)(u)(o))}}}},g=new n.Eq(function(r){return function(e){return!n["=="](g)(r)(e)}},function(n){return function(r){return n===r}}),A=new n.Ord(function(){return g},function(r){return function(e){return n.compare(n.ordString)(r)(e)}}),b=new n.Eq(function(r){return function(e){return!n["=="](b)(r)(e)}},function(n){return function(r){return n===r}}),T=new n.Ord(function(){return b},function(r){return function(e){return n.compare(n.ordString)(r)(e)}}),M=new v(function(r){return function(u){return function(a){return function(o){if(0===o.length)return e.throwPmf(r)("No states provided for "+n.show(n.showArray(d))(a));if(t.length(o)!==t.length(e.combos(T)(o)))return e.throwPmf(r)("Non-exhaustive list of [State] for "+(n.show(n.showArray(d))(a)+(": "+n.show(n.showArray(n.showArray(h)))(o))));if(n.otherwise)return n.pure(u["__superclass_Prelude.Applicative_0"]())(new e.Space(a,o));throw new Error("Failed pattern match")}}}}),D=function(r){return function(t){return e.CondPMF.create(t.value0)(t.value1)(n["<$>"](a.functorMap)(r)(t.value2))}},E=function(o){return function(i){return function(f){return function(s){return function(v){return function(p){return function(d){return function(S){return function(h){return function(w){if(t.length(P(h))!==t.length(w)||function(){var n=t.length(P(S));return!u.all(u.foldableArray)(function(e){return t.length(r.runProbList(e))===n})(w)}())return e.throwPmf(o)("Probabilities don't have same shape as state space: "+(n.show(e.showSpace(s)(v))(S)+("\n"+(n.show(e.showSpace(p)(d))(h)+("\n"+n.show(n.showArray(c.showProbList))(w))))));if(n.otherwise)return n["<<<"](n.semigroupoidArr)(n.pure(i["__superclass_Prelude.Applicative_0"]()))(n["<<<"](n.semigroupoidArr)(e.CondPMF.create(_(S))(_(h)))(a.fromList(f)))(t.zipWith(function(n){return function(e){return l.Tuple.create(n)(r.zipDist(P(S))(e))}})(P(h))(w));throw new Error("Failed pattern match")}}}}}}}}}},C=function(n){return n.value2},F=function(t){return n["<<<"](n.semigroupoidArr)(e.Space.create(t.value0))(n["<<<"](n.semigroupoidArr)(r.extract)(o.head))(a.values(t.value2))},$=function(n){return n.value0},L=function(r){return function(u){return function(o){return function(i){return function(c){return function(f){return function(s){return function(v){if(t.null(v))return e.throwPmf(r)("No CondPMF when constructing Network");if(e.duplicate(o)(n["<$>"](t.functorArray)($)(v)))return e.throwPmf(r)("Duplicated variable when constructing Network: "+n.show(n.showArray(e.showCond(i)(c)(f)(s)))(v));if(n.otherwise)return n.pure(u["__superclass_Prelude.Applicative_0"]())(new e.Network(a.fromList(o)(n["<$>"](t.functorArray)(function(n){return l.Tuple.create(n.value0)(new e.CondPMFN(n.value1,n.value2))})(v)),n["<$>"](t.functorArray)($)(v)));throw new Error("Failed pattern match")}}}}}}}},N=function(n){return n.value1};return{State:s,Variable:f,Spacy:v,netPmfAlter:y,condPmfMap:D,netList:w,lookup:m,network:L,condMap:C,condDeps:N,condMainSpace:F,condMain:$,condPmf:E,spaceVar:_,spaceStates:P,space:p,spacyVarState:S,spacyVarsStates:M,eqVariable:g,ordVariable:A,showVariable:d,eqState:b,ordState:T,showState:h}}();var PS=PS||{};PS.Network=function(){"use strict";var n=PS.Data_Array,r=PS.Prelude,e=PS.Math_Probability,t=PS.Math_Probability_Information,u=PS.Network_Types,a=PS.Data_Tuple,o=PS.Data_Maybe_Unsafe,i=PS.Data_Foldable,l=PS.Control_Arrow,c=PS.Data_Set,f=PS.Data_Traversable,s=PS.Control_Bind,v=(PS.Control_Monad_Error_Class,PS.Data_Array_Unsafe,PS.Data_Either,PS.Data_Function,PS.Data_Map),_=PS.Data_Maybe,P=PS.Network_Types_Internal,p=function(n){return function(t){return function(a){return i.foldl(i.foldableArray)(r.flip(u.netPmfAlter(n)(u.condPmfMap(r["<<<"](r.semigroupoidArr)(o.fromJust)(e.reshape(e.uniform))))))(a)(t)}}},d=function(e){return function(t){return r["<<<"](r.semigroupoidArr)(c.fromList(P.ordSet(a.ordTuple(e)(t))))(r["<<<"](r.semigroupoidArr)(r["<$>"](n.functorArray)(c.fromList(a.ordTuple(e)(t))))(r["<<<"](r.semigroupoidArr)(f.sequence(f.traversableArray)(n.applicativeArray))(r["<<<"](r.semigroupoidArr)(r["<$>"](n.functorArray)(r["<<<"](r.semigroupoidArr)(function(e){return r["<$>"](n.functorArray)(a.Tuple.create(u.spaceVar(e)))(u.spaceStates(e))})(u.condMainSpace)))(u.netList(e)))))}},S=function(t){return function(u){return function(a){return function(i){return r["<<<"](r.semigroupoidArr)(o.fromJust)(e.dist)(r["<$>"](n.functorArray)(l["&&&"](l.arrowFunction)(r.id(r.categoryArr))(a(i)))(c.toList(d(t)(u)(i))))}}}},h=function(r){var e=n.init(r);if(e instanceof _.Nothing)return[[]];if(e instanceof _.Just)return n.snoc(h(e.value0))(r);throw new Error("Failed pattern match")},w=function(i){return function(l){return function(f){return function(s){var v=r["<$>"](n.functorArray)(u.condMain)(u.netList(i)(s)),_=r["<$>"](n.functorArray)(r["<<<"](r.semigroupoidArr)(e.to(t.entropyNum))(r["<<<"](r.semigroupoidArr)(t.nonCond(t.entropy(c.eqSet(a.eqTuple(i["__superclass_Prelude.Eq_0"]())(l["__superclass_Prelude.Eq_0"]())))))(r["<<<"](r.semigroupoidArr)(S(i)(l)(f))(r.flip(p(i))(s)))))(h(v));return a.zip(v)(n.zipWith(function(n){return function(r){return e.from(t.entropyNum)(n-r)}})(o.fromJust(n.tail(_)))(_))}}}},m=function(n){return function(t){return function(a){return function(o){return function(i){return function(l){return function(c){return r[">>="](_.bindMaybe)(u.lookup(n)(o)(c))(function(n){return r["<$>"](_.functorMaybe)(e["??"](e.just(t)(l)))(v.lookup(a)(i(n))(u.condMap(n)))})}}}}}}},y=function(t){return function(o){return function(l){return function(v){var P=function(e){return function(o){return r["<$>"](n.functorArray)(a.snd)(n.filter(r["<<<"](r.semigroupoidArr)(r.flip(c.member(t))(c.fromList(t)(u.condDeps(o))))(a.fst))(c.toList(e)))}};return s["=<<"](_.bindMaybe)(r["<<<"](r.semigroupoidArr)(e.prob)(i.product(i.foldableArray)))(f.traverse(f.traversableArray)(_.applicativeMaybe)(function(n){return r["<$>"](_.functorMaybe)(e.runProb)(m(t)(o["__superclass_Prelude.Eq_0"]())(r.ordArray(o))(a.fst(n))(P(c.delete(a.ordTuple(t)(o))(n)(v)))(a.snd(n))(l))})(c.toList(v)))}}}};return{fullLookup:m,comboProb:y,netCombos:d,netDist:S,uniformize:p,netScores:w,inits:h}}();var PS=PS||{};PS.Text_Parsing_Parser=function(){"use strict";var n=PS.Prelude,r=(PS.Data_Identity,PS.Data_Either),e=(PS.Data_Maybe,PS.Data_Monoid,PS.Data_Tuple,PS.Control_Alt),t=PS.Control_Alternative,u=PS.Control_Lazy,a=(PS.Control_Monad,PS.Control_Monad_Trans),o=(PS.Control_Monad_State_Class,PS.Control_Monad_State_Trans,PS.Control_Monad_Error),i=(PS.Control_Monad_Error_Class,PS.Control_Monad_Error_Trans,PS.Control_MonadPlus,PS.Control_Plus),l=function(){function n(n){this.value0=n}return n.create=function(r){return new n(r)},n}(),c=function(n){return n},f=function(n){return n},s=new n.Show(function(n){return"ParseError { message: "+(n.value0.message+" }")}),v=function(r){return function(e){return function(t){return n[">>="](r["__superclass_Prelude.Bind_1"]())(f(t)(e))(function(e){return n.return(r)(e.result)})}}},_=new a.MonadTrans(function(e){return function(t){return c(function(u){return n["<$>"](e["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(function(n){return{input:u,consumed:!1,result:new r.Right(n)}})(t)})}}),P=new u.Lazy1(function(r){return c(function(e){return f(r(n.unit))(e)})}),p=function(e){return new n.Functor(function(t){return function(u){var a=function(e){return{input:e.input,result:n["<$>"](r.functorEither)(t)(e.result),consumed:e.consumed}};return c(function(r){return n["<$>"](e)(a)(f(u)(r))})}})},d=function(e){return function(t){return c(function(u){return n.return(e)({input:u,consumed:!1,result:new r.Left(new l({message:t}))})})}},S=new o.Error(new l({message:""}),function(n){return new l({message:n})}),h=function(r){return new n.Monad(function(){return y(r)},function(){return w(r)})},w=function(e){return new n.Bind(function(t){return function(u){var a=function(n){return function(r){return{input:r.input,consumed:n||r.consumed,result:r.result}}};return c(function(o){return n[">>="](e["__superclass_Prelude.Bind_1"]())(f(t)(o))(function(t){if(t.result instanceof r.Left)return n.return(e)({input:t.input,result:new r.Left(t.result.value0),consumed:t.consumed});if(t.result instanceof r.Right)return n["<$>"](e["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(a(t.consumed))(f(u(t.result.value0))(t.input));throw new Error("Failed pattern match")})})}},function(){return m(e)})},m=function(r){return new n.Apply(n.ap(h(r)),function(){return p(r["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())})},y=function(e){return new n.Applicative(function(){return m(e)},function(t){return c(function(u){return n.pure(e["__superclass_Prelude.Applicative_0"]())({input:u,result:new r.Right(t),consumed:!1})})})},g=function(t){return new e.Alt(function(e){return function(u){return c(function(a){return n[">>="](t["__superclass_Prelude.Bind_1"]())(f(e)(a))(function(e){return e.result instanceof r.Left&&!e.consumed?f(u)(a):n.return(t)(e)})})}},function(){return p(t["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())})},A=function(n){return new i.Plus(function(){return g(n)},d(n)("No alternative"))},b=function(n){return new t.Alternative(function(){return A(n)},function(){return y(n)})};return{ParserT:c,ParseError:l,fail:d,runParserT:v,unParserT:f,errorParseError:S,showParseError:s,functorParserT:p,applyParserT:m,applicativeParserT:y,altParserT:g,plusParserT:A,alternativeParserT:b,bindParserT:w,monadParserT:h,monadTransParserT:_,lazy1ParserT:P}}();var PS=PS||{};PS.Text_Parsing_Parser_Combinators=function(){"use strict";var n=PS.Control_Alt,r=PS.Text_Parsing_Parser,e=PS.Prelude,t=(PS.Control_Alternative,PS.Control_Apply,PS.Data_Maybe,PS.Data_Array,PS.Data_Tuple,PS.Data_Either),u=(PS.Control_Lazy,PS.Control_Monad,PS.Control_Monad_Error_Trans,PS.Control_Monad_Error_Class,PS.Control_Monad_State_Trans,PS.Control_Monad_State_Class,function(n){return function(u){var a=function(n){return function(r){return r.result instanceof t.Left?{input:n,result:r.result,consumed:!1}:r}};return r.ParserT(function(t){return e["<$>"](n)(a(t))(r.unParserT(u)(t))})}}),a=function(t){return function(u){return function(a){var o=n["<|>"](r.altParserT(t))(e[">>="](r.bindParserT(t))(a)(function(){return e.return(r.monadParserT(t))([])}))(e[">>="](r.bindParserT(t))(u)(function(n){return e[">>="](r.bindParserT(t))(o)(function(u){return e.return(r.monadParserT(t))(e[":"](n)(u))})}));return o}}},o=function(n){return function(t){return function(u){return e[">>="](r.bindParserT(n))(t)(function(o){return e[">>="](r.bindParserT(n))(a(n)(t)(u))(function(t){return e.return(r.monadParserT(n))(e[":"](o)(t))})})}}},i=function(n){return function(r){return function(t){return e[">>="](n["__superclass_Prelude.Bind_1"]())(r(t))(function(r){return e.return(n)(function(){var n={};for(var e in r)r.hasOwnProperty(e)&&(n[e]=r[e]);return n.input=t,n.consumed=!1,n}())})}}};return{many1Till:o,manyTill:a,lookAhead:i,try:u}}();var PS=PS||{};PS.Text_Parsing_Parser_String=function(){"use strict";var n=PS.Prelude,r=PS.Control_Monad_Error,e=PS.Data_String,t=PS.Data_Char,u=PS.Text_Parsing_Parser_Combinators,a=PS.Text_Parsing_Parser,o=PS.Control_Alternative,i=PS.Control_Alt,l=PS.Data_Foldable,c=PS.Data_Either,f=PS.Data_Monoid,s=PS.Data_Maybe,v=(PS.Control_Monad_Error_Class,PS.Control_Monad_State_Class,function(t){return function(u){return a.ParserT(function(o){return n.return(t)(function(){var t=e.indexOf(u)(o);return 0===t?{consumed:!0,input:e.drop(e.length(u))(o),result:new c.Right(u)}:{consumed:!1,input:o,result:new c.Left(r.strMsg(a.errorParseError)("Expected "+n.show(n.showString)(u)))}}())})}}),_=function(r){return n[">>="](a.bindParserT(r))(o.many(a.alternativeParserT(r))(a.lazy1ParserT)(i["<|>"](a.altParserT(r))(i["<|>"](a.altParserT(r))(i["<|>"](a.altParserT(r))(v(r)("\n"))(v(r)("\r")))(v(r)(" ")))(v(r)("	"))))(function(e){return n.return(a.monadParserT(r))(l.foldMap(l.foldableArray)(f.monoidString)(n.id(n.categoryArr))(e))})},P=function(e){return a.ParserT(function(t){return n.return(e)(function(){return""===t?{consumed:!1,input:t,result:new c.Right(n.unit)}:{consumed:!1,input:t,result:new c.Left(r.strMsg(a.errorParseError)("Expected EOF"))}}())})},p=function(u){return a.ParserT(function(o){return n.return(u)(function(){var n=e.charAt(0)(o);if(n instanceof s.Nothing)return{consumed:!1,input:o,result:new c.Left(r.strMsg(a.errorParseError)("Unexpected EOF"))};if(n instanceof s.Just)return{consumed:!0,input:e.drop(1)(o),result:new c.Right(t.charString(n.value0))};throw new Error("Failed pattern match")}())})},d=function(r){return function(e){return u.try(r["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(n[">>="](a.bindParserT(r))(p(r))(function(t){var u=e(t);if(u)return n.return(a.monadParserT(r))(t);if(!u)return a.fail(r)("Character did not satisfy predicate");throw new Error("Failed pattern match")}))}},S=function(r){return function(e){return d(r)(n.flip(l.notElem(n.eqString)(l.foldableArray))(e))}};return{noneOf:S,whiteSpace:_,satisfy:d,char:p,string:v,eof:P}}();var PS=PS||{};PS.Network_Parser=function(){"use strict";function n(n){var r=parseFloat(n);return 0/0===r?l.Nothing.value:l.Just.create(r)}var r=PS.Prelude,e=PS.Text_Parsing_Parser_String,t=PS.Control_Alternative,u=PS.Data_Foldable,a=PS.Control_Alt,o=PS.Text_Parsing_Parser_Combinators,i=PS.Control_Monad_Trans,l=PS.Data_Maybe,c=PS.Network_Types_Internal,f=PS.Control_Bind,s=PS.Math_Probability,v=PS.Network_Types,_=PS.Data_Tuple,P=PS.Data_Array_Unsafe,p=(PS.Control_Monad_Error_Class,PS.Text_Parsing_Parser),d=PS.Data_Monoid,S=PS.Math_Probability_Internal,h=PS.Data_Array,w=function(n){return function(e){return function(t){return r[">>="](n["__superclass_Prelude.Bind_1"]())(e)(function(){return t})}}},m=function(n){return r["<$>"](p.functorParserT(n["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]()))(u.mconcat(u.foldableArray)(d.monoidString))(t.some(p.alternativeParserT(n))(p.lazy1ParserT)(e.noneOf(n)(["\n","\r","	"," ",""])))},y=function(n){return r["<$>"](p.functorParserT(n["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]()))(v.State)(m(n))},g=function(e){return function(t){return r[">>="](p.bindParserT(t))(m(t))(function(u){return r["<<<"](r.semigroupoidArr)(i.lift(p.monadTransParserT)(t))(l.maybe(c.throwPmf(e)("Couldn't parse as probability: "+u))(r.pure(t["__superclass_Prelude.Applicative_0"]())))(f["=<<"](l.bindMaybe)(s.prob)(n(u)))})}},A=function(n){return r["<$>"](p.functorParserT(n["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]()))(v.Variable)(m(n))},b=function(n){return a["<|>"](p.altParserT(n))(e.string(n)(" "))(e.string(n)("	"))},T=function(n){return function(e){return r[">>="](p.bindParserT(e))(y(e))(function(u){return r[">>="](p.bindParserT(e))(t.some(p.alternativeParserT(e))(p.lazy1ParserT)(b(e)))(function(){return r[">>="](p.bindParserT(e))(g(n)(e))(function(n){return r.pure(p.applicativeParserT(e))(new _.Tuple(u,n))})})})}},M=function(n){return r[">>="](p.bindParserT(n))(m(n))(function(e){return r[">>="](p.bindParserT(n))(t.many(p.alternativeParserT(n))(p.lazy1ParserT)(b(n)))(function(){return r.pure(p.applicativeParserT(n))(e)})})},D=function(n){return r[">>="](p.bindParserT(n))(e.string(n)("----"))(function(){return r[">>="](p.bindParserT(n))(t.many(p.alternativeParserT(n))(p.lazy1ParserT)(e.string(n)("-")))(function(){return r.pure(p.applicativeParserT(n))(r.unit)})})},E=function(n){return function(u){return r[">>="](p.bindParserT(u))(e.string(u)("|"))(function(){return r[">>="](p.bindParserT(u))(t.some(p.alternativeParserT(u))(p.lazy1ParserT)(b(u)))(function(){return T(n)(u)})})}},C=function(n){return function(u){return r[">>="](p.bindParserT(u))(t.some(p.alternativeParserT(u))(p.lazy1ParserT)(r[">>="](p.bindParserT(u))(E(n)(u))(function(n){return r[">>="](p.bindParserT(u))(e.whiteSpace(u))(function(){return r.pure(p.applicativeParserT(u))(n)})})))(function(e){return r["<<<"](r.semigroupoidArr)(i.lift(p.monadTransParserT)(u))(l.maybe(c.throwPmf(n)("Couldn't construct distribution: "+r.show(r.showArray(_.showTuple(v.showState)(S.showProb)))(e)))(r.pure(u["__superclass_Prelude.Applicative_0"]())))(s.dist(e))})}},F=function(n){return o.manyTill(n)(r["<$>"](p.functorParserT(n["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]()))(v.State)(M(n)))(o.lookAhead(n)(e.string(n)("|")))
},$=function(n){return o.manyTill(n)(r["<$>"](p.functorParserT(n["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]()))(v.Variable)(M(n)))(e.string(n)("|"))},L=function(n){return r[">>="](p.bindParserT(n))($(n))(function(u){return r[">>="](p.bindParserT(n))(t.some(p.alternativeParserT(n))(p.lazy1ParserT)(b(n)))(function(){return r[">>="](p.bindParserT(n))(A(n))(function(a){return r[">>="](p.bindParserT(n))(t.some(p.alternativeParserT(n))(p.lazy1ParserT)(b(n)))(function(){return r[">>="](p.bindParserT(n))(e.string(n)("P"))(function(){return r.pure(p.applicativeParserT(n))(new _.Tuple(u,a))})})})})})},N=function(n){return function(e){return r[">>="](p.bindParserT(e))(F(e))(function(t){return r[">>="](p.bindParserT(e))(C(n)(e))(function(n){return r.pure(p.applicativeParserT(e))(new _.Tuple(t,n))})})}},q=function(n){return function(t){return r[">>="](p.bindParserT(t))(e.whiteSpace(t))(function(){return r[">>="](p.bindParserT(t))(L(t))(function(u){return r[">>="](p.bindParserT(t))(w(p.monadParserT(t))(w(p.monadParserT(t))(e.whiteSpace(t))(D(t)))(e.whiteSpace(t)))(function(){return r[">>="](p.bindParserT(t))(o.many1Till(t)(N(n)(t))(a["<|>"](p.altParserT(t))(D(t))(e.eof(t))))(function(e){return i.lift(p.monadTransParserT)(t)(r[">>="](t["__superclass_Prelude.Bind_1"]())(r["<<<"](r.semigroupoidArr)(v.space(v.spacyVarState)(n)(t)(u.value1))(r["<<<"](r.semigroupoidArr)(s.extract)(_.snd))(P.head(e)))(function(a){return r[">>="](t["__superclass_Prelude.Bind_1"]())(v.space(v.spacyVarsStates)(n)(t)(u.value0)(r["<$>"](h.functorArray)(_.fst)(e)))(function(u){return v.condPmf(n)(t)(r.ordArray(v.ordState))(v.showVariable)(v.showState)(r.showArray(v.showVariable))(r.showArray(v.showState))(a)(u)(r["<$>"](h.functorArray)(r["<<<"](r.semigroupoidArr)(s.distProbs)(_.snd))(e))})}))})})})})}},k=function(n){return function(u){return r[">>="](p.bindParserT(u))(e.whiteSpace(u))(function(){return r[">>="](p.bindParserT(u))(D(u))(function(){return r[">>="](p.bindParserT(u))(t.some(p.alternativeParserT(u))(p.lazy1ParserT)(q(n)(u)))(function(e){return i.lift(p.monadTransParserT)(u)(v.network(n)(u)(v.ordVariable)(v.showVariable)(v.showState)(r.showArray(v.showVariable))(r.showArray(v.showState))(e))})})})}};return{readNumber:n,networkP:k,condPmfP:q,casePmfP:N,distP:C,distEleP:E,outcomeP:T,probP:g,stateP:y,depsP:F,headerP:L,mainVarP:A,depVarsP:$,">>":w,inlineSpace:b,wordSpace:M,word:m,hRuleP:D}}();var PS=PS||{};PS.Main=function(){"use strict";var n=PS.Prelude,r=PS.Control_Monad_JQuery,e=PS.Data_Foldable,t=PS.Data_String,u=PS.Data_Tuple,a=PS.Text_Parsing_Parser,o=PS.Data_Either_Unsafe,i=PS.Data_Foreign,l=PS.Network_Parser,c=PS.Network,f=PS.Data_Maybe_Unsafe,s=PS.Control_Monad_Eff,v=PS.Data_Either,_=(PS.Data_Set,PS.Debug_Trace,PS.DOM,PS.Network_Types),P=(PS.Math_Probability_Information,PS.Control_Monad_Error_Class),p=PS.Network_Types_Internal,d=a.runParserT(v.monadEither),S=function(n){return function(){var t=r.create("<thead>")(),u=r.create("<tr>")(),a=r.create("<th>")();return r.appendText("Variable")(a)(),r.append(a)(u)(),e.for_(s.applicativeEff)(e.foldableArray)(n)(function(n){return function(){var e=r.create("<th>")();return r.appendText(n)(e)(),r.append(e)(u)()}})(),r.append(u)(t)()}},h=function(u){return function(){var a=r.create("<tbody>")(),o=r.create("<tr>")(),i=r.create("<td>")();return r.appendText("Score")(i)(),r.append(i)(o)(),e.for_(s.applicativeEff)(e.foldableArray)(u)(function(e){return function(){var u=r.create("<td>")();return r.appendText(t.take(6)(n.show(n.showNumber)(e)))(u)(),r.append(u)(o)()}})(),r.append(o)(a)()}},w=function(n){return function(){var e=r.create("<table>")();return function(){var t=u.unzip(n);return function(){var n=S(u.fst(t))(),a=h(u.snd(t))();return r.append(n)(e)(),r.append(a)(e)()}}()()}},m=function(){var e=r.select(".net > div > textarea")(),t=n["<$>"](s.functorEff)(n["<<<"](n.semigroupoidArr)(o.fromRight)(i.readString))(r.getValue(e))();return function(){var e=d(t)(l.networkP(P.monadErrorError)(v.monadEither));return function(){var t=r.select(".net > div > output")();if(r.clear(t)(),e instanceof v.Left)return r.appendText(n.show(p.showPmfError)(e.value0))(t)();if(e instanceof v.Right){if(e.value0 instanceof v.Left)return r.appendText(n.show(a.showParseError)(e.value0.value0))(t)();if(e.value0 instanceof v.Right)return n[">>="](s.bindEff)(w(c.netScores(_.ordVariable)(_.ordState)(function(r){return n["<<<"](n.semigroupoidArr)(f.fromJust)(c.comboProb(_.ordVariable)(_.ordState)(r))})(e.value0.value0)))(n.flip(r.append)(t))();throw new Error("Failed pattern match")}throw new Error("Failed pattern match")}}()()},y=r.ready(function(){var n=r.select(".net > button")();return m(),r.on("click")(function(){return function(){return m}})(n)()});return{main:y,process:m,"runParserT'":d,table:w,body:h,header:S}}(),PS.Main.main();