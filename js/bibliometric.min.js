var PS;(PS=PS||{}).Prelude=function(){"use strict";function n(n){return function(r){return[n].concat(r)}}function r(n){return function(r){return n===r}}function e(n){return function(r){return n!==r}}var t,u=function(){function n(){}return n.value=new n,n}(),a=function(){function n(){}return n.value=new n,n}(),o=function(){function n(){}return n.value=new n,n}(),i=function(n){this["<<<"]=n},l=function(n,r){this["__superclass_Prelude.Semigroupoid_0"]=n,this.id=r},c=function(n){this.show=n},f=function(n,r,e,t){this["*"]=n,this["+"]=r,this.one=e,this.zero=t},s=function(n,r,e){this["/"]=n,this["__superclass_Prelude.Semiring_0"]=r,this.mod=e},v=function(n,r){this["-"]=n,this["__superclass_Prelude.Semiring_0"]=r},_=function(n,r){this["/="]=n,this["=="]=r},P=function(n,r){this["__superclass_Prelude.Eq_0"]=n,this.compare=r},p=function(n,r,e){this["&&"]=n,this.not=r,this["||"]=e},d=function(n){this["<>"]=n},h=function(n){return n[">>="]},S=function(n){return n["=="]},w=function(n){return n["<>"]},m=function(n){return n["<<<"]},y=function(n){return n["<*>"]},g=n,A=function(n){return n["-"]},b=function(n){return n.zero},T=(t=u.value,function(n){return function(r){return function(e){return function(u){return u>e?t:e>u?r:n}}}})(o.value)(a.value),M=new c(function(n){return JSON.stringify(n)}),D=new c(function(n){return n.toString()}),E=function(n){return n.show},C=new f(function(n){return function(r){return n*r}},function(n){return function(r){return n+r}},1,0),F=new i(function(n){return function(r){return function(e){return n(r(e))}}}),$=new d(function(n){return function(r){return n+r}}),L=new v(function(n){return function(r){return n-r}},function(){return C}),N=function(n){return n.pure},q=function(n){return N(n["__superclass_Prelude.Applicative_0"]())},k=function(n){return n.not},x=new s(function(n){return function(r){return n/r}},function(){return C},function(){return function(){return 0}}),z=new _(function(){return function(){return!1}},function(){return function(){return!0}}),B=new _(e,r),V=new P(function(){return B},T),J=new _(e,r),U=new P(function(){return J},T),I=function(n){return n.compare},O=new l(function(){return F},function(n){return n}),R=new p(function(n){return function(r){return n&&r}},function(n){return!n},function(n){return function(r){return n||r}}),j=function(n){return new _(function(r){return function(e){return k(R)(S(j(n))(r)(e))}},function(r){return function(e){return(t=S(n),function(n){return function(r){if(n.length!==r.length)return!1;for(var e=0;e<n.length;e++)if(!t(n[e])(r[e]))return!1;return!0}})(r)(e);var t}})},Q=function(n){return new P(function(){return j(n["__superclass_Prelude.Eq_0"]())},function(r){return function(e){if(0===r.length&&0===e.length)return o.value;if(0===r.length)return u.value;if(0===e.length)return a.value;if(r.length>=1){var t=r.slice(1);if(e.length>=1){var i=e.slice(1),l=I(n)(r[0])(e[0]);return l instanceof o?I(Q(n))(t)(i):l}}throw new Error("Failed pattern match")}})};return{Unit:function(n){return n},LT:u,GT:a,EQ:o,Semigroup:d,BoolLike:p,Ord:P,Eq:_,Ring:v,ModuloSemiring:s,Semiring:f,Monad:function(n,r){this["__superclass_Prelude.Applicative_0"]=n,this["__superclass_Prelude.Bind_1"]=r},Bind:function(n,r){this[">>="]=n,this["__superclass_Prelude.Apply_0"]=r},Applicative:function(n,r){this["__superclass_Prelude.Apply_0"]=n,this.pure=r},Apply:function(n,r){this["<*>"]=n,this["__superclass_Prelude.Functor_0"]=r},Functor:function(n){this["<$>"]=n},Show:c,Category:l,Semigroupoid:i,unit:{},"++":function(n){return w(n)},"<>":w,not:k,"||":function(n){return n["||"]},"&&":function(n){return n["&&"]},"<=":function(n){return function(r){return function(e){return!(I(n)(r)(e)instanceof a)}}},"<":function(n){return function(r){return function(e){return I(n)(r)(e)instanceof u}}},compare:I,"/=":function(n){return n["/="]},"==":S,negate:function(n){return function(r){return A(n)(b(n["__superclass_Prelude.Semiring_0"]()))(r)}},"-":A,"/":function(n){return n["/"]},"*":function(n){return n["*"]},zero:b,"+":function(n){return n["+"]},ap:function(n){return function(r){return function(e){return h(n["__superclass_Prelude.Bind_1"]())(r)(function(r){return h(n["__superclass_Prelude.Bind_1"]())(e)(function(e){return q(n)(r(e))})})}}},return:q,">>=":h,liftA1:function(n){return function(r){return function(e){return y(n["__superclass_Prelude.Apply_0"]())(N(n)(r))(e)}}},pure:N,"<*>":y,"<$>":function(n){return n["<$>"]},show:E,cons:n,":":g,$:function(n){return function(r){return n(r)}},id:function(n){return n.id},">>>":function(n){return function(r){return function(e){return m(n)(e)(r)}}},"<<<":m,const:function(n){return function(){return n}},flip:function(n){return function(r){return function(e){return n(e)(r)}}},otherwise:!0,semigroupoidArr:F,categoryArr:O,showString:M,showNumber:D,showArray:function(n){return new c((r=E(n),function(n){for(var e=[],t=0,u=n.length;u>t;t++)e[t]=r(n[t]);return"["+e.join(",")+"]"}));var r},semiringNumber:C,ringNumber:L,moduloSemiringNumber:x,eqUnit:z,eqString:B,eqNumber:J,eqArray:j,ordNumber:U,ordString:V,ordArray:Q,boolLikeBoolean:R,semigroupString:$}}(),(PS=PS||{}).Prelude_Unsafe=function(){"use strict";return PS.Prelude,{unsafeIndex:function(n){return function(r){return n[r]}}}}(),(PS=PS||{}).$$Math=function(){"use strict";var n=(PS.Prelude,Math.abs);return{log:Math.log,abs:n}}(),(PS=PS||{}).Data_Profunctor=function(){"use strict";var n=PS.Prelude,r=function(n){this.dimap=n};return{Profunctor:r,profunctorArr:new r(function(r){return function(e){return function(t){return n[">>>"](n.semigroupoidArr)(r)(n[">>>"](n.semigroupoidArr)(t)(e))}}})}}(),(PS=PS||{}).Data_Function=function(){"use strict";return PS.Prelude,{runFn4:function(n){return function(r){return function(e){return function(t){return function(u){return n(r,e,t,u)}}}}}}}(),(PS=PS||{}).Data_Char=function(){"use strict";return{charString:(PS.Prelude,function(n){return n})}}(),(PS=PS||{}).Control_Monad_Trans=function(){"use strict";return{MonadTrans:(PS.Prelude,function(n){this.lift=n}),lift:function(n){return n.lift}}}(),(PS=PS||{}).Control_Monad_Error=function(){"use strict";return{Error:(PS.Prelude,function(n,r){this.noMsg=n,this.strMsg=r}),strMsg:function(n){return n.strMsg}}}(),(PS=PS||{}).Control_Monad_Eff=function(){"use strict";var n=PS.Prelude,r=new n.Monad(function(){return u},function(){return e}),e=new n.Bind(function(n){return function(r){return function(){return r(n())()}}},function(){return t}),t=new n.Apply(n.ap(r),function(){return a}),u=new n.Applicative(function(){return t},function(n){return function(){return n}}),a=new n.Functor(n.liftA1(u));return{functorEff:a,applyEff:t,applicativeEff:u,bindEff:e,monadEff:r}}(),(PS=PS||{}).Control_Lazy=function(){"use strict";return{Lazy1:(PS.Prelude,function(n){this.defer1=n}),defer1:function(n){return n.defer1}}}(),(PS=PS||{}).Control_Bind=function(){"use strict";var n=PS.Prelude;return{"=<<":function(r){return function(e){return function(t){return n[">>="](r)(t)(e)}}}}}(),(PS=PS||{}).Control_Apply=function(){"use strict";var n=PS.Prelude;return{"*>":function(r){return function(e){return function(t){return n["<*>"](r)(n["<$>"](r["__superclass_Prelude.Functor_0"]())(n.const(n.id(n.categoryArr)))(e))(t)}}}}}(),(PS=PS||{}).Control_Alt=function(){"use strict";return{Alt:(PS.Prelude,function(n,r){this["<|>"]=n,this["__superclass_Prelude.Functor_0"]=r}),"<|>":function(n){return n["<|>"]}}}(),(PS=PS||{}).Control_Plus=function(){"use strict";return{Plus:(PS.Prelude,PS.Control_Alt,function(n,r){this["__superclass_Control.Alt.Alt_0"]=n,this.empty=r})}}(),(PS=PS||{}).Control_Alternative=function(){"use strict";var n=PS.Prelude,r=PS.Control_Lazy,e=PS.Control_Alt,t=function(e){return function(t){return function(a){return n["<*>"](e["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]())(n["<$>"](e["__superclass_Control.Plus.Plus_1"]()["__superclass_Control.Alt.Alt_0"]()["__superclass_Prelude.Functor_0"]())(n[":"])(a))(r.defer1(t)(function(){return u(e)(t)(a)}))}}},u=function(r){return function(u){return function(a){return e["<|>"](r["__superclass_Control.Plus.Plus_1"]()["__superclass_Control.Alt.Alt_0"]())(t(r)(u)(a))(n.pure(r["__superclass_Prelude.Applicative_0"]())([]))}}};return{Alternative:(PS.Control_Plus,function(n,r){this["__superclass_Control.Plus.Plus_1"]=n,this["__superclass_Prelude.Applicative_0"]=r}),many:u,some:t}}(),(PS=PS||{}).Data_Maybe=function(){"use strict";var n=PS.Prelude,r=(PS.Control_Alt,PS.Control_Alternative,PS.Control_Extend,PS.Control_MonadPlus,PS.Control_Plus,function(){function n(){}return n.value=new n,n}()),e=function(){function n(n){this.value0=n}return n.create=function(r){return new n(r)},n}(),t=function(n){return function(t){return function(u){if(u instanceof r)return n;if(u instanceof e)return t(u.value0);throw new Error("Failed pattern match")}}},u=t(!1)(n.const(!0)),a=new n.Functor(function(n){return function(t){return t instanceof e?new e(n(t.value0)):r.value}}),o=new n.Apply(function(t){return function(u){if(t instanceof e)return n["<$>"](a)(t.value0)(u);if(t instanceof r)return r.value;throw new Error("Failed pattern match")}},function(){return a}),i=new n.Bind(function(n){return function(t){if(n instanceof e)return t(n.value0);if(n instanceof r)return r.value;throw new Error("Failed pattern match")}},function(){return o}),l=new n.Applicative(function(){return o},e.create);return{Nothing:r,Just:e,isJust:u,maybe:t,functorMaybe:a,applyMaybe:o,applicativeMaybe:l,bindMaybe:i}}(),(PS=PS||{}).Data_Array=function(){"use strict";function n(n){return n.length}function r(n){return function(r){return n.concat(r)}}function e(n){return function(r){for(var e=[],t=0,u=r.length;u>t;t++)Array.prototype.push.apply(e,n(r[t]));return e}}function t(n){return function(r){for(var e=r.length,t=new Array(e),u=0;e>u;u++)t[u]=n(r[u]);return t}}var u=PS.Prelude,a=PS.Data_Maybe,o=(PS.Control_Alt,PS.Control_Plus,PS.Control_Alternative,PS.Control_MonadPlus,PS.Prelude_Unsafe,function(n){if(n.length>=1){var r=n.slice(1);return new a.Just(r)}return a.Nothing.value}),i=function(n){return[n]},l=new u.Semigroup(r),c=new u.Functor(t),f=new u.Monad(function(){return _},function(){return s}),s=new u.Bind(u.flip(e),function(){return v}),v=new u.Apply(u.ap(f),function(){return c}),_=new u.Applicative(function(){return v},i);return{zipWith:function(n){return function(r){return function(e){for(var t=r.length<e.length?r.length:e.length,u=new Array(t),a=0;t>a;a++)u[a]=n(r[a])(e[a]);return u}}},filter:function(n){return function(r){for(var e=0,t=[],u=0,a=r.length;a>u;u++)n(r[u])&&(t[e++]=r[u]);return t}},concatMap:e,append:r,length:n,map:t,null:function(n){return 0===n.length},init:function(r){return 0===r.length?a.Nothing.value:new a.Just((e=0,function(n){return function(r){return r.slice(e,n)}})(n(r)-1)(r));var e},tail:o,singleton:i,snoc:function(n){return function(r){var e=n.slice();return e.push(r),e}},functorArray:c,applyArray:v,applicativeArray:_,bindArray:s,monadArray:f,semigroupArray:l}}(),(PS=PS||{}).Data_Either=function(){"use strict";var n=PS.Prelude,r=(PS.Control_Alt,PS.Control_Extend,PS.Data_Maybe,function(){function n(n){this.value0=n}return n.create=function(r){return new n(r)},n}()),e=function(){function n(n){this.value0=n}return n.create=function(r){return new n(r)},n}(),t=new n.Functor(function(n){return function(t){if(t instanceof r)return new r(t.value0);if(t instanceof e)return new e(n(t.value0));throw new Error("Failed pattern match")}}),u=function(n){return function(t){return function(u){if(u instanceof r)return n(u.value0);if(u instanceof e)return t(u.value0);throw new Error("Failed pattern match")}}},a=new n.Apply(function(u){return function(a){if(u instanceof r)return new r(u.value0);if(u instanceof e)return n["<$>"](t)(u.value0)(a);throw new Error("Failed pattern match")}},function(){return t}),o=new n.Bind(u(function(n){return function(){return new r(n)}})(function(n){return function(r){return r(n)}}),function(){return a}),i=new n.Applicative(function(){return a},e.create),l=new n.Monad(function(){return i},function(){return o});return{Left:r,Right:e,either:u,functorEither:t,applyEither:a,applicativeEither:i,bindEither:o,monadEither:l}}(),(PS=PS||{}).Data_Either_Unsafe=function(){"use strict";var n=(PS.Prelude,PS.Data_Either);return{fromRight:function(r){if(r instanceof n.Right)return r.value0;throw new Error("Failed pattern match")}}}(),(PS=PS||{}).Data_Foreign=function(){"use strict";function n(n){return n}function r(n){return Object.prototype.toString.call(n).slice(8,-1)}var e,t=PS.Prelude,u=(PS.Data_Function,PS.Data_Array,PS.Data_Either),a=function(){function n(n,r){this.value0=n,this.value1=r}return n.create=function(r){return function(e){return new n(r,e)}},n}(),o=(e="String",function(o){return r(o)===e?t.pure(u.applicativeEither)(n(o)):new u.Left(new a(e,r(o)))});return{TypeMismatch:a,readString:o,tagOf:r,unsafeFromForeign:n}}(),(PS=PS||{}).Control_Monad_JQuery=function(){"use strict";return PS.Prelude,PS.Data_Foreign,PS.Control_Monad_Eff,PS.DOM,{on:function(n){return function(r){return function(e){return function(){return e.on(n,function(n){r(n)(jQuery(this))()})}}}},getValue:function(n){return function(){return n.val()}},appendText:function(n){return function(r){return function(){return r.append(n)}}},clear:function(n){return function(){return n.empty()}},append:function(n){return function(r){return function(){return r.append(n)}}},create:function(n){return function(){return jQuery(n)}},select:function(n){return function(){return jQuery(n)}},ready:function(n){return function(){jQuery(document).ready(n)}}}}(),(PS=PS||{}).Data_Maybe_Unsafe=function(){"use strict";var n=(PS.Prelude,PS.Data_Maybe);return{fromJust:function(r){if(r instanceof n.Just)return r.value0;throw new Error("Failed pattern match")}}}(),(PS=PS||{}).Data_Array_Unsafe=function(){"use strict";return{tail:(PS.Prelude_Unsafe,PS.Prelude,PS.Data_Array,PS.Data_Maybe_Unsafe,function(n){if(n.length>=1)return n.slice(1);throw new Error("Failed pattern match")}),head:function(n){return n[0]}}}(),(PS=PS||{}).Data_Monoid=function(){"use strict";var n=PS.Prelude,r=PS.Data_Array,e=(PS.Data_Maybe,function(n,r){this["__superclass_Prelude.Semigroup_0"]=n,this.mempty=r});return{Monoid:e,mempty:function(n){return n.mempty},monoidString:new e(function(){return n.semigroupString},""),monoidArray:new e(function(){return r.semigroupArray},[])}}(),(PS=PS||{}).Data_Tuple=function(){"use strict";var n=PS.Prelude,r=(PS.Data_Monoid,PS.Control_Lazy,PS.Data_Array),e=(PS.Control_Comonad,PS.Control_Extend,function(){function n(n,r){this.value0=n,this.value1=r}return n.create=function(r){return function(e){return new n(r,e)}},n}()),t=r.zipWith(e.create),u=function(r){if(r.length>=1){var t=r.slice(1),a=u(t);return new e(n[":"](r[0].value0)(a.value0),n[":"](r[0].value1)(a.value1))}if(0===r.length)return new e([],[]);throw new Error("Failed pattern match")},a=new n.Functor(function(n){return function(r){return new e(r.value0,n(r.value1))}}),o=function(r){return function(e){return new n.Eq(function(t){return function(u){return!n["=="](o(r)(e))(t)(u)}},function(t){return function(u){return n["=="](r)(t.value0)(u.value0)&&n["=="](e)(t.value1)(u.value1)}})}};return{Tuple:e,unzip:u,zip:t,snd:function(n){return n.value1},fst:function(n){return n.value0},showTuple:function(r){return function(e){return new n.Show(function(t){return"Tuple ("+n.show(r)(t.value0)+") ("+n.show(e)(t.value1)+")"})}},eqTuple:o,ordTuple:function(r){return function(e){return new n.Ord(function(){return o(r["__superclass_Prelude.Eq_0"]())(e["__superclass_Prelude.Eq_0"]())},function(t){return function(u){var a=n.compare(r)(t.value0)(u.value0);return a instanceof n.EQ?n.compare(e)(t.value1)(u.value1):a}})}},functorTuple:a}}(),(PS=PS||{}).Control_Monad_Error_Class=function(){"use strict";var n=(PS.Prelude,PS.Control_Monad_Error_Trans,PS.Control_Monad_Trans,PS.Control_Monad_Maybe_Trans,PS.Control_Monad_Reader_Trans,PS.Control_Monad_Writer_Trans,PS.Control_Monad_State_Trans,PS.Control_Monad_Error,PS.Data_Either),r=(PS.Data_Monoid,function(n,r){this.catchError=n,this.throwError=r});return{MonadError:r,throwError:function(n){return n.throwError},monadErrorError:new r(function(r){return function(e){if(r instanceof n.Left)return e(r.value0);if(r instanceof n.Right)return new n.Right(r.value0);throw new Error("Failed pattern match")}},n.Left.create)}}(),(PS=PS||{}).Data_Profunctor_Strong=function(){"use strict";var n=PS.Prelude,r=PS.Data_Profunctor,e=PS.Data_Tuple,t=function(n,r,e){this["__superclass_Data.Profunctor.Profunctor_0"]=n,this.first=r,this.second=e};return{Strong:t,second:function(n){return n.second},first:function(n){return n.first},strongArr:new t(function(){return r.profunctorArr},function(n){return function(r){return new e.Tuple(n(r.value0),r.value1)}},n["<$>"](e.functorTuple))}}(),(PS=PS||{}).Control_Arrow=function(){"use strict";var n=PS.Prelude,r=PS.Data_Profunctor_Strong,e=PS.Data_Tuple,t=function(n,r,e){this["__superclass_Data.Profunctor.Strong.Strong_1"]=n,this["__superclass_Prelude.Category_0"]=r,this.arr=e},u=function(e){return function(t){return function(u){return n[">>>"](e["__superclass_Prelude.Category_0"]()["__superclass_Prelude.Semigroupoid_0"]())(r.first(e["__superclass_Data.Profunctor.Strong.Strong_1"]())(t))(r.second(e["__superclass_Data.Profunctor.Strong.Strong_1"]())(u))}}},a=new t(function(){return r.strongArr},function(){return n.categoryArr},function(n){return n}),o=function(n){return n.arr};return{Arrow:t,"&&&":function(r){return function(t){return function(a){return n[">>>"](r["__superclass_Prelude.Category_0"]()["__superclass_Prelude.Semigroupoid_0"]())(o(r)(function(n){return new e.Tuple(n,n)}))(u(r)(t)(a))}}},"***":u,arr:o,arrowFunction:a}}(),(PS=PS||{}).Data_Foldable=function(){"use strict";function n(n){return function(r){return function(e){for(var t=r,u=e.length-1;u>=0;--u)t=n(e[u])(t);return t}}}function r(n){return function(r){return function(e){for(var t=r,u=0,a=e.length;a>u;++u)t=n(t)(e[u]);return t}}}var e=PS.Prelude,t=PS.Data_Monoid,u=PS.Control_Apply,a=(PS.Data_Monoid_First,PS.Data_Either,PS.Data_Maybe,PS.Data_Monoid_Additive,PS.Data_Monoid_Dual,PS.Data_Monoid_Last,PS.Data_Monoid_Multiplicative,PS.Data_Tuple,function(n,r,e){this.foldMap=n,this.foldl=r,this.foldr=e}),o=function(n){return n.foldr},i=function(n){return function(r){return function(t){return o(r)(e["<<<"](e.semigroupoidArr)(u["*>"](n["__superclass_Prelude.Apply_0"]()))(t))(e.pure(n)(e.unit))}}},l=function(n){return n.foldl},c=function(n){return l(n)(e["||"](e.boolLikeBoolean))(!1)},f=new a(function(n){return function(r){return function(u){return o(f)(function(t){return function(u){return e["<>"](n["__superclass_Prelude.Semigroup_0"]())(r(t))(u)}})(t.mempty(n))(u)}}},function(n){return function(e){return function(t){return r(n)(e)(t)}}},function(r){return function(e){return function(t){return n(r)(e)(t)}}}),s=function(n){return n.foldMap},v=function(n){return function(r){return e["<<<"](e.semigroupoidArr)(c(f))(s(n)(t.monoidArray)(function(n){return[r(n)]}))}},_=function(n){return function(r){return e["<<<"](e.semigroupoidArr)(v(r))(e["=="](n))}},P=function(n){return l(n)(e["&&"](e.boolLikeBoolean))(!0)};return{Foldable:a,foldlArray:r,foldrArray:n,notElem:function(n){return function(r){return function(t){return e["<<<"](e.semigroupoidArr)(e.not(e.boolLikeBoolean))(_(n)(r)(t))}}},elem:_,product:function(n){return l(n)(e["*"](e.semiringNumber))(1)},sum:function(n){return l(n)(e["+"](e.semiringNumber))(0)},all:function(n){return function(r){return e["<<<"](e.semigroupoidArr)(P(f))(s(n)(t.monoidArray)(function(n){return[r(n)]}))}},any:v,or:c,and:P,mconcat:function(n){return function(r){return l(n)(e["<>"](r["__superclass_Prelude.Semigroup_0"]()))(t.mempty(r))}},for_:function(n){return function(r){return e.flip(i(n)(r))}},traverse_:i,foldMap:s,foldl:l,foldr:o,foldableArray:f}}(),(PS=PS||{}).Data_String=function(){"use strict";var n=(PS.Data_Function,PS.Data_Char,PS.Prelude,PS.Data_String_Unsafe,PS.Data_Maybe);return{drop:function(n){return function(r){return r.substr(n)}},take:function(n){return function(r){return r.substr(0,n)}},length:function(n){return n.length},indexOf:function(n){return function(r){return r.indexOf(n)}},charAt:function(r){return function(e){return t=r,u=e,a=n.Just.create,o=n.Nothing.value,t>=0&&t<u.length?a(u.charAt(t)):o;var t,u,a,o}}}}(),(PS=PS||{}).Data_Traversable=function(){"use strict";var n=PS.Prelude,r=PS.Data_Array,e=(PS.Data_Tuple,PS.Data_Either,PS.Data_Foldable),t=(PS.Data_Maybe,PS.Data_Monoid_Additive,PS.Data_Monoid_Dual,PS.Data_Monoid_First,PS.Data_Monoid_Last,PS.Data_Monoid_Multiplicative,function(n,r,e,t){this["__superclass_Data.Foldable.Foldable_1"]=n,this["__superclass_Prelude.Functor_0"]=r,this.sequence=e,this.traverse=t}),u=function(n){return n.traverse},a=function(n){return n.sequence},o=new t(function(){return e.foldableArray},function(){return r.functorArray},function(r){return function(e){if(0===e.length)return n.pure(r)([]);if(e.length>=1){var t=e.slice(1);return n["<*>"](r["__superclass_Prelude.Apply_0"]())(n["<$>"](r["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(n[":"])(e[0]))(a(o)(r)(t))}throw new Error("Failed pattern match")}},function(r){return function(e){return function(t){if(0===t.length)return n.pure(r)([]);if(t.length>=1){var a=t.slice(1);return n["<*>"](r["__superclass_Prelude.Apply_0"]())(n["<$>"](r["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(n[":"])(e(t[0])))(u(o)(r)(e)(a))}throw new Error("Failed pattern match")}}});return{Traversable:t,sequence:a,traverse:u,traversableArray:o}}(),(PS=PS||{}).Data_Map=function(){"use strict";var n=PS.Prelude,r=PS.Data_Foldable,e=PS.Data_Tuple,t=(PS.Data_Traversable,PS.Data_Array),u=PS.Data_Maybe,a=(PS.Data_Monoid,function(){function n(){}return n.value=new n,n}()),o=function(){function n(n,r,e,t){this.value0=n,this.value1=r,this.value2=e,this.value3=t}return n.create=function(r){return function(e){return function(t){return function(u){return new n(r,e,t,u)}}}},n}(),i=function(){function n(n,r,e,t,u,a,o){this.value0=n,this.value1=r,this.value2=e,this.value3=t,this.value4=u,this.value5=a,this.value6=o}return n.create=function(r){return function(e){return function(t){return function(u){return function(a){return function(o){return function(i){return new n(r,e,t,u,a,o,i)}}}}}}},n}(),l=function(){function n(n,r,e){this.value0=n,this.value1=r,this.value2=e}return n.create=function(r){return function(e){return function(t){return new n(r,e,t)}}},n}(),c=function(){function n(n,r,e){this.value0=n,this.value1=r,this.value2=e}return n.create=function(r){return function(e){return function(t){return new n(r,e,t)}}},n}(),f=function(){function n(n,r,e,t,u,a){this.value0=n,this.value1=r,this.value2=e,this.value3=t,this.value4=u,this.value5=a}return n.create=function(r){return function(e){return function(t){return function(u){return function(a){return function(o){return new n(r,e,t,u,a,o)}}}}}},n}(),s=function(){function n(n,r,e,t,u,a){this.value0=n,this.value1=r,this.value2=e,this.value3=t,this.value4=u,this.value5=a}return n.create=function(r){return function(e){return function(t){return function(u){return function(a){return function(o){return new n(r,e,t,u,a,o)}}}}}},n}(),v=function(){function n(n,r,e,t,u,a){this.value0=n,this.value1=r,this.value2=e,this.value3=t,this.value4=u,this.value5=a}return n.create=function(r){return function(e){return function(t){return function(u){return function(a){return function(o){return new n(r,e,t,u,a,o)}}}}}},n}(),_=function(){function n(n,r,e,t){this.value0=n,this.value1=r,this.value2=e,this.value3=t}return n.create=function(r){return function(e){return function(t){return function(u){return new n(r,e,t,u)}}}},n}(),P=function(r){if(r instanceof a)return[];if(r instanceof o)return n["++"](t.semigroupArray)(P(r.value0))(n["++"](t.semigroupArray)([r.value2])(P(r.value3)));if(r instanceof i)return n["++"](t.semigroupArray)(P(r.value0))(n["++"](t.semigroupArray)([r.value2])(n["++"](t.semigroupArray)(P(r.value3))(n["++"](t.semigroupArray)([r.value5])(P(r.value6)))));throw new Error("Failed pattern match")},p=function(r){if(r instanceof a)return[];if(r instanceof o)return n["++"](t.semigroupArray)(p(r.value0))(n["++"](t.semigroupArray)([new e.Tuple(r.value1,r.value2)])(p(r.value3)));if(r instanceof i)return n["++"](t.semigroupArray)(p(r.value0))(n["++"](t.semigroupArray)([new e.Tuple(r.value1,r.value2)])(n["++"](t.semigroupArray)(p(r.value3))(n["++"](t.semigroupArray)([new e.Tuple(r.value4,r.value5)])(p(r.value6)))));throw new Error("Failed pattern match")},d=function(r){return function(e){return function(t){for(var l=r,c=e,f=t;;){if(f instanceof a)return u.Nothing.value;if(f instanceof o&&n["=="](l["__superclass_Prelude.Eq_0"]())(c)(f.value1))return new u.Just(f.value2);if(f instanceof o&&n["<"](l)(c)(f.value1))l=l,c=c,f=f.value0;else if(f instanceof o){l=l,c=c,f=f.value3}else{if(f instanceof i&&n["=="](l["__superclass_Prelude.Eq_0"]())(c)(f.value1))return new u.Just(f.value2);if(f instanceof i&&n["=="](l["__superclass_Prelude.Eq_0"]())(c)(f.value4))return new u.Just(f.value5);if(f instanceof i&&n["<"](l)(c)(f.value1))l=l,c=c,f=f.value0;else if(f instanceof i&&n["<"](l)(f.value1)(c)&&n["<="](l)(c)(f.value4)){l=l,c=c,f=f.value3}else{if(!(f instanceof i))throw new Error("Failed pattern match");l=l,c=c,f=f.value6}}}}}},h=new n.Functor(function(r){return function(e){if(e instanceof a)return a.value;if(e instanceof o)return new o(n["<$>"](h)(r)(e.value0),e.value1,r(e.value2),n["<$>"](h)(r)(e.value3));if(e instanceof i)return new i(n["<$>"](h)(r)(e.value0),e.value1,r(e.value2),n["<$>"](h)(r)(e.value3),e.value4,r(e.value5),n["<$>"](h)(r)(e.value6));throw new Error("Failed pattern match")}}),S=function(n){return function(r){return function(e){var t=n,u=r,a=e;n:for(;;){if(0===u.length)return a;if(u.length>=1){var _=u.slice(1);if(u[0]instanceof l){var P=t,p=new o(a,u[0].value0,u[0].value1,u[0].value2);t=P,u=_,a=p;continue n}}if(u.length>=1){var d=u.slice(1);if(u[0]instanceof c){P=t,p=new o(u[0].value0,u[0].value1,u[0].value2,a);t=P,u=d,a=p;continue n}}if(u.length>=1){var h=u.slice(1);if(u[0]instanceof f){P=t,p=new i(a,u[0].value0,u[0].value1,u[0].value2,u[0].value3,u[0].value4,u[0].value5);t=P,u=h,a=p;continue n}}if(u.length>=1){var S=u.slice(1);if(u[0]instanceof s){P=t,p=new i(u[0].value0,u[0].value1,u[0].value2,a,u[0].value3,u[0].value4,u[0].value5);t=P,u=S,a=p;continue n}}if(u.length>=1){var w=u.slice(1);if(u[0]instanceof v){P=t,p=new i(u[0].value0,u[0].value1,u[0].value2,u[0].value3,u[0].value4,u[0].value5,a);t=P,u=w,a=p;continue n}}throw new Error("Failed pattern match")}}}},w=function(r){var e,t=function(n){return function(r){return function(e){var t=n,u=r,a=e;n:for(;;){if(0===u.length)return new o(a.value0,a.value1,a.value2,a.value3);if(u.length>=1){var P=u.slice(1);if(u[0]instanceof l)return S(t)(P)(new i(a.value0,a.value1,a.value2,a.value3,u[0].value0,u[0].value1,u[0].value2))}if(u.length>=1){var p=u.slice(1);if(u[0]instanceof c)return S(t)(p)(new i(u[0].value0,u[0].value1,u[0].value2,a.value0,a.value1,a.value2,a.value3))}if(u.length>=1){var d=u.slice(1);if(u[0]instanceof f){var h=t,w=new _(new o(a.value0,a.value1,a.value2,a.value3),u[0].value0,u[0].value1,new o(u[0].value2,u[0].value3,u[0].value4,u[0].value5));t=h,u=d,a=w;continue n}}if(u.length>=1){var m=u.slice(1);if(u[0]instanceof s){h=t,w=new _(new o(u[0].value0,u[0].value1,u[0].value2,a.value0),a.value1,a.value2,new o(a.value3,u[0].value3,u[0].value4,u[0].value5));t=h,u=m,a=w;continue n}}if(u.length>=1){var y=u.slice(1);if(u[0]instanceof v){h=t,w=new _(new o(u[0].value0,u[0].value1,u[0].value2,u[0].value3),u[0].value4,u[0].value5,new o(a.value0,a.value1,a.value2,a.value3));t=h,u=y,a=w;continue n}}throw new Error("Failed pattern match")}}}};return(e=r,function(r){return function(u){return function(P){return function(p){for(var d=e,h=r,w=u,m=P,y=p;;){if(y instanceof a)return t(d)(h)(new _(a.value,w,m,a.value));if(y instanceof o&&n["=="](d["__superclass_Prelude.Eq_0"]())(w)(y.value1))return S(d)(h)(new o(y.value0,w,m,y.value3));if(y instanceof o&&n["<"](d)(w)(y.value1))d=d,h=n[":"](new l(y.value1,y.value2,y.value3))(h),w=w,m=m,y=y.value0;else if(y instanceof o)d=d,h=n[":"](new c(y.value0,y.value1,y.value2))(h),w=w,m=m,y=y.value3;else{if(y instanceof i&&n["=="](d["__superclass_Prelude.Eq_0"]())(w)(y.value1))return S(d)(h)(new i(y.value0,w,m,y.value3,y.value4,y.value5,y.value6));if(y instanceof i&&n["=="](d["__superclass_Prelude.Eq_0"]())(w)(y.value4))return S(d)(h)(new i(y.value0,y.value1,y.value2,y.value3,w,m,y.value6));if(y instanceof i&&n["<"](d)(w)(y.value1))d=d,h=n[":"](new f(y.value1,y.value2,y.value3,y.value4,y.value5,y.value6))(h),w=w,m=m,y=y.value0;else if(y instanceof i&&n["<"](d)(y.value1)(w)&&n["<="](d)(w)(y.value4))d=d,h=n[":"](new s(y.value0,y.value1,y.value2,y.value4,y.value5,y.value6))(h),w=w,m=m,y=y.value3;else{if(!(y instanceof i))throw new Error("Failed pattern match");d=d,h=n[":"](new v(y.value0,y.value1,y.value2,y.value3,y.value4,y.value5))(h),w=w,m=m,y=y.value6}}}}}}})([])},m=function(r){return function(t){return new n.Eq(function(e){return function(u){return!n["=="](m(r)(t))(e)(u)}},function(u){return function(a){return n["=="](n.eqArray(e.eqTuple(r)(t)))(p(u))(p(a))}})}},y=a.value;return{values:P,member:function(n){return function(r){return function(e){return u.isJust(d(n)(r)(e))}}},delete:function(r){var e,t=function(n){return function(r){return function(e){var t=n,u=r,_=e;n:for(;;){if(0===u.length)return _;if(u.length>=1){var P=u.slice(1);if(u[0]instanceof l&&u[0].value2 instanceof a&&_ instanceof a)return S(t)(P)(new o(a.value,u[0].value0,u[0].value1,a.value))}if(u.length>=1){var p=u.slice(1);if(u[0]instanceof c&&u[0].value0 instanceof a&&_ instanceof a)return S(t)(p)(new o(a.value,u[0].value1,u[0].value2,a.value))}if(u.length>=1){var d=u.slice(1);if(u[0]instanceof l&&u[0].value2 instanceof o){var h=t,w=new i(_,u[0].value0,u[0].value1,u[0].value2.value0,u[0].value2.value1,u[0].value2.value2,u[0].value2.value3);t=h,u=d,_=w;continue n}}if(u.length>=1){var m=u.slice(1);if(u[0]instanceof c&&u[0].value0 instanceof o){h=t,w=new i(u[0].value0.value0,u[0].value0.value1,u[0].value0.value2,u[0].value0.value3,u[0].value1,u[0].value2,_),t=h,u=m,_=w;continue n}}if(u.length>=1){var y=u.slice(1);if(u[0]instanceof l&&u[0].value2 instanceof i)return S(t)(y)(new o(new o(_,u[0].value0,u[0].value1,u[0].value2.value0),u[0].value2.value1,u[0].value2.value2,new o(u[0].value2.value3,u[0].value2.value4,u[0].value2.value5,u[0].value2.value6)))}if(u.length>=1){var g=u.slice(1);if(u[0]instanceof c&&u[0].value0 instanceof i)return S(t)(g)(new o(new o(u[0].value0.value0,u[0].value0.value1,u[0].value0.value2,u[0].value0.value3),u[0].value0.value4,u[0].value0.value5,new o(u[0].value0.value6,u[0].value1,u[0].value2,_)))}if(u.length>=1){var A=u.slice(1);if(u[0]instanceof f&&u[0].value2 instanceof a&&u[0].value5 instanceof a&&_ instanceof a)return S(t)(A)(new i(a.value,u[0].value0,u[0].value1,a.value,u[0].value3,u[0].value4,a.value))}if(u.length>=1){var b=u.slice(1);if(u[0]instanceof s&&u[0].value0 instanceof a&&u[0].value5 instanceof a&&_ instanceof a)return S(t)(b)(new i(a.value,u[0].value1,u[0].value2,a.value,u[0].value3,u[0].value4,a.value))}if(u.length>=1){var T=u.slice(1);if(u[0]instanceof v&&u[0].value0 instanceof a&&u[0].value3 instanceof a&&_ instanceof a)return S(t)(T)(new i(a.value,u[0].value1,u[0].value2,a.value,u[0].value4,u[0].value5,a.value))}if(u.length>=1){var M=u.slice(1);if(u[0]instanceof f&&u[0].value2 instanceof o)return S(t)(M)(new o(new i(_,u[0].value0,u[0].value1,u[0].value2.value0,u[0].value2.value1,u[0].value2.value2,u[0].value2.value3),u[0].value3,u[0].value4,u[0].value5))}if(u.length>=1){var D=u.slice(1);if(u[0]instanceof s&&u[0].value0 instanceof o)return S(t)(D)(new o(new i(u[0].value0.value0,u[0].value0.value1,u[0].value0.value2,u[0].value0.value3,u[0].value1,u[0].value2,_),u[0].value3,u[0].value4,u[0].value5))}if(u.length>=1){var E=u.slice(1);if(u[0]instanceof s&&u[0].value5 instanceof o)return S(t)(E)(new o(u[0].value0,u[0].value1,u[0].value2,new i(_,u[0].value3,u[0].value4,u[0].value5.value0,u[0].value5.value1,u[0].value5.value2,u[0].value5.value3)))}if(u.length>=1){var C=u.slice(1);if(u[0]instanceof v&&u[0].value3 instanceof o)return S(t)(C)(new o(u[0].value0,u[0].value1,u[0].value2,new i(u[0].value3.value0,u[0].value3.value1,u[0].value3.value2,u[0].value3.value3,u[0].value4,u[0].value5,_)))}if(u.length>=1){var F=u.slice(1);if(u[0]instanceof f&&u[0].value2 instanceof i)return S(t)(F)(new i(new o(_,u[0].value0,u[0].value1,u[0].value2.value0),u[0].value2.value1,u[0].value2.value2,new o(u[0].value2.value3,u[0].value2.value4,u[0].value2.value5,u[0].value2.value6),u[0].value3,u[0].value4,u[0].value5))}if(u.length>=1){var $=u.slice(1);if(u[0]instanceof s&&u[0].value0 instanceof i)return S(t)($)(new i(new o(u[0].value0.value0,u[0].value0.value1,u[0].value0.value2,u[0].value0.value3),u[0].value0.value4,u[0].value0.value5,new o(u[0].value0.value6,u[0].value1,u[0].value2,_),u[0].value3,u[0].value4,u[0].value5))}if(u.length>=1){var L=u.slice(1);if(u[0]instanceof s&&u[0].value5 instanceof i)return S(t)(L)(new i(u[0].value0,u[0].value1,u[0].value2,new o(_,u[0].value3,u[0].value4,u[0].value5.value0),u[0].value5.value1,u[0].value5.value2,new o(u[0].value5.value3,u[0].value5.value4,u[0].value5.value5,u[0].value5.value6)))}if(u.length>=1){var N=u.slice(1);if(u[0]instanceof v&&u[0].value3 instanceof i)return S(t)(N)(new i(u[0].value0,u[0].value1,u[0].value2,new o(u[0].value3.value0,u[0].value3.value1,u[0].value3.value2,u[0].value3.value3),u[0].value3.value4,u[0].value3.value5,new o(u[0].value3.value6,u[0].value4,u[0].value5,_)))}throw new Error("Failed pattern match")}}}},u=function(r){return function(e){return function(u){for(var l=r,f=e,s=u;;){if(s instanceof o&&s.value0 instanceof a&&s.value3 instanceof a)return t(l)(f)(a.value);if(s instanceof o)l=l,f=n[":"](new c(s.value0,s.value1,s.value2))(f),s=s.value3;else{if(s instanceof i&&s.value0 instanceof a&&s.value3 instanceof a&&s.value6 instanceof a)return t(l)(n[":"](new c(a.value,s.value1,s.value2))(f))(a.value);if(!(s instanceof i))throw new Error("Failed pattern match");l=l,f=n[":"](new v(s.value0,s.value1,s.value2,s.value3,s.value4,s.value5))(f),s=s.value6}}}}},_=function(n){return function(r){for(var e=n,t=r;;){if(t instanceof o&&t.value3 instanceof a)return{key:t.value1,value:t.value2};if(t instanceof o)e=e,t=t.value3;else{if(t instanceof i&&t.value6 instanceof a)return{key:t.value4,value:t.value5};if(!(t instanceof i))throw new Error("Failed pattern match");e=e,t=t.value6}}}};return(e=r,function(r){return function(P){return function(p){var d=e,h=r,w=P,m=p;n:for(;;){if(m instanceof a)return S(d)(h)(a.value);if(m instanceof o&&m.value0 instanceof a&&m.value3 instanceof a&&n["=="](d["__superclass_Prelude.Eq_0"]())(w)(m.value1))return t(d)(h)(a.value);if(m instanceof o){if(n["=="](d["__superclass_Prelude.Eq_0"]())(w)(m.value1)){var y=_(d)(m.value0);return u(d)(n[":"](new l(y.key,y.value,m.value3))(h))(m.value0)}if(n["<"](d)(w)(m.value1)){d=d,h=n[":"](new l(m.value1,m.value2,m.value3))(h),w=w,m=m.value0;continue n}if(n.otherwise){d=d,h=n[":"](new c(m.value0,m.value1,m.value2))(h),w=w,m=m.value3;continue n}}if(m instanceof i&&m.value0 instanceof a&&m.value3 instanceof a&&m.value6 instanceof a){if(n["=="](d["__superclass_Prelude.Eq_0"]())(w)(m.value1))return S(d)(h)(new o(a.value,m.value4,m.value5,a.value));if(n["=="](d["__superclass_Prelude.Eq_0"]())(w)(m.value4))return S(d)(h)(new o(a.value,m.value1,m.value2,a.value))}if(m instanceof i){if(n["=="](d["__superclass_Prelude.Eq_0"]())(w)(m.value1))return y=_(d)(m.value0),u(d)(n[":"](new f(y.key,y.value,m.value3,m.value4,m.value5,m.value6))(h))(m.value0);if(n["=="](d["__superclass_Prelude.Eq_0"]())(w)(m.value4))return y=_(d)(m.value3),u(d)(n[":"](new s(m.value0,m.value1,m.value2,y.key,y.value,m.value6))(h))(m.value3);if(n["<"](d)(w)(m.value1)){d=d,h=n[":"](new f(m.value1,m.value2,m.value3,m.value4,m.value5,m.value6))(h),w=w,m=m.value0;continue n}if(n["<"](d)(m.value1)(w)&&n["<"](d)(w)(m.value4)){d=d,h=n[":"](new s(m.value0,m.value1,m.value2,m.value4,m.value5,m.value6))(h),w=w,m=m.value3;continue n}if(n.otherwise){d=d,h=n[":"](new v(m.value0,m.value1,m.value2,m.value3,m.value4,m.value5))(h),w=w,m=m.value6;continue n}}throw new Error("Failed pattern match")}}}})([])},fromList:function(n){return r.foldl(r.foldableArray)(function(r){return function(e){return w(n)(e.value0)(e.value1)(r)}})(y)},toList:p,lookup:d,insert:w,empty:y,eqMap:m,showMap:function(r){return function(t){return new n.Show(function(u){return"fromList "+n.show(n.showArray(e.showTuple(r)(t)))(p(u))})}},functorMap:h}}(),(PS=PS||{}).Data_Set=function(){"use strict";var n=PS.Prelude,r=PS.Data_Map,e=PS.Data_Array,t=PS.Data_Tuple,u=PS.Data_Foldable,a=(PS.Data_Array_ST,PS.Control_Monad_Rec_Class,PS.Control_Monad_Eff,PS.Control_Monad_ST,PS.Data_Either,PS.Data_Maybe,PS.Prelude_Unsafe,function(){function n(n){this.value0=n}return n.create=function(r){return new n(r)},n}()),o=function(e){return function(t){return function(u){return new a(r.insert(e)(t)(n.unit)(u.value0))}}},i=new a(r.empty);return{fromList:function(n){return u.foldl(u.foldableArray)(function(r){return function(e){return o(n)(e)(r)}})(i)},toList:function(n){return e.map(t.fst)(r.toList(n.value0))},delete:function(n){return function(e){return function(t){return new a(r.delete(n)(e)(t.value0))}}},member:function(n){return function(e){return function(t){return r.member(n)(e)(t.value0)}}},insert:o,empty:i,eqSet:function(e){return new n.Eq(function(t){return function(u){return n["/="](r.eqMap(e)(n.eqUnit))(t.value0)(u.value0)}},function(t){return function(u){return n["=="](r.eqMap(e)(n.eqUnit))(t.value0)(u.value0)}})}}}(),(PS=PS||{}).Math_Probability_Internal=function(){"use strict";var n=PS.Prelude,r=PS.$$Math,e=PS.Data_Foldable,t=PS.Data_Tuple,u=PS.Data_Array,a=(PS.Data_Map,PS.Data_Profunctor_Strong),o=(PS.Control_Arrow,PS.Data_Function,function(n){return n}),i=function(n){return n},l=n["<<<"](n.semigroupoidArr)(e.sum(e.foldableArray))(n["<$>"](u.functorArray)(t.snd)),c=new n.Show(function(r){return n.show(n.showNumber)(r)}),f=new n.Show(function(r){return"ProbList ("+n.show(n.showArray(c))(r)+")"}),s=new n.Functor(function(r){return function(e){return i(n["<$>"](u.functorArray)(a.first(a.strongArr)(r))(e))}}),v=function(n){return function(e){return r.abs(n-e)<5e-6}},_=n["<<<"](n.semigroupoidArr)(v(1))(l),P=new n.Apply(function(r){return function(e){return i(n[">>="](u.bindArray)(r)(function(r){return n[">>="](u.bindArray)(e)(function(e){return n.pure(u.applicativeArray)(new t.Tuple(r.value0(e.value0),r.value1*e.value1))})}))}},function(){return s}),p=new n.Bind(function(r){return function(e){return i(n[">>="](u.bindArray)(r)(function(r){return n[">>="](u.bindArray)(e(r.value0))(function(e){return n.pure(u.applicativeArray)(new t.Tuple(e.value0,r.value1*e.value1))})}))}},function(){return P}),d=new n.Applicative(function(){return P},function(r){return n["<<<"](n.semigroupoidArr)(i)(u.singleton)(new t.Tuple(r,1))});return{Dist:i,ProbList:function(n){return n},Prob:o,isValid:_,sumP:l,"<~":function(n){return function(r){return 5e-6>n-r}},"~~":v,epsilon:5e-6,functorDist:s,applyDist:P,applicativeDist:d,bindDist:p,showProb:c,showDist:function(r){return new n.Show(function(e){return"Dist "+n.show(n.showArray(t.showTuple(r)(n.showNumber)))(e)})},showProbList:f}}(),(PS=PS||{}).Math_Probability=function(){"use strict";var n=PS.Math_Probability_Internal,r=PS.Prelude,e=PS.Data_Foldable,t=PS.Data_Profunctor_Strong,u=PS.Data_Array,a=PS.Data_Tuple,o=(PS.$$Math,PS.Data_Monoid_All,PS.Data_Maybe),i=(PS.Data_Maybe_Unsafe,function(){function n(n,r){this.value0=n,this.value1=r}return n.create=function(r){return function(e){return new n(r,e)}},n}()),l=function(n){return n.value0},c=function(n){return n},f=function(n){return n},s=function(n){return n.value1},v=r["<<<"](r.semigroupoidArr)(r["<$>"](u.functorArray)(a.fst))(f),_=function(e){var a=r["<$>"](u.functorArray)(t.second(t.strongArr)(c))(e),i=n.isValid(a);if(i)return o.Just.create(a);if(!i)return o.Nothing.value;throw new Error("Failed pattern match")},P=function(e){var a=n.sumP(e);return _(r["<$>"](u.functorArray)(t.second(t.strongArr)(r["<<<"](r.semigroupoidArr)(n.Prob)(function(n){return n/a})))(e))},p=r["<<<"](r.semigroupoidArr)(P)(r["<$>"](u.functorArray)(function(n){return new a.Tuple(n,1)}));return{Iso:i,expected:function(n){return r["<<<"](r.semigroupoidArr)(s(n))(r["<<<"](r.semigroupoidArr)(e.sum(e.foldableArray))(r["<<<"](r.semigroupoidArr)(r["<$>"](u.functorArray)(function(r){return l(n)(r.value0)*r.value1}))(f)))},from:s,to:l,"??":function(e){return r["<<<"](r.semigroupoidArr)(n.Prob)(r["<<<"](r.semigroupoidArr)(n.sumP)(r["<<<"](r.semigroupoidArr)(u.filter(r["<<<"](r.semigroupoidArr)(e)(a.fst)))(f)))},just:function(n){return r["=="](n)},reshape:function(n){return r["<<<"](r.semigroupoidArr)(n)(v)},uniform:p,extract:v,distProbs:function(e){return n.ProbList(r["<$>"](u.functorArray)(r["<<<"](r.semigroupoidArr)(n.Prob)(a.snd))(e))},runDist:f,fromFreqs:P,zipDist:function(r){return function(e){return n.Dist(u.zipWith(function(n){return function(r){return new a.Tuple(n,r)}})(r)(e))}},dist:_,runProbList:function(n){return n},runProb:c,prob:function(e){if(n["<~"](0)(e)&&n["<~"](e)(1))return o.Just.create(e);if(r.otherwise)return o.Nothing.value;throw new Error("Failed pattern match")}}}(),(PS=PS||{}).Math_Probability_Information=function(){"use strict";var n=PS.Prelude,r=PS.Math_Probability,e=PS.$$Math,t=PS.Math_Probability_Internal,u=function(n){return n},a=function(n){return function(r){return e.log(r)/e.log(n)}},o=a(2),i=new r.Iso(function(n){return n},u),l=n["<<<"](n.semigroupoidArr)(r.from(i))(n["<<<"](n.semigroupoidArr)(n.negate(n.ringNumber))(n["<<<"](n.semigroupoidArr)(o)(r.runProb)));return{Entropy:u,selfInformation:l,logBase:a,log2:o,entropy:function(e){return function(u){return function(a){return r.expected(i)(n[">>="](t.bindDist)(u)(function(u){return n[">>="](t.bindDist)(a(u))(function(o){var i=r["??"](r.just(e)(o))(a(u));return n.pure(t.applicativeDist)(l(i))})}))}}},nonCond:function(r){return function(e){return r(n.pure(t.applicativeDist)(n.unit))(n.const(e))}},entropyNum:i}}(),(PS=PS||{}).Network_Types_Internal=function(){"use strict";var n=PS.Prelude,r=PS.Data_Maybe_Unsafe,e=PS.Data_Traversable,t=PS.Data_Array,u=PS.Data_Array_Unsafe,a=PS.Control_Monad_Error_Class,o=PS.Data_Set,i=PS.Data_Map,l=(PS.Data_Tuple,PS.Math_Probability,PS.Math_Probability_Internal),c=function(){function n(n,r){this.value0=n,this.value1=r}return n.create=function(r){return function(e){return new n(r,e)}},n}(),f=function(n){return n},s=function(){function n(n,r){this.value0=n,this.value1=r}return n.create=function(r){return function(e){return new n(r,e)}},n}(),v=function(){function n(n,r){this.value0=n,this.value1=r}return n.create=function(r){return function(e){return new n(r,e)}},n}(),_=function(){function n(n,r,e){this.value0=n,this.value1=r,this.value2=e}return n.create=function(r){return function(e){return function(t){return new n(r,e,t)}}},n}(),P=function(r){return 0===r.length?[]:r.length>=1&&(r.slice(1),0===r[0].length)?[]:n[":"](t.map(u.head)(r))(P(t.map(u.tail)(r)))},p=new n.Show(function(n){return n}),d=function(r){return n["<<<"](n.semigroupoidArr)(o.toList)(o.fromList(r))},h=function(n){return function(r){return new _(n,r.value0,r.value1)}};return{PmfError:f,Network:v,CondPMFN:s,CondPMF:_,Space:c,setNub:d,throwPmf:function(r){return n["<<<"](n.semigroupoidArr)(a.throwError(r))(f)},duplicate:function(n){return function(r){return t.length(r)!==t.length(d(n)(r))}},transpose:P,combos:function(r){return n["<<<"](n.semigroupoidArr)(e.sequence(e.traversableArray)(t.applicativeArray))(n["<<<"](n.semigroupoidArr)(n["<$>"](t.functorArray)(d(r)))(P))},netList:function(e){return function(u){return n["<$>"](t.functorArray)(function(t){return n["<<<"](n.semigroupoidArr)(h(t))(r.fromJust)(i.lookup(e)(t)(u.value0))})(u.value1)}},cp:h,cpn:function(n){return new s(n.value1,n.value2)},ordSet:function(r){return new n.Ord(function(){return o.eqSet(r["__superclass_Prelude.Eq_0"]())},function(e){return function(t){return n.compare(n.ordArray(r))(o.toList(e))(o.toList(t))}})},showSpace:function(r){return function(e){return new n.Show(function(t){return"Space ("+n.show(r)(t.value0)+") ("+n.show(n.showArray(e))(t.value1)+")"})}},showCond:function(r){return function(e){return function(t){return function(u){return new n.Show(function(a){return"CondPMF ("+n.show(r)(a.value0)+") ("+n.show(t)(a.value1)+") ("+n.show(i.showMap(u)(l.showDist(e)))(a.value2)+")"})}}}},showPmfError:p}}(),(PS=PS||{}).Network_Types=function(){"use strict";var n=PS.Prelude,r=PS.Math_Probability,e=PS.Network_Types_Internal,t=PS.Data_Array,u=PS.Data_Foldable,a=PS.Data_Map,o=PS.Data_Array_Unsafe,i=(PS.Data_Maybe_Unsafe,PS.Data_Maybe),l=(PS.Control_Bind,PS.Control_Monad_Error_Class,PS.Data_Set,PS.Data_Traversable,PS.Data_Tuple),c=PS.Math_Probability_Internal,f=function(n){this.space=n},s=function(n){return n.value0},v=function(n){return n.value1},_=new n.Show(function(r){return"Variable "+n.show(n.showString)(r)}),P=new f(function(r){return function(t){return function(u){return function(a){return 0===a.length?e.throwPmf(r)("No states provided for "+n.show(_)(u)):n.pure(t["__superclass_Prelude.Applicative_0"]())(new e.Space(u,a))}}}}),p=new n.Show(function(r){return"State "+n.show(n.showString)(r)}),d=e.netList,h=function(r){return function(t){return function(u){return n["<$>"](i.functorMaybe)(e.cp(t))(a.lookup(r)(t)(u.value0))}}},S=new n.Eq(function(r){return function(e){return!n["=="](S)(r)(e)}},function(n){return function(r){return n===r}}),w=new n.Ord(function(){return S},function(r){return function(e){return n.compare(n.ordString)(r)(e)}}),m=new n.Eq(function(r){return function(e){return!n["=="](m)(r)(e)}},function(n){return function(r){return n===r}}),y=new n.Ord(function(){return m},function(r){return function(e){return n.compare(n.ordString)(r)(e)}}),g=new f(function(r){return function(u){return function(a){return function(o){if(0===o.length)return e.throwPmf(r)("No states provided for "+n.show(n.showArray(_))(a));if(t.length(o)!==t.length(e.combos(y)(o)))return e.throwPmf(r)("Non-exhaustive list of [State] for "+n.show(n.showArray(_))(a)+": "+n.show(n.showArray(n.showArray(p)))(o));if(n.otherwise)return n.pure(u["__superclass_Prelude.Applicative_0"]())(new e.Space(a,o));throw new Error("Failed pattern match")}}}}),A=function(n){return n.value0};return{State:function(n){return n},Variable:function(n){return n},Spacy:f,netPmfAlter:function(r){return function(t){return function(u){return function(o){return i.maybe(o)(n["<<<"](n.semigroupoidArr)(n.flip(e.Network.create)(o.value1))(n["<<<"](n.semigroupoidArr)(n.flip(a.insert(r)(u))(o.value0))(n["<<<"](n.semigroupoidArr)(e.cpn)(t))))(h(r)(u)(o))}}}},condPmfMap:function(r){return function(t){return e.CondPMF.create(t.value0)(t.value1)(n["<$>"](a.functorMap)(r)(t.value2))}},netList:d,lookup:h,network:function(r){return function(u){return function(o){return function(i){return function(c){return function(f){return function(s){return function(v){if(t.null(v))return e.throwPmf(r)("No CondPMF when constructing Network");if(e.duplicate(o)(n["<$>"](t.functorArray)(A)(v)))return e.throwPmf(r)("Duplicated variable when constructing Network: "+n.show(n.showArray(e.showCond(i)(c)(f)(s)))(v));if(n.otherwise)return n.pure(u["__superclass_Prelude.Applicative_0"]())(new e.Network(a.fromList(o)(n["<$>"](t.functorArray)(function(n){return l.Tuple.create(n.value0)(new e.CondPMFN(n.value1,n.value2))})(v)),n["<$>"](t.functorArray)(A)(v)));throw new Error("Failed pattern match")}}}}}}}},condMap:function(n){return n.value2},condDeps:function(n){return n.value1},condMainSpace:function(t){return n["<<<"](n.semigroupoidArr)(e.Space.create(t.value0))(n["<<<"](n.semigroupoidArr)(r.extract)(o.head))(a.values(t.value2))},condMain:A,condPmf:function(o){return function(i){return function(f){return function(_){return function(P){return function(p){return function(d){return function(h){return function(S){return function(w){if(t.length(v(S))!==t.length(w)||(m=t.length(v(h)),!u.all(u.foldableArray)(function(n){return t.length(r.runProbList(n))===m})(w)))return e.throwPmf(o)("Probabilities don't have same shape as state space: "+n.show(e.showSpace(_)(P))(h)+"\n"+n.show(e.showSpace(p)(d))(S)+"\n"+n.show(n.showArray(c.showProbList))(w));var m;if(n.otherwise)return n["<<<"](n.semigroupoidArr)(n.pure(i["__superclass_Prelude.Applicative_0"]()))(n["<<<"](n.semigroupoidArr)(e.CondPMF.create(s(h))(s(S)))(a.fromList(f)))(t.zipWith(function(n){return function(e){return l.Tuple.create(n)(r.zipDist(v(h))(e))}})(v(S))(w));throw new Error("Failed pattern match")}}}}}}}}}},spaceVar:s,spaceStates:v,space:function(n){return n.space},spacyVarState:P,spacyVarsStates:g,eqVariable:S,ordVariable:w,showVariable:_,eqState:m,ordState:y,showState:p}}(),(PS=PS||{}).Network=function(){"use strict";var n=PS.Data_Array,r=PS.Prelude,e=PS.Math_Probability,t=PS.Math_Probability_Information,u=PS.Network_Types,a=PS.Data_Tuple,o=PS.Data_Maybe_Unsafe,i=PS.Data_Foldable,l=PS.Control_Arrow,c=PS.Data_Set,f=PS.Data_Traversable,s=PS.Control_Bind,v=(PS.Control_Monad_Error_Class,PS.Data_Array_Unsafe,PS.Data_Either,PS.Data_Function,PS.Data_Map),_=PS.Data_Maybe,P=PS.Network_Types_Internal,p=function(n){return function(t){return function(a){return i.foldl(i.foldableArray)(r.flip(u.netPmfAlter(n)(u.condPmfMap(r["<<<"](r.semigroupoidArr)(o.fromJust)(e.reshape(e.uniform))))))(a)(t)}}},d=function(e){return function(t){return r["<<<"](r.semigroupoidArr)(c.fromList(P.ordSet(a.ordTuple(e)(t))))(r["<<<"](r.semigroupoidArr)(r["<$>"](n.functorArray)(c.fromList(a.ordTuple(e)(t))))(r["<<<"](r.semigroupoidArr)(f.sequence(f.traversableArray)(n.applicativeArray))(r["<<<"](r.semigroupoidArr)(r["<$>"](n.functorArray)(r["<<<"](r.semigroupoidArr)(function(e){return r["<$>"](n.functorArray)(a.Tuple.create(u.spaceVar(e)))(u.spaceStates(e))})(u.condMainSpace)))(u.netList(e)))))}},h=function(t){return function(u){return function(a){return function(i){return r["<<<"](r.semigroupoidArr)(o.fromJust)(e.dist)(r["<$>"](n.functorArray)(l["&&&"](l.arrowFunction)(r.id(r.categoryArr))(a(i)))(c.toList(d(t)(u)(i))))}}}},S=function(r){var e=n.init(r);if(e instanceof _.Nothing)return[[]];if(e instanceof _.Just)return n.snoc(S(e.value0))(r);throw new Error("Failed pattern match")},w=function(n){return function(t){return function(a){return function(o){return function(i){return function(l){return function(c){return r[">>="](_.bindMaybe)(u.lookup(n)(o)(c))(function(n){return r["<$>"](_.functorMaybe)(e["??"](e.just(t)(l)))(v.lookup(a)(i(n))(u.condMap(n)))})}}}}}}};return{fullLookup:w,comboProb:function(t){return function(o){return function(l){return function(v){return s["=<<"](_.bindMaybe)(r["<<<"](r.semigroupoidArr)(e.prob)(i.product(i.foldableArray)))(f.traverse(f.traversableArray)(_.applicativeMaybe)(function(i){return r["<$>"](_.functorMaybe)(e.runProb)(w(t)(o["__superclass_Prelude.Eq_0"]())(r.ordArray(o))(a.fst(i))((f=c.delete(a.ordTuple(t)(o))(i)(v),function(e){return r["<$>"](n.functorArray)(a.snd)(n.filter(r["<<<"](r.semigroupoidArr)(r.flip(c.member(t))(c.fromList(t)(u.condDeps(e))))(a.fst))(c.toList(f)))}))(a.snd(i))(l));var f})(c.toList(v)))}}}},netCombos:d,netDist:h,uniformize:p,netScores:function(i){return function(l){return function(f){return function(s){var v=r["<$>"](n.functorArray)(u.condMain)(u.netList(i)(s)),_=r["<$>"](n.functorArray)(r["<<<"](r.semigroupoidArr)(e.to(t.entropyNum))(r["<<<"](r.semigroupoidArr)(t.nonCond(t.entropy(c.eqSet(a.eqTuple(i["__superclass_Prelude.Eq_0"]())(l["__superclass_Prelude.Eq_0"]())))))(r["<<<"](r.semigroupoidArr)(h(i)(l)(f))(r.flip(p(i))(s)))))(S(v));return a.zip(v)(n.zipWith(function(n){return function(r){return e.from(t.entropyNum)(n-r)}})(o.fromJust(n.tail(_)))(_))}}}},inits:S}}(),(PS=PS||{}).Text_Parsing_Parser=function(){"use strict";var n=PS.Prelude,r=(PS.Data_Identity,PS.Data_Either),e=(PS.Data_Maybe,PS.Data_Monoid,PS.Data_Tuple,PS.Control_Alt),t=PS.Control_Alternative,u=PS.Control_Lazy,a=(PS.Control_Monad,PS.Control_Monad_Trans),o=(PS.Control_Monad_State_Class,PS.Control_Monad_State_Trans,PS.Control_Monad_Error),i=(PS.Control_Monad_Error_Class,PS.Control_Monad_Error_Trans,PS.Control_MonadPlus,PS.Control_Plus),l=function(){function n(n){this.value0=n}return n.create=function(r){return new n(r)},n}(),c=function(n){return n},f=function(n){return n},s=new n.Show(function(n){return"ParseError { message: "+n.value0.message+" }"}),v=new a.MonadTrans(function(e){return function(t){return c(function(u){return n["<$>"](e["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(function(n){return{input:u,consumed:!1,result:new r.Right(n)}})(t)})}}),_=new u.Lazy1(function(r){return c(function(e){return f(r(n.unit))(e)})}),P=function(e){return new n.Functor(function(t){return function(u){var a=function(e){return{input:e.input,result:n["<$>"](r.functorEither)(t)(e.result),consumed:e.consumed}};return c(function(r){return n["<$>"](e)(a)(f(u)(r))})}})},p=function(e){return function(t){return c(function(u){return n.return(e)({input:u,consumed:!1,result:new r.Left(new l({message:t}))})})}},d=new o.Error(new l({message:""}),function(n){return new l({message:n})}),h=function(r){return new n.Monad(function(){return m(r)},function(){return S(r)})},S=function(e){return new n.Bind(function(t){return function(u){return c(function(a){return n[">>="](e["__superclass_Prelude.Bind_1"]())(f(t)(a))(function(t){if(t.result instanceof r.Left)return n.return(e)({input:t.input,result:new r.Left(t.result.value0),consumed:t.consumed});if(t.result instanceof r.Right)return n["<$>"](e["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())((a=t.consumed,function(n){return{input:n.input,consumed:a||n.consumed,result:n.result}}))(f(u(t.result.value0))(t.input));var a;throw new Error("Failed pattern match")})})}},function(){return w(e)})},w=function(r){return new n.Apply(n.ap(h(r)),function(){return P(r["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())})},m=function(e){return new n.Applicative(function(){return w(e)},function(t){return c(function(u){return n.pure(e["__superclass_Prelude.Applicative_0"]())({input:u,result:new r.Right(t),consumed:!1})})})},y=function(t){return new e.Alt(function(e){return function(u){return c(function(a){return n[">>="](t["__superclass_Prelude.Bind_1"]())(f(e)(a))(function(e){return e.result instanceof r.Left&&!e.consumed?f(u)(a):n.return(t)(e)})})}},function(){return P(t["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())})},g=function(n){return new i.Plus(function(){return y(n)},p(n)("No alternative"))};return{ParserT:c,ParseError:l,fail:p,runParserT:function(r){return function(e){return function(t){return n[">>="](r["__superclass_Prelude.Bind_1"]())(f(t)(e))(function(e){return n.return(r)(e.result)})}}},unParserT:f,errorParseError:d,showParseError:s,functorParserT:P,applyParserT:w,applicativeParserT:m,altParserT:y,plusParserT:g,alternativeParserT:function(n){return new t.Alternative(function(){return g(n)},function(){return m(n)})},bindParserT:S,monadParserT:h,monadTransParserT:v,lazy1ParserT:_}}(),(PS=PS||{}).Text_Parsing_Parser_Combinators=function(){"use strict";var n=PS.Control_Alt,r=PS.Text_Parsing_Parser,e=PS.Prelude,t=(PS.Control_Alternative,PS.Control_Apply,PS.Data_Maybe,PS.Data_Array,PS.Data_Tuple,PS.Data_Either),u=(PS.Control_Lazy,PS.Control_Monad,PS.Control_Monad_Error_Trans,PS.Control_Monad_Error_Class,PS.Control_Monad_State_Trans,PS.Control_Monad_State_Class,function(n){return function(u){return r.ParserT(function(a){return e["<$>"](n)((o=a,function(n){return n.result instanceof t.Left?{input:o,result:n.result,consumed:!1}:n}))(r.unParserT(u)(a));var o})}}),a=function(t){return function(u){return function(a){var o=n["<|>"](r.altParserT(t))(e[">>="](r.bindParserT(t))(a)(function(){return e.return(r.monadParserT(t))([])}))(e[">>="](r.bindParserT(t))(u)(function(n){return e[">>="](r.bindParserT(t))(o)(function(u){return e.return(r.monadParserT(t))(e[":"](n)(u))})}));return o}}};return{many1Till:function(n){return function(t){return function(u){return e[">>="](r.bindParserT(n))(t)(function(o){return e[">>="](r.bindParserT(n))(a(n)(t)(u))(function(t){return e.return(r.monadParserT(n))(e[":"](o)(t))})})}}},manyTill:a,lookAhead:function(n){return function(r){return function(t){return e[">>="](n["__superclass_Prelude.Bind_1"]())(r(t))(function(r){return e.return(n)(function(){var n={};for(var e in r)r.hasOwnProperty(e)&&(n[e]=r[e]);return n.input=t,n.consumed=!1,n}())})}}},try:u}}(),(PS=PS||{}).Text_Parsing_Parser_String=function(){"use strict";var n=PS.Prelude,r=PS.Control_Monad_Error,e=PS.Data_String,t=PS.Data_Char,u=PS.Text_Parsing_Parser_Combinators,a=PS.Text_Parsing_Parser,o=PS.Control_Alternative,i=PS.Control_Alt,l=PS.Data_Foldable,c=PS.Data_Either,f=PS.Data_Monoid,s=PS.Data_Maybe,v=(PS.Control_Monad_Error_Class,PS.Control_Monad_State_Class,function(t){return function(u){return a.ParserT(function(o){return n.return(t)(0===e.indexOf(u)(o)?{consumed:!0,input:e.drop(e.length(u))(o),result:new c.Right(u)}:{consumed:!1,input:o,result:new c.Left(r.strMsg(a.errorParseError)("Expected "+n.show(n.showString)(u)))})})}}),_=function(u){return a.ParserT(function(o){return n.return(u)(function(){var n=e.charAt(0)(o);if(n instanceof s.Nothing)return{consumed:!1,input:o,result:new c.Left(r.strMsg(a.errorParseError)("Unexpected EOF"))};if(n instanceof s.Just)return{consumed:!0,input:e.drop(1)(o),result:new c.Right(t.charString(n.value0))};throw new Error("Failed pattern match")}())})},P=function(r){return function(e){return u.try(r["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(n[">>="](a.bindParserT(r))(_(r))(function(t){var u=e(t);if(u)return n.return(a.monadParserT(r))(t);if(!u)return a.fail(r)("Character did not satisfy predicate");throw new Error("Failed pattern match")}))}};return{noneOf:function(r){return function(e){return P(r)(n.flip(l.notElem(n.eqString)(l.foldableArray))(e))}},whiteSpace:function(r){return n[">>="](a.bindParserT(r))(o.many(a.alternativeParserT(r))(a.lazy1ParserT)(i["<|>"](a.altParserT(r))(i["<|>"](a.altParserT(r))(i["<|>"](a.altParserT(r))(v(r)("\n"))(v(r)("\r")))(v(r)(" ")))(v(r)("\t"))))(function(e){return n.return(a.monadParserT(r))(l.foldMap(l.foldableArray)(f.monoidString)(n.id(n.categoryArr))(e))})},satisfy:P,char:_,string:v,eof:function(e){return a.ParserT(function(t){return n.return(e)(""===t?{consumed:!1,input:t,result:new c.Right(n.unit)}:{consumed:!1,input:t,result:new c.Left(r.strMsg(a.errorParseError)("Expected EOF"))})})}}}(),(PS=PS||{}).Network_Parser=function(){"use strict";function n(n){var r=parseFloat(n);return NaN===r?l.Nothing.value:l.Just.create(r)}var r=PS.Prelude,e=PS.Text_Parsing_Parser_String,t=PS.Control_Alternative,u=PS.Data_Foldable,a=PS.Control_Alt,o=PS.Text_Parsing_Parser_Combinators,i=PS.Control_Monad_Trans,l=PS.Data_Maybe,c=PS.Network_Types_Internal,f=PS.Control_Bind,s=PS.Math_Probability,v=PS.Network_Types,_=PS.Data_Tuple,P=PS.Data_Array_Unsafe,p=(PS.Control_Monad_Error_Class,PS.Text_Parsing_Parser),d=PS.Data_Monoid,h=PS.Math_Probability_Internal,S=PS.Data_Array,w=function(n){return function(e){return function(t){return r[">>="](n["__superclass_Prelude.Bind_1"]())(e)(function(){return t})}}},m=function(n){return r["<$>"](p.functorParserT(n["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]()))(u.mconcat(u.foldableArray)(d.monoidString))(t.some(p.alternativeParserT(n))(p.lazy1ParserT)(e.noneOf(n)(["\n","\r","\t"," ",""])))},y=function(n){return r["<$>"](p.functorParserT(n["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]()))(v.State)(m(n))},g=function(e){return function(t){return r[">>="](p.bindParserT(t))(m(t))(function(u){return r["<<<"](r.semigroupoidArr)(i.lift(p.monadTransParserT)(t))(l.maybe(c.throwPmf(e)("Couldn't parse as probability: "+u))(r.pure(t["__superclass_Prelude.Applicative_0"]())))(f["=<<"](l.bindMaybe)(s.prob)(n(u)))})}},A=function(n){return r["<$>"](p.functorParserT(n["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]()))(v.Variable)(m(n))},b=function(n){return a["<|>"](p.altParserT(n))(e.string(n)(" "))(e.string(n)("\t"))},T=function(n){return function(e){return r[">>="](p.bindParserT(e))(y(e))(function(u){return r[">>="](p.bindParserT(e))(t.some(p.alternativeParserT(e))(p.lazy1ParserT)(b(e)))(function(){return r[">>="](p.bindParserT(e))(g(n)(e))(function(n){return r.pure(p.applicativeParserT(e))(new _.Tuple(u,n))})})})}},M=function(n){return r[">>="](p.bindParserT(n))(m(n))(function(e){return r[">>="](p.bindParserT(n))(t.many(p.alternativeParserT(n))(p.lazy1ParserT)(b(n)))(function(){return r.pure(p.applicativeParserT(n))(e)})})},D=function(n){return r[">>="](p.bindParserT(n))(e.string(n)("----"))(function(){return r[">>="](p.bindParserT(n))(t.many(p.alternativeParserT(n))(p.lazy1ParserT)(e.string(n)("-")))(function(){return r.pure(p.applicativeParserT(n))(r.unit)})})},E=function(n){return function(u){return r[">>="](p.bindParserT(u))(e.string(u)("|"))(function(){return r[">>="](p.bindParserT(u))(t.some(p.alternativeParserT(u))(p.lazy1ParserT)(b(u)))(function(){return T(n)(u)})})}},C=function(n){return function(u){return r[">>="](p.bindParserT(u))(t.some(p.alternativeParserT(u))(p.lazy1ParserT)(r[">>="](p.bindParserT(u))(E(n)(u))(function(n){return r[">>="](p.bindParserT(u))(e.whiteSpace(u))(function(){return r.pure(p.applicativeParserT(u))(n)})})))(function(e){return r["<<<"](r.semigroupoidArr)(i.lift(p.monadTransParserT)(u))(l.maybe(c.throwPmf(n)("Couldn't construct distribution: "+r.show(r.showArray(_.showTuple(v.showState)(h.showProb)))(e)))(r.pure(u["__superclass_Prelude.Applicative_0"]())))(s.dist(e))})}},F=function(n){return o.manyTill(n)(r["<$>"](p.functorParserT(n["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]()))(v.State)(M(n)))(o.lookAhead(n)(e.string(n)("|")))},$=function(n){return o.manyTill(n)(r["<$>"](p.functorParserT(n["__superclass_Prelude.Applicative_0"]()["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]()))(v.Variable)(M(n)))(e.string(n)("|"))},L=function(n){return r[">>="](p.bindParserT(n))($(n))(function(u){return r[">>="](p.bindParserT(n))(t.some(p.alternativeParserT(n))(p.lazy1ParserT)(b(n)))(function(){return r[">>="](p.bindParserT(n))(A(n))(function(a){return r[">>="](p.bindParserT(n))(t.some(p.alternativeParserT(n))(p.lazy1ParserT)(b(n)))(function(){return r[">>="](p.bindParserT(n))(e.string(n)("P"))(function(){return r.pure(p.applicativeParserT(n))(new _.Tuple(u,a))})})})})})},N=function(n){return function(e){return r[">>="](p.bindParserT(e))(F(e))(function(t){return r[">>="](p.bindParserT(e))(C(n)(e))(function(n){return r.pure(p.applicativeParserT(e))(new _.Tuple(t,n))})})}},q=function(n){return function(t){return r[">>="](p.bindParserT(t))(e.whiteSpace(t))(function(){return r[">>="](p.bindParserT(t))(L(t))(function(u){return r[">>="](p.bindParserT(t))(w(p.monadParserT(t))(w(p.monadParserT(t))(e.whiteSpace(t))(D(t)))(e.whiteSpace(t)))(function(){return r[">>="](p.bindParserT(t))(o.many1Till(t)(N(n)(t))(a["<|>"](p.altParserT(t))(D(t))(e.eof(t))))(function(e){return i.lift(p.monadTransParserT)(t)(r[">>="](t["__superclass_Prelude.Bind_1"]())(r["<<<"](r.semigroupoidArr)(v.space(v.spacyVarState)(n)(t)(u.value1))(r["<<<"](r.semigroupoidArr)(s.extract)(_.snd))(P.head(e)))(function(a){return r[">>="](t["__superclass_Prelude.Bind_1"]())(v.space(v.spacyVarsStates)(n)(t)(u.value0)(r["<$>"](S.functorArray)(_.fst)(e)))(function(u){return v.condPmf(n)(t)(r.ordArray(v.ordState))(v.showVariable)(v.showState)(r.showArray(v.showVariable))(r.showArray(v.showState))(a)(u)(r["<$>"](S.functorArray)(r["<<<"](r.semigroupoidArr)(s.distProbs)(_.snd))(e))})}))})})})})}};return{readNumber:n,networkP:function(n){return function(u){return r[">>="](p.bindParserT(u))(e.whiteSpace(u))(function(){return r[">>="](p.bindParserT(u))(D(u))(function(){return r[">>="](p.bindParserT(u))(t.some(p.alternativeParserT(u))(p.lazy1ParserT)(q(n)(u)))(function(e){return i.lift(p.monadTransParserT)(u)(v.network(n)(u)(v.ordVariable)(v.showVariable)(v.showState)(r.showArray(v.showVariable))(r.showArray(v.showState))(e))})})})}},condPmfP:q,casePmfP:N,distP:C,distEleP:E,outcomeP:T,probP:g,stateP:y,depsP:F,headerP:L,mainVarP:A,depVarsP:$,">>":w,inlineSpace:b,wordSpace:M,word:m,hRuleP:D}}(),(PS=PS||{}).Main=function(){"use strict";var n=PS.Prelude,r=PS.Control_Monad_JQuery,e=PS.Data_Foldable,t=PS.Data_String,u=PS.Data_Tuple,a=PS.Text_Parsing_Parser,o=PS.Data_Either_Unsafe,i=PS.Data_Foreign,l=PS.Network_Parser,c=PS.Network,f=PS.Data_Maybe_Unsafe,s=PS.Control_Monad_Eff,v=PS.Data_Either,_=(PS.Data_Set,PS.Debug_Trace,PS.DOM,PS.Network_Types),P=(PS.Math_Probability_Information,PS.Control_Monad_Error_Class),p=PS.Network_Types_Internal,d=a.runParserT(v.monadEither),h=function(n){return function(){var t=r.create("<thead>")(),u=r.create("<tr>")(),a=r.create("<th>")();return r.appendText("Variable")(a)(),r.append(a)(u)(),e.for_(s.applicativeEff)(e.foldableArray)(n)(function(n){return function(){var e=r.create("<th>")();return r.appendText(n)(e)(),r.append(e)(u)()}})(),r.append(u)(t)()}},S=function(u){return function(){var a=r.create("<tbody>")(),o=r.create("<tr>")(),i=r.create("<td>")();return r.appendText("Score")(i)(),r.append(i)(o)(),e.for_(s.applicativeEff)(e.foldableArray)(u)(function(e){return function(){var u=r.create("<td>")();return r.appendText(t.take(6)(n.show(n.showNumber)(e)))(u)(),r.append(u)(o)()}})(),r.append(o)(a)()}},w=function(n){return function(){var e,t=r.create("<table>")();return(e=u.unzip(n),function(){var n=h(u.fst(e))(),a=S(u.snd(e))();return r.append(n)(t)(),r.append(a)(t)()})()}},m=function(){var e,t=r.select(".net > div > textarea")(),u=n["<$>"](s.functorEff)(n["<<<"](n.semigroupoidArr)(o.fromRight)(i.readString))(r.getValue(t))();return(e=d(u)(l.networkP(P.monadErrorError)(v.monadEither)),function(){var t=r.select(".net > div > output")();if(r.clear(t)(),e instanceof v.Left)return r.appendText(n.show(p.showPmfError)(e.value0))(t)();if(e instanceof v.Right){if(e.value0 instanceof v.Left)return r.appendText(n.show(a.showParseError)(e.value0.value0))(t)();if(e.value0 instanceof v.Right)return n[">>="](s.bindEff)(w(c.netScores(_.ordVariable)(_.ordState)(function(r){return n["<<<"](n.semigroupoidArr)(f.fromJust)(c.comboProb(_.ordVariable)(_.ordState)(r))})(e.value0.value0)))(n.flip(r.append)(t))();throw new Error("Failed pattern match")}throw new Error("Failed pattern match")})()};return{main:r.ready(function(){var n=r.select(".net > button")();return m(),r.on("click")(function(){return function(){return m}})(n)()}),process:m,"runParserT'":d,table:w,body:S,header:h}}(),PS.Main.main();
