this.j$=this.jStat=function(n,t){function r(t,r){var e=t>r?t:r;return n.pow(10,17-~~(n.log(e>0?e:-e)*n.LOG10E))}function e(n){return"[object Function]"===s.call(n)}function o(n){return"number"==typeof n&&n==n}function i(){return new i._init(arguments)}function u(){return 0}function a(){return 1}function f(n,t){return n===t?1:0}var c=Array.prototype.concat,l=Array.prototype.slice,s=Object.prototype.toString,m=Array.isArray||function(n){return"[object Array]"===s.call(n)};i.fn=i.prototype,i._init=function(n){var t;if(m(n[0]))if(m(n[0][0])){for(e(n[1])&&(n[0]=i.map(n[0],n[1])),t=0;t<n[0].length;t++)this[t]=n[0][t];this.length=n[0].length}else this[0]=e(n[1])?i.map(n[0],n[1]):n[0],this.length=1;else if(o(n[0]))this[0]=i.seq.apply(null,n),this.length=1;else{if(n[0]instanceof i)return i(n[0].toArray());this[0]=[],this.length=1}return this},i._init.prototype=i.prototype,i._init.constructor=i,i.utils={calcRdx:r,isArray:m,isFunction:e,isNumber:o,toVector:function(n){return c.apply([],n)}},i.extend=function(n){var t,r;if(1===arguments.length){for(r in n)i[r]=n[r];return this}for(t=1;t<arguments.length;t++)for(r in arguments[t])n[r]=arguments[t][r];return n},i.rows=function(n){return n.length||1},i.cols=function(n){return n[0].length||1},i.dimensions=function(n){return{rows:i.rows(n),cols:i.cols(n)}},i.row=function(n,t){return n[t]},i.col=function(n,t){for(var r=new Array(n.length),e=0;e<n.length;e++)r[e]=[n[e][t]];return r},i.diag=function(n){for(var t=i.rows(n),r=new Array(t),e=0;e<t;e++)r[e]=[n[e][e]];return r},i.antidiag=function(n){for(var t=i.rows(n)-1,r=new Array(t),e=0;t>=0;t--,e++)r[e]=[n[e][t]];return r},i.transpose=function(n){var t,r,e,o,i,u=[];for(m(n[0])||(n=[n]),r=n.length,e=n[0].length,i=0;i<e;i++){for(t=new Array(r),o=0;o<r;o++)t[o]=n[o][i];u.push(t)}return 1===u.length?u[0]:u},i.map=function(n,t,r){var e,o,i,u,a;for(m(n[0])||(n=[n]),o=n.length,i=n[0].length,u=r?n:new Array(o),e=0;e<o;e++)for(u[e]||(u[e]=new Array(i)),a=0;a<i;a++)u[e][a]=t(n[e][a],e,a);return 1===u.length?u[0]:u},i.alter=function(n,t){return i.map(n,t,!0)},i.create=function(n,t,r){var o,i,u=new Array(n);for(e(t)&&(r=t,t=n),o=0;o<n;o++)for(u[o]=new Array(t),i=0;i<t;i++)u[o][i]=r(o,i);return u},i.zeros=function(n,t){return o(t)||(t=n),i.create(n,t,u)},i.ones=function(n,t){return o(t)||(t=n),i.create(n,t,a)},i.rand=function(t,r){return o(r)||(r=t),i.create(t,r,n.random)},i.identity=function(n,t){return o(t)||(t=n),i.create(n,t,f)},i.symmetric=function(n){var t,r,e=n.length;if(n.length!==n[0].length)return!1;for(t=0;t<e;t++)for(r=0;r<e;r++)if(n[r][t]!==n[t][r])return!1;return!0},i.clear=function(n){return i.alter(n,u)},i.seq=function(n,t,o,i){e(i)||(i=!1);var u,a=[],f=r(n,t),c=(t*f-n*f)/((o-1)*f),l=n;for(u=0;l<=t;l=(n*f+c*f*++u)/f)a.push(i?i(l,u):l);return a};var p=i.prototype;return p.length=0,p.push=Array.prototype.push,p.sort=Array.prototype.sort,p.splice=Array.prototype.splice,p.slice=Array.prototype.slice,p.toArray=function(){return this.length>1?l.call(this):l.call(this)[0]},p.map=function(n,t){return i(i.map(this,n,t))},p.alter=function(n){return i.alter(this,n),this},function(n){for(var t=0;t<n.length;t++)!function(n){p[n]=function(t){var r,e=this;return t?(setTimeout(function(){t.call(e,p[n].call(e))}),this):(r=i[n](this),m(r)?i(r):r)}}(n[t])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(n){for(var t=0;t<n.length;t++)!function(n){p[n]=function(t,r){var e=this;return r?(setTimeout(function(){r.call(e,p[n].call(e,t))}),this):i(i[n](this,t))}}(n[t])}("row col".split(" ")),function(n){for(var t=0;t<n.length;t++)r=n[t],p[r]=new Function("return jStat(jStat."+r+".apply(null, arguments));");var r}("create zeros ones rand identity".split(" ")),i}(Math),function(n,t){function r(n,t){return n-t}function e(n,r,e){return t.max(r,t.min(n,e))}var o=n.utils.isFunction;n.sum=function(n){for(var t=0,r=n.length;--r>=0;)t+=n[r];return t},n.sumsqrd=function(n){for(var t=0,r=n.length;--r>=0;)t+=n[r]*n[r];return t},n.sumsqerr=function(t){for(var r,e=n.mean(t),o=0,i=t.length;--i>=0;)o+=(r=t[i]-e)*r;return o},n.product=function(n){for(var t=1,r=n.length;--r>=0;)t*=n[r];return t},n.min=function(n){for(var t=n[0],r=0;++r<n.length;)n[r]<t&&(t=n[r]);return t},n.max=function(n){for(var t=n[0],r=0;++r<n.length;)n[r]>t&&(t=n[r]);return t},n.mean=function(t){return n.sum(t)/t.length},n.meansqerr=function(t){return n.sumsqerr(t)/t.length},n.geomean=function(r){return t.pow(n.product(r),1/r.length)},n.median=function(n){var t=n.length,e=n.slice().sort(r);return 1&t?e[t/2|0]:(e[t/2-1]+e[t/2])/2},n.cumsum=function(n){var t,r=n.length,e=new Array(r);for(e[0]=n[0],t=1;t<r;t++)e[t]=e[t-1]+n[t];return e},n.diff=function(n){var t,r=[],e=n.length;for(t=1;t<e;t++)r.push(n[t]-n[t-1]);return r},n.mode=function(n){var t,e=n.length,o=n.slice().sort(r),i=1,u=0,a=0,f=[];for(t=0;t<e;t++)o[t]===o[t+1]?i++:(i>u?(f=[o[t]],u=i,a=0):i===u&&(f.push(o[t]),a++),i=1);return 0===a?f[0]:f},n.range=function(t){return n.max(t)-n.min(t)},n.variance=function(t,r){return n.sumsqerr(t)/(t.length-(r?1:0))},n.stdev=function(r,e){return t.sqrt(n.variance(r,e))},n.meandev=function(r){var e,o=0,i=n.mean(r);for(e=r.length-1;e>=0;e--)o+=t.abs(r[e]-i);return o/r.length},n.meddev=function(r){var e,o=0,i=n.median(r);for(e=r.length-1;e>=0;e--)o+=t.abs(r[e]-i);return o/r.length},n.coeffvar=function(t){return n.stdev(t)/n.mean(t)},n.quartiles=function(n){var e=n.length,o=n.slice().sort(r);return[o[t.round(e/4)-1],o[t.round(e/2)-1],o[t.round(3*e/4)-1]]},n.quantiles=function(n,o,i,u){var a,f,c,l,s,m=n.slice().sort(r),p=[o.length],d=n.length;for(void 0===i&&(i=3/8),void 0===u&&(u=3/8),a=0;a<o.length;a++)s=e((c=d*(f=o[a])+(i+f*(1-i-u)))-(l=t.floor(e(c,1,d-1))),0,1),p[a]=(1-s)*m[l-1]+s*m[l];return p},n.percentileOfScore=function(n,t,r){var e,o,i=0,u=n.length,a=!1;for("strict"===r&&(a=!0),o=0;o<u;o++)e=n[o],(a&&e<t||!a&&e<=t)&&i++;return i/u},n.covariance=function(t,r){var e,o=n.mean(t),i=n.mean(r),u=t.length,a=new Array(u);for(e=0;e<u;e++)a[e]=(t[e]-o)*(r[e]-i);return n.sum(a)/(u-1)},n.corrcoeff=function(t,r){return n.covariance(t,r)/n.stdev(t,1)/n.stdev(r,1)};var i=n.prototype;i.cumsum=function(t,r){var e=[],u=0,a=this;if(o(t)&&(r=t,t=!1),r)return setTimeout(function(){r.call(a,i.cumsum.call(a,t))}),this;if(this.length>1){for(a=!0===t?this:this.transpose();u<a.length;u++)e[u]=n.cumsum(a[u]);return e}return n.cumsum(this[0],t)},function(t){for(var r=0;r<t.length;r++)!function(t){i[t]=function(r,e){var u=[],a=0,f=this;if(o(r)&&(e=r,r=!1),e)return setTimeout(function(){e.call(f,i[t].call(f,r))}),this;if(this.length>1){for(f=!0===r?this:this.transpose();a<f.length;a++)u[a]=n[t](f[a]);return!0===r?n[t](n.utils.toVector(u)):u}return n[t](this[0],r)}}(t[r])}("sum sumsqrd sumsqerr product min max mean meansqerr geomean median diff mode range variance stdev meandev meddev coeffvar quartiles".split(" ")),function(t){for(var r=0;r<t.length;r++)!function(t){i[t]=function(){var r=[],e=0,u=this,a=Array.prototype.slice.call(arguments);if(o(a[a.length-1])){var f=a[a.length-1],c=a.slice(0,a.length-1);return setTimeout(function(){f.call(u,i[t].apply(u,c))}),this}f=void 0;var l=function(r){return n[t].apply(u,[r].concat(a))};if(this.length>1){for(u=u.transpose();e<u.length;e++)r[e]=l(u[e]);return r}return l(this[0])}}(t[r])}("quantiles percentileOfScore".split(" "))}(this.jStat,Math),function(n,t){n.gammaln=function(n){var r,e,o,i=0,u=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(o=(e=r=n)+5.5,o-=(r+.5)*t.log(o);i<6;i++)a+=u[i]/++e;return t.log(2.5066282746310007*a/r)-o},n.gammafn=function(n){var r,e,o,i,u=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],a=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,c=0,l=0,s=0,m=n;if(m<=0){if(!(i=m%1+3.6e-16))return 1/0;f=(1&m?-1:1)*t.PI/t.sin(t.PI*i),m=1-m}for(o=m,e=m<1?m++:(m-=c=(0|m)-1)-1,r=0;r<8;++r)s=(s+u[r])*e,l=l*e+a[r];if(i=s/l+1,o<m)i/=o;else if(o>m)for(r=0;r<c;++r)i*=m,m++;return f&&(i=f/i),i},n.gammap=function(r,e){var o,i=n.gammaln(r),u=r,a=1/r,f=a,c=e+1-r,l=1/1e-30,s=1/c,m=s,p=1,d=-~(8.5*t.log(r>=1?r:1/r)+.4*r+17);if(e<0||r<=0)return NaN;if(e<r+1){for(;p<=d;p++)a+=f*=e/++u;return a*t.exp(-e+r*t.log(e)-i)}for(;p<=d;p++)m*=(s=1/(s=(o=-p*(p-r))*s+(c+=2)))*(l=c+o/l);return 1-m*t.exp(-e+r*t.log(e)-i)},n.factorialln=function(t){return t<0?NaN:n.gammaln(t+1)},n.factorial=function(t){return t<0?NaN:n.gammafn(t+1)},n.combination=function(r,e){return r>170||e>170?t.exp(n.combinationln(r,e)):n.factorial(r)/n.factorial(e)/n.factorial(r-e)},n.combinationln=function(t,r){return n.factorialln(t)-n.factorialln(r)-n.factorialln(t-r)},n.permutation=function(t,r){return n.factorial(t)/n.factorial(t-r)},n.betafn=function(r,e){return r<=0||e<=0?void 0:r+e>170?t.exp(n.betaln(r,e)):n.gammafn(r)*n.gammafn(e)/n.gammafn(r+e)},n.betaln=function(t,r){return n.gammaln(t)+n.gammaln(r)-n.gammaln(t+r)},n.betacf=function(n,r,e){var o,i,u,a,f=1e-30,c=1,l=r+e,s=r+1,m=r-1,p=1,d=1-l*n/s;for(t.abs(d)<f&&(d=f),a=d=1/d;c<=100&&(d=1+(i=c*(e-c)*n/((m+(o=2*c))*(r+o)))*d,t.abs(d)<f&&(d=f),p=1+i/p,t.abs(p)<f&&(p=f),a*=(d=1/d)*p,d=1+(i=-(r+c)*(l+c)*n/((r+o)*(s+o)))*d,t.abs(d)<f&&(d=f),p=1+i/p,t.abs(p)<f&&(p=f),a*=u=(d=1/d)*p,!(t.abs(u-1)<3e-7));c++);return a},n.gammapinv=function(r,e){var o,i,u,a,f,c,l=0,s=e-1,m=n.gammaln(e);if(r>=1)return t.max(100,e+100*t.sqrt(e));if(r<=0)return 0;for(e>1?(f=t.log(s),c=t.exp(s*(f-1)-m),a=r<.5?r:1-r,o=(2.30753+.27061*(i=t.sqrt(-2*t.log(a))))/(1+i*(.99229+.04481*i))-i,r<.5&&(o=-o),o=t.max(.001,e*t.pow(1-1/(9*e)-o/(3*t.sqrt(e)),3))):o=r<(i=1-e*(.253+.12*e))?t.pow(r/i,1/e):1-t.log(1-(r-i)/(1-i));l<12;l++){if(o<=0)return 0;if((o-=i=(u=(n.gammap(e,o)-r)/(i=e>1?c*t.exp(-(o-s)+s*(t.log(o)-f)):t.exp(-o+s*t.log(o)-m)))/(1-.5*t.min(1,u*((e-1)/o-1))))<=0&&(o=.5*(o+i)),t.abs(i)<1e-8*o)break}return o},n.erf=function(n){var r,e,o,i,u=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17],a=u.length-1,f=!1,c=0,l=0;for(n<0&&(n=-n,f=!0),e=4*(r=2/(2+n))-2;a>0;a--)o=c,c=e*c-l+u[a],l=o;return i=r*t.exp(-n*n+.5*(u[0]+e*c)-l),f?i-1:1-i},n.erfc=function(t){return 1-n.erf(t)},n.erfcinv=function(r){var e,o,i,u,a=0;if(r>=2)return-100;if(r<=0)return 100;for(u=r<1?r:2-r,e=-.70711*((2.30753+.27061*(i=t.sqrt(-2*t.log(u/2))))/(1+i*(.99229+.04481*i))-i);a<2;a++)e+=(o=n.erfc(e)-u)/(1.1283791670955126*t.exp(-e*e)-e*o);return r<1?e:-e},n.ibetainv=function(r,e,o){var i,u,a,f,c,l,s,m,p,d,g=e-1,h=o-1,v=0;if(r<=0)return 0;if(r>=1)return 1;for(e>=1&&o>=1?(a=r<.5?r:1-r,l=(2.30753+.27061*(f=t.sqrt(-2*t.log(a))))/(1+f*(.99229+.04481*f))-f,r<.5&&(l=-l),s=(l*l-3)/6,m=2/(1/(2*e-1)+1/(2*o-1)),p=l*t.sqrt(s+m)/m-(1/(2*o-1)-1/(2*e-1))*(s+5/6-2/(3*m)),l=e/(e+o*t.exp(2*p))):(i=t.log(e/(e+o)),u=t.log(o/(e+o)),l=r<(f=t.exp(e*i)/e)/(p=f+(c=t.exp(o*u)/o))?t.pow(e*p*r,1/e):1-t.pow(o*p*(1-r),1/o)),d=-n.gammaln(e)-n.gammaln(o)+n.gammaln(e+o);v<10;v++){if(0===l||1===l)return l;if((l-=f=(c=(n.ibeta(l,e,o)-r)/(f=t.exp(g*t.log(l)+h*t.log(1-l)+d)))/(1-.5*t.min(1,c*(g/l-h/(1-l)))))<=0&&(l=.5*(l+f)),l>=1&&(l=.5*(l+f+1)),t.abs(f)<1e-8*l&&v>0)break}return l},n.ibeta=function(r,e,o){var i=0===r||1===r?0:t.exp(n.gammaln(e+o)-n.gammaln(e)-n.gammaln(o)+e*t.log(r)+o*t.log(1-r));return!(r<0||r>1)&&(r<(e+1)/(e+o+2)?i*n.betacf(r,e,o)/e:1-i*n.betacf(1-r,o,e)/o)},n.randn=function(r,e){var o,i,u,a,f;if(e||(e=r),r)return n.create(r,e,function(){return n.randn()});do{o=t.random(),i=1.7156*(t.random()-.5),f=(u=o-.449871)*u+(a=t.abs(i)+.386595)*(.196*a-.25472*u)}while(f>.27597&&(f>.27846||i*i>-4*t.log(o)*o*o));return i/o},n.randg=function(r,e,o){var i,u,a,f,c,l,s=r;if(o||(o=e),r||(r=1),e)return(l=n.zeros(e,o)).alter(function(){return n.randg(r)}),l;r<1&&(r+=1),i=r-1/3,u=1/t.sqrt(9*i);do{do{f=1+u*(c=n.randn())}while(f<=0);f*=f*f,a=t.random()}while(a>1-.331*t.pow(c,4)&&t.log(a)>.5*c*c+i*(1-f+t.log(f)));if(r==s)return i*f;do{a=t.random()}while(0===a);return t.pow(a,1/s)*i*f},function(t){for(var r=0;r<t.length;r++)!function(t){n.fn[t]=function(){return n(n.map(this,function(r){return n[t](r)}))}}(t[r])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var r=0;r<t.length;r++)!function(t){n.fn[t]=function(){return n(n[t].apply(null,arguments))}}(t[r])}("randn".split(" "))}(this.jStat,Math),function(n,t){(function(t){for(var r=0;r<t.length;r++)!function(t){n[t]=function(n,t,r){return this instanceof arguments.callee?(this._a=n,this._b=t,this._c=r,this):new arguments.callee(n,t,r)},n.fn[t]=function(r,e,o){var i=n[t](r,e,o);return i.data=this,i},n[t].prototype.sample=function(r){var e=this._a,o=this._b,i=this._c;return r?n.alter(r,function(){return n[t].sample(e,o,i)}):n[t].sample(e,o,i)},function(r){for(var e=0;e<r.length;e++)!function(r){n[t].prototype[r]=function(e){var o=this._a,i=this._b,u=this._c;return!e&&0!==e&&(e=this.data),"number"!=typeof e?n.fn.map.call(e,function(e){return n[t][r](e,o,i,u)}):n[t][r](e,o,i,u)}}(r[e])}("pdf cdf inv".split(" ")),function(r){for(var e=0;e<r.length;e++)!function(r){n[t].prototype[r]=function(){return n[t][r](this._a,this._b,this._c)}}(r[e])}("mean median mode variance".split(" "))}(t[r])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy lognormal normal pareto studentt weibull uniform  binomial negbin hypgeom poisson triangular".split(" ")),n.extend(n.beta,{pdf:function(r,e,o){return r>1||r<0?0:1==e&&1==o?1:e<512||o<512?t.pow(r,e-1)*t.pow(1-r,o-1)/n.betafn(e,o):t.exp((e-1)*t.log(r)+(o-1)*t.log(1-r)-n.betaln(e,o))},cdf:function(t,r,e){return t>1||t<0?1*(t>1):n.ibeta(t,r,e)},inv:function(t,r,e){return n.ibetainv(t,r,e)},mean:function(n,t){return n/(n+t)},median:function(n,t){throw new Error("median not yet implemented")},mode:function(n,r){return n*r/(t.pow(n+r,2)*(n+r+1))},sample:function(t,r){var e=n.randg(t);return e/(e+n.randg(r))},variance:function(n,r){return n*r/(t.pow(n+r,2)*(n+r+1))}}),n.extend(n.centralF,{pdf:function(r,e,o){return r<0?void 0:t.sqrt(t.pow(e*r,e)*t.pow(o,o)/t.pow(e*r+o,e+o))/(r*n.betafn(e/2,o/2))},cdf:function(t,r,e){return n.ibeta(r*t/(r*t+e),r/2,e/2)},inv:function(t,r,e){return e/(r*(1/n.ibetainv(t,r/2,e/2)-1))},mean:function(n,t){return t>2?t/(t-2):void 0},mode:function(n,t){return n>2?t*(n-2)/(n*(t+2)):void 0},sample:function(t,r){return 2*n.randg(t/2)/t/(2*n.randg(r/2)/r)},variance:function(n,t){return t<=4?void 0:2*t*t*(n+t-2)/(n*(t-2)*(t-2)*(t-4))}}),n.extend(n.cauchy,{pdf:function(n,r,e){return e/(t.pow(n-r,2)+t.pow(e,2))/t.PI},cdf:function(n,r,e){return t.atan((n-r)/e)/t.PI+.5},inv:function(n,r,e){return r+e*t.tan(t.PI*(n-.5))},median:function(n,t){return n},mode:function(n,t){return n},sample:function(r,e){return n.randn()*t.sqrt(1/(2*n.randg(.5)))*e+r}}),n.extend(n.chisquare,{pdf:function(r,e){return t.exp((e/2-1)*t.log(r)-r/2-e/2*t.log(2)-n.gammaln(e/2))},cdf:function(t,r){return n.gammap(r/2,t/2)},inv:function(t,r){return 2*n.gammapinv(t,.5*r)},mean:function(n){return n},median:function(n){return n*t.pow(1-2/(9*n),3)},mode:function(n){return n-2>0?n-2:0},sample:function(t){return 2*n.randg(t/2)},variance:function(n){return 2*n}}),n.extend(n.exponential,{pdf:function(n,r){return n<0?0:r*t.exp(-r*n)},cdf:function(n,r){return n<0?0:1-t.exp(-r*n)},inv:function(n,r){return-t.log(1-n)/r},mean:function(n){return 1/n},median:function(n){return 1/n*t.log(2)},mode:function(n){return 0},sample:function(n){return-1/n*t.log(t.random())},variance:function(n){return t.pow(n,-2)}}),n.extend(n.gamma,{pdf:function(r,e,o){return t.exp((e-1)*t.log(r)-r/o-n.gammaln(e)-e*t.log(o))},cdf:function(t,r,e){return n.gammap(r,t/e)},inv:function(t,r,e){return n.gammapinv(t,r)*e},mean:function(n,t){return n*t},mode:function(n,t){return n>1?(n-1)*t:void 0},sample:function(t,r){return n.randg(t)*r},variance:function(n,t){return n*t*t}}),n.extend(n.invgamma,{pdf:function(r,e,o){return t.exp(-(e+1)*t.log(r)-o/r-n.gammaln(e)+e*t.log(o))},cdf:function(t,r,e){return 1-n.gammap(r,e/t)},inv:function(t,r,e){return e/n.gammapinv(1-t,r)},mean:function(n,t){return n>1?t/(n-1):void 0},mode:function(n,t){return t/(n+1)},sample:function(t,r){return r/n.randg(t)},variance:function(n,t){return n<=2?void 0:t*t/((n-1)*(n-1)*(n-2))}}),n.extend(n.kumaraswamy,{pdf:function(n,r,e){return t.exp(t.log(r)+t.log(e)+(r-1)*t.log(n)+(e-1)*t.log(1-t.pow(n,r)))},cdf:function(n,r,e){return 1-t.pow(1-t.pow(n,r),e)},mean:function(t,r){return r*n.gammafn(1+1/t)*n.gammafn(r)/n.gammafn(1+1/t+r)},median:function(n,r){return t.pow(1-t.pow(2,-1/r),1/n)},mode:function(n,r){return n>=1&&r>=1&&1!==n&&1!==r?t.pow((n-1)/(n*r-1),1/n):void 0},variance:function(n,t){throw new Error("variance not yet implemented")}}),n.extend(n.lognormal,{pdf:function(n,r,e){return t.exp(-t.log(n)-.5*t.log(2*t.PI)-t.log(e)-t.pow(t.log(n)-r,2)/(2*e*e))},cdf:function(r,e,o){return.5+.5*n.erf((t.log(r)-e)/t.sqrt(2*o*o))},inv:function(r,e,o){return t.exp(-1.4142135623730951*o*n.erfcinv(2*r)+e)},mean:function(n,r){return t.exp(n+r*r/2)},median:function(n,r){return t.exp(n)},mode:function(n,r){return t.exp(n-r*r)},sample:function(r,e){return t.exp(n.randn()*e+r)},variance:function(n,r){return(t.exp(r*r)-1)*t.exp(2*n+r*r)}}),n.extend(n.normal,{pdf:function(n,r,e){return t.exp(-.5*t.log(2*t.PI)-t.log(e)-t.pow(n-r,2)/(2*e*e))},cdf:function(r,e,o){return.5*(1+n.erf((r-e)/t.sqrt(2*o*o)))},inv:function(t,r,e){return-1.4142135623730951*e*n.erfcinv(2*t)+r},mean:function(n,t){return n},median:function(n,t){return n},mode:function(n,t){return n},sample:function(t,r){return n.randn()*r+t},variance:function(n,t){return t*t}}),n.extend(n.pareto,{pdf:function(n,r,e){return n<=r?void 0:e*t.pow(r,e)/t.pow(n,e+1)},cdf:function(n,r,e){return 1-t.pow(r/n,e)},mean:function(n,r){return r<=1?void 0:r*t.pow(n,r)/(r-1)},median:function(n,r){return n*r*t.SQRT2},mode:function(n,t){return n},variance:function(n,r){return r<=2?void 0:n*n*r/(t.pow(r-1,2)*(r-2))}}),n.extend(n.studentt,{pdf:function(r,e){return n.gammafn((e+1)/2)/(t.sqrt(e*t.PI)*n.gammafn(e/2))*t.pow(1+r*r/e,-(e+1)/2)},cdf:function(r,e){var o=e/2;return n.ibeta((r+t.sqrt(r*r+e))/(2*t.sqrt(r*r+e)),o,o)},inv:function(r,e){var o=n.ibetainv(2*t.min(r,1-r),.5*e,.5);return o=t.sqrt(e*(1-o)/o),r>.5?o:-o},mean:function(n){return n>1?0:void 0},median:function(n){return 0},mode:function(n){return 0},sample:function(r){return n.randn()*t.sqrt(r/(2*n.randg(r/2)))},variance:function(n){return n>2?n/(n-2):n>1?1/0:void 0}}),n.extend(n.weibull,{pdf:function(n,r,e){return n<0?0:e/r*t.pow(n/r,e-1)*t.exp(-t.pow(n/r,e))},cdf:function(n,r,e){return n<0?0:1-t.exp(-t.pow(n/r,e))},inv:function(n,r,e){return r*t.pow(-t.log(1-n),1/e)},mean:function(t,r){return t*n.gammafn(1+1/r)},median:function(n,r){return n*t.pow(t.log(2),1/r)},mode:function(n,r){return r<=1?void 0:n*t.pow((r-1)/r,1/r)},sample:function(n,r){return n*t.pow(-t.log(t.random()),1/r)},variance:function(r,e){return r*r*n.gammafn(1+2/e)-t.pow(this.mean(r,e),2)}}),n.extend(n.uniform,{pdf:function(n,t,r){return n<t||n>r?0:1/(r-t)},cdf:function(n,t,r){return n<t?0:n<r?(n-t)/(r-t):1},mean:function(n,t){return.5*(n+t)},median:function(t,r){return n.mean(t,r)},mode:function(n,t){throw new Error("mode is not yet implemented")},sample:function(n,r){return n/2+r/2+(r/2-n/2)*(2*t.random()-1)},variance:function(n,r){return t.pow(r-n,2)/12}}),n.extend(n.binomial,{pdf:function(r,e,o){return 0===o||1===o?e*o===r?1:0:n.combination(e,r)*t.pow(o,r)*t.pow(1-o,e-r)},cdf:function(t,r,e){var o=[],i=0;if(t<0)return 0;if(t<r){for(;i<=t;i++)o[i]=n.binomial.pdf(i,r,e);return n.sum(o)}return 1}}),n.extend(n.negbin,{pdf:function(r,e,o){return!(r!=r|0)&&(r<0?0:n.combination(r+e-1,e-1)*t.pow(1-o,r)*t.pow(o,e))},cdf:function(t,r,e){var o=0,i=0;if(t<0)return 0;for(;i<=t;i++)o+=n.negbin.pdf(i,r,e);return o}}),n.extend(n.hypgeom,{pdf:function(r,e,o,i){if(r!=r|0)return!1;if(r<0||r<o-(e-i))return 0;if(r>i||r>o)return 0;if(2*o>e)return 2*i>e?n.hypgeom.pdf(e-o-i+r,e,e-o,e-i):n.hypgeom.pdf(i-r,e,e-o,i);if(2*i>e)return n.hypgeom.pdf(o-r,e,o,e-i);if(o<i)return n.hypgeom.pdf(r,e,i,o);for(var u=1,a=0,f=0;f<r;f++){for(;u>1&&a<i;)u*=1-o/(e-a),a++;u*=(i-f)*(o-f)/((f+1)*(e-o-i+f+1))}for(;a<i;a++)u*=1-o/(e-a);return t.min(1,t.max(0,u))},cdf:function(r,e,o,i){if(r<0||r<o-(e-i))return 0;if(r>=i||r>=o)return 1;if(2*o>e)return 2*i>e?n.hypgeom.cdf(e-o-i+r,e,e-o,e-i):1-n.hypgeom.cdf(i-r-1,e,e-o,i);if(2*i>e)return 1-n.hypgeom.cdf(o-r-1,e,o,e-i);if(o<i)return n.hypgeom.cdf(r,e,i,o);for(var u=1,a=1,f=0,c=0;c<r;c++){for(;u>1&&f<i;){var l=1-o/(e-f);a*=l,u*=l,f++}u+=a*=(i-c)*(o-c)/((c+1)*(e-o-i+c+1))}for(;f<i;f++)u*=1-o/(e-f);return t.min(1,t.max(0,u))}}),n.extend(n.poisson,{pdf:function(r,e){return t.pow(e,r)*t.exp(-e)/n.factorial(r)},cdf:function(t,r){var e=[],o=0;if(t<0)return 0;for(;o<=t;o++)e.push(n.poisson.pdf(o,r));return n.sum(e)},mean:function(n){return n},variance:function(n){return n},sample:function(n){var r=1,e=0,o=t.exp(-n);do{e++,r*=t.random()}while(r>o);return e-1}}),n.extend(n.triangular,{pdf:function(n,t,r,e){return r<=t||e<t||e>r?void 0:n<t||n>r?0:n<=e?2*(n-t)/((r-t)*(e-t)):2*(r-n)/((r-t)*(r-e))},cdf:function(n,r,e,o){return e<=r||o<r||o>e?void 0:n<r?0:n<=o?t.pow(n-r,2)/((e-r)*(o-r)):1-t.pow(e-n,2)/((e-r)*(e-o))},mean:function(n,t,r){return(n+t+r)/3},median:function(n,r,e){return e<=(n+r)/2?r-t.sqrt((r-n)*(r-e))/t.sqrt(2):e>(n+r)/2?n+t.sqrt((r-n)*(e-n))/t.sqrt(2):void 0},mode:function(n,t,r){return r},sample:function(n,r,e){var o=t.random();return o<(e-n)/(r-n)?n+t.sqrt(o*(r-n)*(e-n)):r-t.sqrt((1-o)*(r-n)*(r-e))},variance:function(n,t,r){return(n*n+t*t+r*r-n*t-n*r-t*r)/18}})}(this.jStat,Math),function(n,t){var r=Array.prototype.push,e=n.utils.isArray;n.extend({add:function(t,r){return e(r)?(e(r[0])||(r=[r]),n.map(t,function(n,t,e){return n+r[t][e]})):n.map(t,function(n){return n+r})},subtract:function(t,r){return e(r)?(e(r[0])||(r=[r]),n.map(t,function(n,t,e){return n-r[t][e]||0})):n.map(t,function(n){return n-r})},divide:function(t,r){return e(r)?(e(r[0])||(r=[r]),n.multiply(t,n.inv(r))):n.map(t,function(n){return n/r})},multiply:function(t,r){var o,i,u,a,f=t.length,c=t[0].length,l=n.zeros(f,u=e(r)?r[0].length:c),s=0;if(e(r)){for(;s<u;s++)for(o=0;o<f;o++){for(a=0,i=0;i<c;i++)a+=t[o][i]*r[i][s];l[o][s]=a}return 1===f&&1===s?l[0][0]:l}return n.map(t,function(n){return n*r})},dot:function(t,r){e(t[0])||(t=[t]),e(r[0])||(r=[r]);for(var o,i,u=1===t[0].length&&1!==t.length?n.transpose(t):t,a=1===r[0].length&&1!==r.length?n.transpose(r):r,f=[],c=0,l=u.length,s=u[0].length;c<l;c++){for(f[c]=[],o=0,i=0;i<s;i++)o+=u[c][i]*a[c][i];f[c]=o}return 1===f.length?f[0]:f},pow:function(r,e){return n.map(r,function(n){return t.pow(n,e)})},abs:function(r){return n.map(r,function(n){return t.abs(n)})},norm:function(n,r){var o=0,i=0;for(isNaN(r)&&(r=2),e(n[0])&&(n=n[0]);i<n.length;i++)o+=t.pow(t.abs(n[i]),r);return t.pow(o,1/r)},angle:function(r,e){return t.acos(n.dot(r,e)/(n.norm(r)*n.norm(e)))},aug:function(n,t){for(var e=n.slice(),o=0;o<e.length;o++)r.apply(e[o],t[o]);return e},inv:function(t){for(var r,e=t.length,o=t[0].length,i=n.identity(e,o),u=n.gauss_jordan(t,i),a=[],f=0;f<e;f++)for(a[f]=[],r=o;r<u[0].length;r++)a[f][r-o]=u[f][r];return a},det:function(n){var t,r=n.length,e=2*r,o=new Array(e),i=r-1,u=e-1,a=i-r+1,f=u,c=0,l=0;if(2===r)return n[0][0]*n[1][1]-n[0][1]*n[1][0];for(;c<e;c++)o[c]=1;for(c=0;c<r;c++){for(t=0;t<r;t++)o[a<0?a+r:a]*=n[c][t],o[f<r?f+r:f]*=n[c][t],a++,f--;a=--i-r+1,f=--u}for(c=0;c<r;c++)l+=o[c];for(;c<e;c++)l-=o[c];return l},gauss_elimination:function(r,e){var o,i,u,a,f=0,c=0,l=r.length,s=r[0].length,m=1,p=0,d=[];for(o=(r=n.aug(r,e))[0].length,f=0;f<l;f++){for(i=r[f][f],c=f,a=f+1;a<s;a++)i<t.abs(r[a][f])&&(i=r[a][f],c=a);if(c!=f)for(a=0;a<o;a++)u=r[f][a],r[f][a]=r[c][a],r[c][a]=u;for(c=f+1;c<l;c++)for(m=r[c][f]/r[f][f],a=f;a<o;a++)r[c][a]=r[c][a]-m*r[f][a]}for(f=l-1;f>=0;f--){for(p=0,c=f+1;c<=l-1;c++)p+=d[c]*r[f][c];d[f]=(r[f][o-1]-p)/r[f][f]}return d},gauss_jordan:function(r,e){for(var o=n.aug(r,e),i=o.length,u=o[0].length,a=0;a<i;a++){for(var f=a,l=a+1;l<i;l++)t.abs(o[l][a])>t.abs(o[f][a])&&(f=l);var s=o[a];o[a]=o[f],o[f]=s;for(l=a+1;l<i;l++){c=o[l][a]/o[a][a];for(var m=a;m<u;m++)o[l][m]-=o[a][m]*c}}for(a=i-1;a>=0;a--){c=o[a][a];for(l=0;l<a;l++)for(m=u-1;m>a-1;m--)o[l][m]-=o[a][m]*o[l][a]/c;o[a][a]/=c;for(m=i;m<u;m++)o[a][m]/=c}return o},lu:function(n,t){throw new Error("lu not yet implemented")},cholesky:function(n,t){throw new Error("cholesky not yet implemented")},gauss_jacobi:function(r,e,o,i){for(var u,a,f,c,l=0,s=0,m=r.length,p=[],d=[],g=[];l<m;l++)for(p[l]=[],d[l]=[],g[l]=[],s=0;s<m;s++)l>s?(p[l][s]=r[l][s],d[l][s]=g[l][s]=0):l<s?(d[l][s]=r[l][s],p[l][s]=g[l][s]=0):(g[l][s]=r[l][s],p[l][s]=d[l][s]=0);for(f=n.multiply(n.multiply(n.inv(g),n.add(p,d)),-1),a=n.multiply(n.inv(g),e),u=o,c=n.add(n.multiply(f,o),a),l=2;t.abs(n.norm(n.subtract(c,u)))>i;)u=c,c=n.add(n.multiply(f,u),a),l++;return c},gauss_seidel:function(r,e,o,i){for(var u,a,f,c,l,s=0,m=r.length,p=[],d=[],g=[];s<m;s++)for(p[s]=[],d[s]=[],g[s]=[],u=0;u<m;u++)s>u?(p[s][u]=r[s][u],d[s][u]=g[s][u]=0):s<u?(d[s][u]=r[s][u],p[s][u]=g[s][u]=0):(g[s][u]=r[s][u],p[s][u]=d[s][u]=0);for(c=n.multiply(n.multiply(n.inv(n.add(g,p)),d),-1),f=n.multiply(n.inv(n.add(g,p)),e),a=o,l=n.add(n.multiply(c,o),f),s=2;t.abs(n.norm(n.subtract(l,a)))>i;)a=l,l=n.add(n.multiply(c,a),f),s+=1;return l},SOR:function(r,e,o,i,u){for(var a,f,c,l,s,m=0,p=r.length,d=[],g=[],h=[];m<p;m++)for(d[m]=[],g[m]=[],h[m]=[],a=0;a<p;a++)m>a?(d[m][a]=r[m][a],g[m][a]=h[m][a]=0):m<a?(g[m][a]=r[m][a],d[m][a]=h[m][a]=0):(h[m][a]=r[m][a],d[m][a]=g[m][a]=0);for(l=n.multiply(n.inv(n.add(h,n.multiply(d,u))),n.subtract(n.multiply(h,1-u),n.multiply(g,u))),c=n.multiply(n.multiply(n.inv(n.add(h,n.multiply(d,u))),e),u),f=o,s=n.add(n.multiply(l,o),c),m=2;t.abs(n.norm(n.subtract(s,f)))>i;)f=s,s=n.add(n.multiply(l,f),c),m++;return s},householder:function(r){for(var e,o,i,u,a=r.length,f=r[0].length,c=0,l=[],s=[];c<a-1;c++){for(e=0,u=c+1;u<f;u++)e+=r[u][c]*r[u][c];for(e=(r[c+1][c]>0?-1:1)*t.sqrt(e),o=t.sqrt((e*e-r[c+1][c]*e)/2),(l=n.zeros(a,1))[c+1][0]=(r[c+1][c]-e)/(2*o),i=c+2;i<a;i++)l[i][0]=r[i][c]/(2*o);s=n.subtract(n.identity(a,f),n.multiply(n.multiply(l,n.transpose(l)),2)),r=n.multiply(s,n.multiply(r,s))}return r},QR:function(r,e){for(var o,i,u,a,f=r.length,c=r[0].length,l=0,s=[],m=[],p=[];l<f-1;l++){for(i=0,o=l+1;o<c;o++)i+=r[o][l]*r[o][l];for(i=(r[l+1][l]>0?-1:1)*t.sqrt(i),u=t.sqrt((i*i-r[l+1][l]*i)/2),(s=n.zeros(f,1))[l+1][0]=(r[l+1][l]-i)/(2*u),a=l+2;a<f;a++)s[a][0]=r[a][l]/(2*u);m=n.subtract(n.identity(f,c),n.multiply(n.multiply(s,n.transpose(s)),2)),r=n.multiply(m,r),e=n.multiply(m,e)}for(l=f-1;l>=0;l--){for(0,o=l+1;o<=c-1;o++)p[o]*r[l][o];p[l]=e[l][0]/r[l][l]}return p},jacobi:function(r){for(var e,o,i,u,a,f,c,l=1,s=r.length,m=n.identity(s,s),p=[];1===l;){for(0,a=r[0][1],i=0,u=1,e=0;e<s;e++)for(o=0;o<s;o++)e!=o&&a<t.abs(r[e][o])&&(a=t.abs(r[e][o]),i=e,u=o);for(f=r[i][i]===r[u][u]?r[i][u]>0?t.PI/4:-t.PI/4:t.atan(2*r[i][u]/(r[i][i]-r[u][u]))/2,(c=n.identity(s,s))[i][i]=t.cos(f),c[i][u]=-t.sin(f),c[u][i]=t.sin(f),c[u][u]=t.cos(f),m=n.multiply(m,c),r=n.multiply(n.multiply(n.inv(c),r),c),l=0,e=1;e<s;e++)for(o=1;o<s;o++)e!=o&&t.abs(r[e][o])>.001&&(l=1)}for(e=0;e<s;e++)p.push(r[e][e]);return[m,p]},rungekutta:function(n,t,r,e,o,i){var u,a,f;if(2===i)for(;e<=r;)o=o+((u=t*n(e,o))+(a=t*n(e+t,o+u)))/2,e+=t;if(4===i)for(;e<=r;)o=o+((u=t*n(e,o))+2*(a=t*n(e+t/2,o+u/2))+2*(f=t*n(e+t/2,o+a/2))+t*n(e+t,o+f))/6,e+=t;return o},romberg:function(n,r,e,o){for(var i,u,a,f,c,l=0,s=(e-r)/2,m=[],p=[],d=[];l<o/2;){for(c=n(r),a=r,f=0;a<=e;a+=s,f++)m[f]=a;for(i=m.length,a=1;a<i-1;a++)c+=(a%2!=0?4:2)*n(m[a]);c=s/3*(c+n(e)),d[l]=c,s/=2,l++}for(u=d.length,i=1;1!==u;){for(a=0;a<u-1;a++)p[a]=(t.pow(4,i)*d[a+1]-d[a])/(t.pow(4,i)-1);u=p.length,d=p,p=[],i++}return d},richardson:function(n,r,e,o){function i(n,t){for(var r,e=0,o=n.length;e<o;e++)n[e]===t&&(r=e);return r}n.length;for(var u,a,f,c,l,s=t.abs(e-n[i(n,e)+1]),m=0,p=[],d=[];o>=s;)u=i(n,e+o),a=i(n,e),p[m]=(r[u]-2*r[a]+r[2*a-u])/(o*o),o/=2,m++;for(c=p.length,f=1;1!=c;){for(l=0;l<c-1;l++)d[l]=(t.pow(4,f)*p[l+1]-p[l])/(t.pow(4,f)-1);c=d.length,p=d,d=[],f++}return p},simpson:function(n,t,r,e){for(var o,i=(r-t)/e,u=n(t),a=[],f=t,c=0,l=1;f<=r;f+=i,c++)a[c]=f;for(o=a.length;l<o-1;l++)u+=(l%2!=0?4:2)*n(a[l]);return i/3*(u+n(r))},hermite:function(n,t,r,e){for(var o,i=n.length,u=0,a=0,f=[],c=[],l=[],s=[];a<i;a++){for(f[a]=1,o=0;o<i;o++)a!=o&&(f[a]*=(e-n[o])/(n[a]-n[o]));for(c[a]=0,o=0;o<i;o++)a!=o&&(c[a]+=1/(n[a]-n[o]));l[a]=(1-2*(e-n[a])*c[a])*f[a]*f[a],s[a]=(e-n[a])*f[a]*f[a],u+=l[a]*t[a]+s[a]*r[a]}return u},lagrange:function(n,t,r){for(var e,o,i=0,u=0,a=n.length;u<a;u++){for(o=t[u],e=0;e<a;e++)u!=e&&(o*=(r-n[e])/(n[u]-n[e]));i+=o}return i},cubic_spline:function(t,r,e){for(var o,i,u=t.length,a=0,f=[],c=[],l=[],s=[],m=[],p=[];a<u-1;a++)s[a]=t[a+1]-t[a];for(l[0]=0,a=1;a<u-1;a++)l[a]=3/s[a]*(r[a+1]-r[a])-3/s[a-1]*(r[a]-r[a-1]);for(a=1;a<u-1;a++)f[a]=[],c[a]=[],f[a][a-1]=s[a-1],f[a][a]=2*(s[a-1]+s[a]),f[a][a+1]=s[a],c[a][0]=l[a];for(i=n.multiply(n.inv(f),c),o=0;o<u-1;o++)m[o]=(r[o+1]-r[o])/s[o]-s[o]*(i[o+1][0]+2*i[o][0])/3,p[o]=(i[o+1][0]-i[o][0])/(3*s[o]);for(o=0;o<u&&!(t[o]>e);o++);return r[o-=1]+(e-t[o])*m[o]+n.sq(e-t[o])*i[o]+(e-t[o])*n.sq(e-t[o])*p[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(t){var r,e,o,i,u,a=t.length,f=t[0].length,c=0,l=[],s=[],m=[],p=[],d=[],g=[],h=[];for(c=0;c<a;c++)l[c]=n.sum(t[c])/f;for(c=0;c<f;c++)for(d[c]=[],r=0;r<a;r++)d[c][r]=t[r][c]-l[r];for(d=n.transpose(d),c=0;c<a;c++)for(g[c]=[],r=0;r<a;r++)g[c][r]=n.dot([d[c]],[d[r]])/(f-1);for(u=(o=n.jacobi(g))[0],s=o[1],h=n.transpose(u),c=0;c<s.length;c++)for(r=c;r<s.length;r++)s[c]<s[r]&&(e=s[c],s[c]=s[r],s[r]=e,m=h[c],h[c]=h[r],h[r]=m);for(i=n.transpose(d),c=0;c<a;c++)for(p[c]=[],r=0;r<i.length;r++)p[c][r]=n.dot([h[c]],[i[r]]);return[t,s,h,p]}}),function(t){for(var r=0;r<t.length;r++)!function(t){n.fn[t]=function(r,e){var o=this;return e?(setTimeout(function(){e.call(o,n.fn[t].call(o,r))},15),this):"number"==typeof n[t](this,r)?n[t](this,r):n(n[t](this,r))}}(t[r])}("add divide multiply subtract dot pow abs norm angle".split(" "))}(this.jStat,Math),function(n,t){var r=[].slice,e=n.utils.isNumber;n.extend({zscore:function(){var t=r.call(arguments);return e(t[1])?(t[0]-t[1])/t[2]:(t[0]-n.mean(t[1]))/n.stdev(t[1],t[2])},ztest:function(){var o=r.call(arguments);if(4===o.length){if(e(o[1])){var i=n.zscore(o[0],o[1],o[2]);return 1===o[3]?n.normal.cdf(-t.abs(i),0,1):2*n.normal.cdf(-t.abs(i),0,1)}i=o[0];return 1===o[2]?n.normal.cdf(-t.abs(i),0,1):2*n.normal.cdf(-t.abs(i),0,1)}i=n.zscore(o[0],o[1],o[3]);return 1===o[1]?n.normal.cdf(-t.abs(i),0,1):2*n.normal.cdf(-t.abs(i),0,1)}}),n.extend(n.fn,{zscore:function(n,t){return(n-this.mean())/this.stdev(t)},ztest:function(r,e,o){var i=t.abs(this.zscore(r,o));return 1===e?n.normal.cdf(-i,0,1):2*n.normal.cdf(-i,0,1)}}),n.extend({tscore:function(){var e=r.call(arguments);return 4===e.length?(e[0]-e[1])/(e[2]/t.sqrt(e[3])):(e[0]-n.mean(e[1]))/(n.stdev(e[1],!0)/t.sqrt(e[1].length))},ttest:function(){var o,i=r.call(arguments);return 5===i.length?(o=t.abs(n.tscore(i[0],i[1],i[2],i[3])),1===i[4]?n.studentt.cdf(-o,i[3]-1):2*n.studentt.cdf(-o,i[3]-1)):e(i[1])?(o=t.abs(i[0]),1==i[2]?n.studentt.cdf(-o,i[1]-1):2*n.studentt.cdf(-o,i[1]-1)):(o=t.abs(n.tscore(i[0],i[1])),1==i[2]?n.studentt.cdf(-o,i[1].length-1):2*n.studentt.cdf(-o,i[1].length-1))}}),n.extend(n.fn,{tscore:function(n){return(n-this.mean())/(this.stdev(!0)/t.sqrt(this.cols()))},ttest:function(r,e){return 1===e?1-n.studentt.cdf(t.abs(this.tscore(r)),this.cols()-1):2*n.studentt.cdf(-t.abs(this.tscore(r)),this.cols()-1)}}),n.extend({anovafscore:function(){var e,o,i,u,a,f,c,l,s=r.call(arguments);if(1===s.length){for(a=new Array(s[0].length),c=0;c<s[0].length;c++)a[c]=s[0][c];s=a}if(2===s.length)return n.variance(s[0])/n.variance(s[1]);for(o=new Array,c=0;c<s.length;c++)o=o.concat(s[c]);for(i=n.mean(o),e=0,c=0;c<s.length;c++)e+=s[c].length*t.pow(n.mean(s[c])-i,2);for(e/=s.length-1,f=0,c=0;c<s.length;c++)for(u=n.mean(s[c]),l=0;l<s[c].length;l++)f+=t.pow(s[c][l]-u,2);return e/(f/=o.length-s.length)},anovaftest:function(){var t,o,i,u,a=r.call(arguments);if(e(a[0]))return 1-n.centralF.cdf(a[0],a[1],a[2]);for(anovafscore=n.anovafscore(a),t=a.length-1,i=0,u=0;u<a.length;u++)i+=a[u].length;return o=i-t-1,1-n.centralF.cdf(anovafscore,t,o)},ftest:function(t,r,e){return 1-n.centralF.cdf(t,r,e)}}),n.extend(n.fn,{anovafscore:function(){return n.anovafscore(this.toArray())},anovaftes:function(){var t,r=0;for(t=0;t<this.length;t++)r+=this[t].length;return n.ftest(this.anovafscore(),this.length-1,r-this.length)}}),n.extend({normalci:function(){var e,o=r.call(arguments),i=new Array(2);return e=4===o.length?t.abs(n.normal.inv(o[1]/2,0,1)*o[2]/t.sqrt(o[3])):t.abs(n.normal.inv(o[1]/2,0,1)*n.stdev(o[2])/t.sqrt(o[2].length)),i[0]=o[0]-e,i[1]=o[0]+e,i},tci:function(){var e,o=r.call(arguments),i=new Array(2);return e=4===o.length?t.abs(n.studentt.inv(o[1]/2,o[3]-1)*o[2]/t.sqrt(o[3])):t.abs(n.studentt.inv(o[1]/2,o[2].length-1)*n.stdev(o[2],!0)/t.sqrt(o[2].length)),i[0]=o[0]-e,i[1]=o[0]+e,i},significant:function(n,t){return n<t}}),n.extend(n.fn,{normalci:function(t,r){return n.normalci(t,r,this.toArray())},tci:function(t,r){return n.tci(t,r,this.toArray())}})}(this.jStat,Math);
