"use strict";var _slicedToArray=function(t,o){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t)){var r=[],e=!0,n=!1,a=void 0;try{for(var i,l=t[Symbol.iterator]();!(e=(i=l.next()).done)&&(r.push(i.value),!o||r.length!==o);e=!0);}catch(t){n=!0,a=t}finally{try{!e&&l.return&&l.return()}finally{if(n)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")};!function(t,o,r,e,n){var a={font:{size:8},shadowSize:0,yaxis:{tickLength:5},xaxis:{tickLength:5},legend:{backgroundColor:"rgba(0, 0, 0, 0)",color:o.bodyText},grid:{backgroundColor:null,color:o.bodyText},colors:o.chroma.slice(1)},i=[-1,1],l=function(o,e,l){var s=void 0===arguments[3]?[]:arguments[3],c=void 0,u=t.extend(!0,{},a),d=[];if(l.log===!0){var f={ticks:[0,.01,.1,1,10,100],transform:function(t){return Math.log(t+.001)},inverseTransform:function(t){return Math.exp(t)},tickDecimals:2};t.extend(u.xaxis,f),t.extend(u.yaxis,f)}var h=function(t){var o=_slicedToArray(t,2),r=o[0],e=o[1];return l.log===!0?{min:r/2,max:2*e}:{min:r,max:e}};if("object"==typeof l.xlims&&null!==l.xlims&&t.extend(u.xaxis,h(l.xlims)),"object"==typeof l.ylims&&null!==l.ylims&&t.extend(u.yaxis,h(l.ylims)),0!==s.length&&(s.forEach(function(t){d.push({data:t,color:"rgba(165, 170, 204, 0.7)"})}),d[0].label="Posterior Prediction"),0!==e.length){c=r.histogramCounts(e);var v=c.length>1?c[1][0]-c[0][0]:.05;d.push({data:c,bars:{show:!0,align:"center",barWidth:v},color:1})}var p=function(t,o){var r=n.mean(n.map(o,function(o){return o>=t?1:0}));return[1-r,r]};if("number"==typeof l.compValue){var m=p(l.compValue,e);d.push({data:[[l.compValue,0],[l.compValue,1/0]],label:""+(100*m[0]).toPrecision(3)+"% < "+l.compValue+" < "+(100*m[1]).toPrecision(3)+"%",lines:{lineWidth:2},color:2})}var y=function(t,o){o=o.sort(function(t,o){return t-o});var r=Math.floor(o.length*t),e=[o[o.length-1-r],i[1]],n=[i[0],o[r]];return-e[0]<n[1]?e:n},g=function(t,o){o=o.sort(function(t,o){return t-o});for(var r=Math.floor(o.length*t),e=n.min(o),a=n.max(o),i=void 0,l=0,s=o.length-r;s>l;l++)i=o[l+r]-o[l],a-e>i&&(e=o[l],a=o[l+r]);return[e,a]};if("undefined"!=typeof l.di&&null!==l.di&&!function(){var t=function(t,o){var e=_slicedToArray(o,2),n=e[0],a=e[1];d.push({data:[[n,r.getHeight(n===i[0]?a:n,c)],[a,r.getHeight(a===i[1]?n:a,c)]],label:t.toPrecision(2).slice(2)+"% "+l.di+" ("+n.toPrecision(3)+", "+a.toPrecision(3)+")",lines:{lineWidth:5},color:3})};"BI"===l.di?[.95,.99].forEach(function(o){t(o,y(o,e))}):[.95].forEach(function(o){t(o,g(o,e))})}(),"undefined"!=typeof e.length&&0!==e.length){var x=n.mean(e);d.push({data:[[x,0]],label:"Mean: "+x.toPrecision(3),points:{show:!0},color:4})}return t.plot(o,d,u)},s=function(o){var n=function(o){d(e.posterior_predictive_check(o)),a(.925),t("#stat-out").show(),l(t("#mean > div"),r.twoDArrayCol(o,2),{di:"BI",comp:0,xlims:[-1,1]}),a(.95);var n=r.twoDArrayCol(o,0),i=r.twoDArrayCol(o,1),s=r.xHistLims([n,i]),c=r.yHistLims([n,i]);l(t("#alpha > div"),n,{di:"HDI",xlims:s,ylims:c,log:!0}),a(.975),l(t("#beta > div"),i,{di:"HDI",xlims:s,ylims:c,log:!0}),a(1)},a=function(o){t("progress").attr("value",o)};t(".analyze").html("Re-analyze"),e.run_BEST(o,2e4,2e4,a,n)},c=function(o){var e=o.length,i=e-1;if(30>e)return void alert("We need at least 30 votes for this calculation. You need at least "+(30-e)+" more.");var l=n.mean(o),s=n.stdev(o),c=r.sampleFunc(-1,1,function(t){return n.studentt.pdf((l-t)/s*Math.sqrt(e),i)}),u=function(t){var o=n.studentt.inv(t,i)*s/Math.sqrt(e),r=n.studentt.pdf(n.studentt.inv(t,i),i);return l>0?[r,l-o,1/0]:[r,-1/0,l+o]},d=[{data:c,lines:{show:!0},color:1},{data:[[l,0]],label:"Mean: "+l.toPrecision(3),points:{show:!0},color:4}];[.95,.99].forEach(function(t){var o=u(t),r=_slicedToArray(o,3),e=r[0],n=r[1],a=r[2];d.push({data:[[n,e],[a,e]],label:t.toPrecision(2).slice(2)+"% CI ("+n.toPrecision(3)+", "+a.toPrecision(3)+")",lines:{lineWidth:5},color:3})}),t("#stat-out").show(),t.plot(t("#freq > div"),d,a),t("progress").attr("value",1)},u=function(o){var r=function(t){return t=t.replace(/[^-1234567890.]+$/,"").replace(/^[^-1234567890.]+/,""),n.map(t.split(/[^-1234567890.]+/),function(t){var o=parseFloat(t);if(isNaN(o))throw"NaN";var r=.001;return 0>=o?r:o>=1?1-r:o})},e=void 0,a=void 0;try{e=r(t("#data1").val()),a=r(t("#data2").val())}catch(t){return alert("ERROR: Data not supplied for both groups or not formatted correctly."),null}var i=a.length-e.length;if(0!==i&&o===!0){var l=" Since we're supposed to pair data, that's bad.";return i>0?(alert("You have "+i+" more data points for Proposal 2 than for Proposal 1."+l),null):(alert("You have "+-i+" more data points for Proposal 1 than for Proposal 2."+l),null)}for(var s=[],c=Math.min(e.length,a.length),u=0;c>u;u++)s.push(a[u]-e[u]);return[e,a,s]},d=function(o){var e=u();if("undefined"!=typeof e){var n=r.yHistLims(e);l(t("#preview1 > div"),e[0],{xlims:[0,1],ylims:n}),l(t("#preview2 > div"),e[1],{xlims:[0,1],ylims:n}),l(t("#diff > div"),e[2],{xlims:[-1,1]},o)}};t(function(){t(".act > .analyze").click(function(){var o=u(!0);"undefined"!=typeof o&&(t("#best").closest("li").hasClass("open")?s(o[2]):c(o[2]))}),t(".preview").click(function(){d()}),setTimeout(function(){d()});var r={grid:{show:!1},colors:[o.value[3]]};t.plot(t("#non-norm"),[{bars:{show:!0},data:[[-2,4],[-1,1],[0,0],[1,1],[2,4]]}],r),t.plot(t("#sym1"),[{bars:{show:!0},data:[[-2,1],[-1,0],[0,0],[1,2],[2,0]]}],r),t.plot(t("#sym2"),[{bars:{show:!0},data:[[-2,0],[-1,0],[0,3],[1,0],[2,0]]}],r)})}($,colors,plot,mcmc,jStat);